/*! For license information please see oroworkflow.js.LICENSE.txt */
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[124],{"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroui/templates/history.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div>\n    <button type="button" class="btn btn-default undo-btn"',(!states||index<1)&&(__p+=" disabled"),__p+='><i class="fa-reply"></i> '+(null==(__t=_.__("Undo"))?"":_.escape(__t))+'</button>\n    <button type="button" class="btn btn-default redo-btn"',(!states||index+1>=states.length)&&(__p+=" disabled"),__p+='><i class="fa-share"></i> '+(null==(__t=_.__("Redo"))?"":_.escape(__t))+"</button>\n</div>\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroui/templates/zoom-controls.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";var togglerId=_.uniqueId("dropdown-");__p+='\n<button class="btn btn-icon btn-zoom-in" title="'+(null==(__t=_.__("oro.ui.zoom.in"))?"":_.escape(__t))+'"><span class="fa-search-plus" aria-hidden="true"></span></button>\n<div class="btn-group">\n    <button id="'+(null==(__t=togglerId)?"":_.escape(__t))+'" data-toggle="dropdown" class="btn dropdown-toggle "\n            aria-haspopup="true" aria-expanded="false" aria-label="'+(null==(__t=_.__("oro.ui.zoom.steps"))?"":_.escape(__t))+'">\n        '+(null==(__t=Math.round(100*zoom))?"":_.escape(__t))+'%\n    </button>\n    <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="'+(null==(__t=togglerId)?"":_.escape(__t))+'">\n        <li><a href="#" role="button" class="btn-set-zoom" data-size="50">50%</a></li>\n        <li><a href="#" role="button" class="btn-set-zoom" data-size="75">75%</a></li>\n        <li><a href="#" role="button" class="btn-set-zoom" data-size="100">100%</a></li>\n        <li><a href="#" role="button" class="btn-set-zoom" data-size="150">150%</a></li>\n        <li><a href="#" role="button" class="btn-set-zoom" data-size="200">200%</a></li>\n    </ul>\n</div>\n<button class="btn btn-icon btn-zoom-out" title="'+(null==(__t=_.__("oro.ui.zoom.out"))?"":_.escape(__t))+'"><span class="fa-search-minus" aria-hidden="true"></span></button>\n<button class="btn btn-icon btn-auto-zoom" title="'+(null==(__t=_.__("oro.ui.zoom.auto"))?"":_.escape(__t))+'"><span class="fa-expand" aria-hidden="true"></span></button>\n'}return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroui/templates/zoom-scroll-hint.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="'+(null==(__t=containerClass)?"":_.escape(__t))+'"><div>'+(null==(__t=label)?"":_.escape(__t))+"</div></div>\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/controls.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",checkboxUid=_.uniqueId("checkbox-"),__p+='\n<div class="checkbox-group pull-left">\n    <input id="'+(null==(__t=checkboxUid)?"":_.escape(__t))+'" type="checkbox" name="toggle-transition-labels" value="1" checked="checked"><label for="'+(null==(__t=checkboxUid)?"":_.escape(__t))+'">'+(null==(__t=_.__("Show Transition Labels"))?"":_.escape(__t))+"</label>\n</div>\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/editor/step.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){if(__p+='<div class="jsplumb-source jsplumb-source-top-left"></div>\n<div class="jsplumb-source jsplumb-source-top-right"></div>\n<div class="jsplumb-source jsplumb-source-bottom-right"></div>\n<div class="jsplumb-source jsplumb-source-bottom-left"></div>\n<div class="step-label" title="'+(null==(__t=label)?"":_.escape(__t))+'">\n    '+(null==(__t=label)?"":_.escape(__t))+"\n</div>\n",!_is_start){__p+="\n";var togglerId=_.uniqueId("dropdown-");__p+='\n<span role="button" id="'+(null==(__t=togglerId)?"":_.escape(__t))+'" class="dropdown-toggle" data-toggle="dropdown" data-placement="bottom-end"\n      aria-label="'+(null==(__t=_.__("oro.workflow.flowchart.step.actions_label"))?"":_.escape(__t))+'" aria-haspopup="true" aria-expanded="false">\n    </span>\n<ul class="dropdown-menu" role="menu" aria-labelledby="'+(null==(__t=togglerId)?"":_.escape(__t))+'">\n    <li class="first">\n        <a class="workflow-step-edit" href="#edit-step"><span class="fa-pencil-square-o" aria-hidden="true"></span>'+(null==(__t=_.__("Edit"))?"":_.escape(__t))+'</a>\n    </li>\n    <li>\n        <a class="workflow-step-clone" href="#clone-step"><span class="fa-files-o" aria-hidden="true"></span>'+(null==(__t=_.__("Clone"))?"":_.escape(__t))+'</a>\n    </li>\n    <li>\n        <a class="workflow-step-delete" href="#delete-step"><span class="fa-trash-o" aria-hidden="true"></span>'+(null==(__t=_.__("Delete"))?"":_.escape(__t))+"</a>\n    </li>\n</ul>\n"}__p+="\n"}return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/editor/transition.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";var togglerId=_.uniqueId("dropdown-");__p+='\n<div class="transition-label" title="'+(null==(__t=label)?"":_.escape(__t))+'">\n    '+(null==(__t=label)?"":_.escape(__t))+'\n</div>\n<span role="button" id="'+(null==(__t=togglerId)?"":_.escape(__t))+'" class="dropdown-toggle" data-toggle="dropdown" data-placement="bottom-end"\n      aria-label="'+(null==(__t=_.__("oro.workflow.flowchart.transition.actions_label"))?"":_.escape(__t))+'" aria-haspopup="true" aria-expanded="false">\n    </span>\n<ul class="dropdown-menu" role="menu" aria-labelledby="'+(null==(__t=togglerId)?"":_.escape(__t))+'">\n    <li class="first">\n        <a class="workflow-step-edit" href="#edit-step"><span class="fa-pencil-square-o" aria-hidden="true"></span>'+(null==(__t=_.__("Edit"))?"":_.escape(__t))+'</a>\n    </li>\n    <li>\n        <a class="workflow-step-clone" href="#clone-step"><span class="fa-files-o" aria-hidden="true"></span>'+(null==(__t=_.__("Clone"))?"":_.escape(__t))+'</a>\n    </li>\n    <li>\n        <a class="workflow-step-delete" href="#delete-step"><span class="fa-trash-o" aria-hidden="true"></span>'+(null==(__t=_.__("Delete"))?"":_.escape(__t))+"</a>\n    </li>\n</ul>\n"}return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/flowchart-container.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div data-role="flowchart-error"></div>\n<div class="workflow-flowchart-container" data-role="flowchart-container">\n    <div class="workflow-flowchart-controls clearfix" data-role="flowchart-controls"></div>\n    <div class="workflow-flowchart-wrapper" data-role="flowchart-wrapper">\n        <div class="workflow-flowchart clearfix" data-role="flowchart"></div>\n    </div>\n</div>\n';return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/flowchart-error-message.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="alert alert-'+(null==(__t=type)?"":_.escape(__t))+' alert-icon workflow-flowchart-alert" role="alert">\n    <div class="message">'+(null==(__t=message)?"":_.escape(__t))+"</div>\n</div>\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/viewer/step.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<span class="step-label">'+(null==(__t=label)?"":_.escape(__t))+"</span>\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/viewer/transition.html":(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<span class="transition-label">'+(null==(__t=label)?"":_.escape(__t))+"</span>\n";return __p}},"../node_modules/@oroinc/jsplumb/dist/js/jsPlumb-1.7.10.js":(t,e)=>{(function(){(function(){void 0===Math.sgn&&(Math.sgn=function(t){return 0==t?0:t>0?1:-1});var t=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},e=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n=Math.pow(2,-65),i=function(n,i){for(var r=[],l=o(n,i),a=i.length-1,u=s(l,2*a-1,r,0),h=t(n,i[0]),d=e(h),p=0,f=0;f<u;f++){h=t(n,c(i,a,r[f],null,null));var m=e(h);m<d&&(d=m,p=r[f])}return h=t(n,i[a]),(m=e(h))<d&&(d=m,p=1),{location:p,distance:d}},o=function(e,n){for(var i=n.length-1,o=2*i-1,s=[],r=[],l=[],a=[],c=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;u<=i;u++)s[u]=t(n[u],e);for(u=0;u<=i-1;u++)r[u]=t(n[u+1],n[u]),r[u]=(h=r[u],d=3,{x:h.x*d,y:h.y*d});for(var h,d,p,f,m=0;m<=i-1;m++)for(var g=0;g<=i;g++)l[m]||(l[m]=[]),l[m][g]=(p=r[m],f=s[g],p.x*f.x+p.y*f.y);for(u=0;u<=o;u++)a[u]||(a[u]=[]),a[u].y=0,a[u].x=parseFloat(u)/o;for(var b=i,v=i-1,y=0;y<=b+v;y++){var w=Math.max(0,y-v),_=Math.min(y,b);for(u=w;u<=_;u++)j=y-u,a[u+j].y+=l[j][u]*c[j][u]}return a},s=function(t,e,n,i){var o,u,h=[],d=[],p=[],f=[];switch(r(t,e)){case 0:return 0;case 1:if(i>=64)return n[0]=(t[0].x+t[e].x)/2,1;if(l(t,e))return n[0]=a(t,e),1}c(t,e,.5,h,d),o=s(h,e,p,i+1),u=s(d,e,f,i+1);for(var m=0;m<o;m++)n[m]=p[m];for(m=0;m<u;m++)n[m+o]=f[m];return o+u},r=function(t,e){var n,i,o=0;n=i=Math.sgn(t[0].y);for(var s=1;s<=e;s++)(n=Math.sgn(t[s].y))!=i&&o++,i=n;return o},l=function(t,e){var i,o,s,r,l,a,c,u;r=t[0].y-t[e].y,l=t[e].x-t[0].x,a=t[0].x*t[e].y-t[e].x*t[0].y;for(var h=max_distance_below=0,d=1;d<e;d++){var p=r*t[d].x+l*t[d].y+a;p>h?h=p:p<max_distance_below&&(max_distance_below=p)}return i=(1*(a-h)-0*(u=l))*(1/(0*u-1*r)),c=r,u=l,o=(1*(a-max_distance_below)-0*u)*(1/(0*u-1*c)),s=Math.min(i,o),Math.max(i,o)-s<n?1:0},a=function(t,e){var n=t[e].x-t[0].x,i=t[e].y-t[0].y,o=t[0].x-0;return 0+(n*(t[0].y-0)-i*o)*(1/(0*n-1*i))*1},c=function(t,e,n,i,o){for(var s=[[]],r=0;r<=e;r++)s[0][r]=t[r];for(var l=1;l<=e;l++)for(r=0;r<=e-l;r++)s[l]||(s[l]=[]),s[l][r]||(s[l][r]={}),s[l][r].x=(1-n)*s[l-1][r].x+n*s[l-1][r+1].x,s[l][r].y=(1-n)*s[l-1][r].y+n*s[l-1][r+1].y;if(null!=i)for(r=0;r<=e;r++)i[r]=s[r][0];if(null!=o)for(r=0;r<=e;r++)o[r]=s[e-r][r];return s[e][0]},u={},h=function(t,e){for(var n=function(t){var e=u[t];if(!e){var n=function(t){return function(e){return t}},i=function(){return function(t){return t}},o=function(){return function(t){return 1-t}},s=function(t){return function(e){for(var n=1,i=0;i<t.length;i++)n*=t[i](e);return n}};(e=[]).push(new function(){return function(e){return Math.pow(e,t)}});for(var r=1;r<t;r++){for(var l=[new n(t)],a=0;a<t-r;a++)l.push(new i);for(a=0;a<r;a++)l.push(new o);e.push(new s(l))}e.push(new function(){return function(e){return Math.pow(1-e,t)}}),u[t]=e}return e}(t.length-1),i=0,o=0,s=0;s<t.length;s++)i+=t[s].x*n[s](e),o+=t[s].y*n[s](e);return{x:i,y:o}},d=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},p=function(t){return t[0].x==t[1].x&&t[0].y==t[1].y},f=function(t,e,n){if(p(t))return{point:t[0],location:e};for(var i=h(t,e),o=0,s=e,r=n>0?1:-1,l=null;o<Math.abs(n);)l=h(t,s+=.005*r),o+=d(l,i),i=l;return{point:l,location:s}},m=function(t,e){var n=h(t,e),i=h(t.slice(0,t.length-1),e),o=i.y-n.y,s=i.x-n.x;return 0==o?1/0:Math.atan(o/s)};this.jsBezier={distanceFromCurve:i,gradientAtPoint:m,gradientAtPointAlongCurveFrom:function(t,e,n){var i=f(t,e,n);return i.location>1&&(i.location=1),i.location<0&&(i.location=0),m(t,i.location)},nearestPointOnCurve:function(t,e){var n=i(t,e);return{point:c(e,e.length-1,n.location,null,null),location:n.location}},pointOnCurve:h,pointAlongCurveFrom:function(t,e,n){return f(t,e,n).point},perpendicularToCurveAt:function(t,e,n,i){var o=f(t,e,i=null==i?0:i),s=m(t,o.location),r=Math.atan(-1/s),l=n/2*Math.sin(r),a=n/2*Math.cos(r);return[{x:o.point.x+a,y:o.point.y+l},{x:o.point.x-a,y:o.point.y-l}]},locationAlongCurveFrom:function(t,e,n){return f(t,e,n).location},getLength:function(t){if(p(t))return 0;for(var e=h(t,0),n=0,i=0,o=null;i<1;)o=h(t,i+=.005),n+=d(o,e),e=o;return n}}}).call(this),function(){"use strict";var t=this.Biltong={},e=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=function(t,n,i){return i(t=e(t)?t:[t.x,t.y],n=e(n)?n:[n.x,n.y])},i=t.gradient=function(t,e){return n(t,e,(function(t,e){return e[0]==t[0]?e[1]>t[1]?1/0:-1/0:e[1]==t[1]?e[0]>t[0]?0:-0:(e[1]-t[1])/(e[0]-t[0])}))},o=(t.normal=function(t,e){return-1/i(t,e)},t.lineLength=function(t,e){return n(t,e,(function(t,e){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))}))},t.quadrant=function(t,e){return n(t,e,(function(t,e){return e[0]>t[0]||e[0]==t[0]?e[1]>t[1]?2:1:e[1]>t[1]?3:4}))}),s=(t.theta=function(t,e){return n(t,e,(function(t,e){var n=i(t,e),s=Math.atan(n),r=o(t,e);return 4!=r&&3!=r||(s+=Math.PI),s<0&&(s+=2*Math.PI),s}))},t.intersects=function(t,e){var n=t.x,i=t.x+t.w,o=t.y,s=t.y+t.h,r=e.x,l=e.x+e.w,a=e.y,c=e.y+e.h;return n<=r&&r<=i&&o<=a&&a<=s||n<=l&&l<=i&&o<=a&&a<=s||n<=r&&r<=i&&o<=c&&c<=s||n<=l&&r<=i&&o<=c&&c<=s||r<=n&&n<=l&&a<=o&&o<=c||r<=i&&i<=l&&a<=o&&o<=c||r<=n&&n<=l&&a<=s&&s<=c||r<=i&&n<=l&&a<=s&&s<=c},t.encloses=function(t,e,n){var i=t.x,o=t.x+t.w,s=t.y,r=t.y+t.h,l=e.x,a=e.x+e.w,c=e.y,u=e.y+e.h,h=function(t,e,i,o){return n?t<=e&&i>=o:t<e&&i>o};return h(i,l,o,a)&&h(s,c,r,u)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),r=[null,[-1,-1],[-1,1],[1,1],[1,-1]];t.pointOnLine=function(t,e,n){var l=i(t,e),a=o(t,e),c=n>0?s[a]:r[a],u=Math.atan(l),h=Math.abs(n*Math.sin(u))*c[1],d=Math.abs(n*Math.cos(u))*c[0];return{x:t.x+d,y:t.y+h}},t.perpendicularLineTo=function(t,e,n){var o=i(t,e),s=Math.atan(-1/o),r=n/2*Math.sin(s),l=n/2*Math.cos(s);return[{x:e.x+l,y:e.y+r},{x:e.x-l,y:e.y-r}]}}.call(this),function(){"use strict";var t=navigator.userAgent.toLowerCase().indexOf("android")>-1,e=function(t,e,n){for(var i=(n=n||t.parentNode).querySelectorAll(e),o=0;o<i.length;o++)if(i[o]===t)return!0;return!1},n=function(t){return"string"==typeof t?document.getElementById(t):t},i=function(t){return t.srcElement||t.target},o=function(t,e){for(var n=0,i=t.length;n<i&&t[n]!=e;n++);n<t.length&&t.splice(n,1)},s=1,r=function(t,e,n){var i=s++;return t.__ta=t.__ta||{},t.__ta[e]=t.__ta[e]||{},t.__ta[e][i]=n,n.__tauid=i,i},l=function(t,n,o,s){if(null==t)return o;var r=t.split(","),l=function(t){l.__tauid=o.__tauid;for(var s=i(t),a=0;a<r.length;a++)e(s,r[a],n)&&o.apply(s,arguments)};return a(o,s,l),l},a=function(t,e,n){t.__taExtra=t.__taExtra||[],t.__taExtra.push([e,n])},c=function(t,e,n,i){if(f&&g[e]){var o=l(i,t,n,g[e]);P(t,g[e],o,n)}"focus"===e&&null==t.getAttribute("tabindex")&&t.setAttribute("tabindex","1"),P(t,e,l(i,t,n,e),n)},u={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},h=function(t,n){return function(s,r,l,a){if("contextmenu"==r&&m)c(s,r,l,a);else{if(null==s.__taTapHandler){var h=s.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},d=function(){h.down=!1},p=function(){h.taps=0};c(s,"mousedown",(function(i){for(var o=i.srcElement||i.target,r=0;r<h.downSelectors.length;r++)if(null==h.downSelectors[r]||e(o,h.downSelectors[r],s)){h.down=!0,setTimeout(d,t),setTimeout(p,n);break}})),c(s,"mouseup",(function(t){if(h.down){var n=t.srcElement||t.target;h.taps++;var o=x(t);for(var r in u){var l=u[r];if(l.touches===o&&(1===l.taps||l.taps===h.taps))for(var a=0;a<h[r].length;a++)(null==h[r][a][1]||e(n,h[r][a][1],s))&&h[r][a][0].apply(i(t),[t])}}}))}s.__taTapHandler.downSelectors.push(a),s.__taTapHandler[r].push([l,a]),l.__taUnstore=function(){o(s.__taTapHandler[r],l)}}}},d=function(t,e,n,i){for(var o in n.__tamee[t])n.__tamee[t][o].apply(i,[e])},p=function(){var t=[];return function(n,o,s,a){if(!n.__tamee){n.__tamee={over:!1,mouseenter:[],mouseexit:[]};var c=function(o){var s=i(o);(null==a&&s==n&&!n.__tamee.over||e(s,a,n)&&(null==s.__tamee||!s.__tamee.over))&&(d("mouseenter",o,n,s),s.__tamee=s.__tamee||{},s.__tamee.over=!0,t.push(s))},u=function(o){for(var s=i(o),r=0;r<t.length;r++)s!=t[r]||e(o.relatedTarget||o.toElement,"*",s)||(s.__tamee.over=!1,t.splice(r,1),d("mouseexit",o,n,s))};P(n,"mouseover",l(a,n,c,"mouseover"),c),P(n,"mouseout",l(a,n,u,"mouseout"),u)}s.__taUnstore=function(){delete n.__tamee[o][s.__tauid]},r(n,o,s),n.__tamee[o][s.__tauid]=s}},f="ontouchstart"in document.documentElement,m="onmousedown"in document.documentElement,g={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},b=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),v=b>-1&&b<9,y=function(t,e){if(null==t)return[0,0];var n=j(t),i=_(n,0);return[i[e+"X"],i[e+"Y"]]},w=function(t){return null==t?[0,0]:v?[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop]:y(t,"page")},_=function(t,e){return t.item?t.item(e):t[e]},j=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},x=function(t){return j(t).length},P=function(t,e,n,i){if(r(t,e,n),i.__tauid=n.__tauid,t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent){var o=e+n.__tauid;t["e"+o]=n,t[o]=function(){t["e"+o]&&t["e"+o](window.event)},t.attachEvent("on"+e,t[o])}},C=function(t,e,i){null!=i&&S(t,(function(){var o=n(this);if(function(t,e,n){if(t.__ta&&t.__ta[e]&&delete t.__ta[e][n.__tauid],n.__taExtra){for(var i=0;i<n.__taExtra.length;i++)C(t,n.__taExtra[i][0],n.__taExtra[i][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}(o,e,i),null!=i.__tauid)if(o.removeEventListener)o.removeEventListener(e,i,!1),f&&g[e]&&o.removeEventListener(g[e],i,!1);else if(this.detachEvent){var s=e+i.__tauid;o[s]&&o.detachEvent("on"+e,o[s]),o[s]=null,o["e"+s]=null}i.__taTouchProxy&&C(t,i.__taTouchProxy[1],i.__taTouchProxy[0])}))},S=function(t,e){if(null!=t){t="undefined"!=typeof Window&&"unknown"!=typeof t.top&&t==t.top?[t]:"string"!=typeof t&&null==t.tagName&&null!=t.length?t:"string"==typeof t?document.querySelectorAll(t):[t];for(var n=0;n<t.length;n++)e.apply(t[n])}};this.Mottle=function(e){var s=(e=e||{}).clickThreshold||150,r=e.dblClickThreshold||350,l=new p,a=new h(s,r),u=e.smartClicks;this.remove=function(t){return S(t,(function(){var t=n(this);if(t.__ta)for(var e in t.__ta)for(var i in t.__ta[e])C(t,e,t.__ta[e][i]);t.parentNode&&t.parentNode.removeChild(t)})),this},this.on=function(t,e,s,r){return function(t,e,s,r){null!=s&&S(t,(function(){var t=n(this);u&&"click"===e?function(t,e,n,s){null==t.__taSmartClicks&&(c(t,"mousedown",(function(e){t.__tad=w(e)}),s),c(t,"mouseup",(function(e){t.__tau=w(e)}),s),c(t,"click",(function(e){if(t.__tad&&t.__tau&&t.__tad[0]===t.__tau[0]&&t.__tad[1]===t.__tau[1])for(var n=0;n<t.__taSmartClicks.length;n++)t.__taSmartClicks[n].apply(i(e),[e])}),s),t.__taSmartClicks=[]),t.__taSmartClicks.push(n),n.__taUnstore=function(){o(t.__taSmartClicks,n)}}(t,0,s,r):"tap"===e||"dbltap"===e||"contextmenu"===e?a(t,e,s,r):"mouseenter"===e||"mouseexit"==e?l(t,e,s,r):c(t,e,s,r)}))}(arguments[0],arguments[1],arguments[arguments.length-1],4==arguments.length?arguments[2]:null),this},this.off=function(t,e,n){return C(t,e,n),this},this.trigger=function(e,i,o,s){var r=m&&("undefined"==typeof MouseEvent||null==o||o.constructor===MouseEvent),l=f&&!m&&g[i]?g[i]:i,a=!(f&&!m&&g[i]),c=w(o),u=y(o,"screen"),h=y(o,"client");return S(e,(function(){var e,d=n(this);o=o||{screenX:u[0],screenY:u[1],clientX:h[0],clientY:h[1]};var p=function(t){s&&(t.payload=s)},m={TouchEvent:function(t){var e=document.createTouch(window,d,0,c[0],c[1],u[0],u[1],h[0],h[1],0,0,0,0),n=document.createTouchList(e),i=document.createTouchList(e),o=document.createTouchList(e);t.initTouchEvent(l,!0,!0,window,null,u[0],u[1],h[0],h[1],!1,!1,!1,!1,n,i,o,1,0)},MouseEvents:function(e){if(e.initMouseEvent(l,!0,!0,window,0,u[0],u[1],h[0],h[1],!1,!1,!1,!1,1,d),t){var n=document.createTouch(window,d,0,c[0],c[1],u[0],u[1],h[0],h[1],0,0,0,0);e.touches=e.targetTouches=e.changedTouches=document.createTouchList(n)}}};if(document.createEvent){var b=a||r||!f||!g[i]||t?"MouseEvents":"TouchEvent";e=document.createEvent(b),m[b](e),p(e),d.dispatchEvent(e)}else document.createEventObject&&((e=document.createEventObject()).eventType=e.eventName=l,e.screenX=u[0],e.screenY=u[1],e.clientX=h[0],e.clientY=h[1],p(e),d.fireEvent("on"+l,e))})),this}},Mottle.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},Mottle.pageLocation=w,Mottle.setForceTouchEvents=function(t){f=t},Mottle.setForceMouseEvents=function(t){m=t}}.call(this),function(){"use strict";var t=function(t,e,n){for(var i=(n=n||t.parentNode).querySelectorAll(e),o=0;o<i.length;o++)if(i[o]===t)return!0;return!1},e=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),n=e>-1&&e<9,i=function(t){if(n)return[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop];var e=s(t),i=o(e,0);return[i.pageX,i.pageY]},o=function(t,e){return t.item?t.item(e):t[e]},s=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},r={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select"},l=["stop","start","drag","drop","over","out"],a=function(){},c=function(){return!0},u=function(t,e,n){for(var i=0;i<t.length;i++)t[i]!=n&&e(t[i])},h=function(t,e,n,i){u(t,(function(t){t.setActive(e),e&&t.updatePosition(),n&&t.setHover(i,e)}))},d=function(t,e){if(null!=t){t="string"!=typeof t&&null==t.tagName&&null!=t.length?t:[t];for(var n=0;n<t.length;n++)e.apply(t[n],[t[n]])}},p=function(t){t.stopPropagation?(t.stopPropagation(),t.preventDefault()):t.returnValue=!1},f=function(t,e,n,i){this.params=e||{},this.el=t,this.params.addClass(this.el,this._class),this.uuid=b();var o=!0;return this.setEnabled=function(t){o=t},this.isEnabled=function(){return o},this.toggleEnabled=function(){o=!o},this.setScope=function(t){this.scopes=t?t.split(/\s+/):[i]},this.addScope=function(t){var e={};for(var n in d(this.scopes,(function(t){e[t]=!0})),d(t?t.split(/\s+/):[],(function(t){e[t]=!0})),this.scopes=[],e)this.scopes.push(n)},this.removeScope=function(t){var e={};for(var n in d(this.scopes,(function(t){e[t]=!0})),d(t?t.split(/\s+/):[],(function(t){delete e[t]})),this.scopes=[],e)this.scopes.push(n)},this.toggleScope=function(t){var e={};for(var n in d(this.scopes,(function(t){e[t]=!0})),d(t?t.split(/\s+/):[],(function(t){e[t]?delete e[t]:e[t]=!0})),this.scopes=[],e)this.scopes.push(n)},this.setScope(e.scope),this.k=e.katavorio,e.katavorio},m=function(e,n,o,s){this._class=o.draggable;var r=f.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var l=[0,0],a=null,u=!1,d=!1!==this.params.consumeStartEvent,m=this.el,g=this.params.clone,v=(this.params.scroll,n.multipleDrop,n.snapThreshold||5),y=function(t,e,n,i,o){i=i||v,o=o||v;var s=e*Math.floor(t[0]/e),r=s+e,l=Math.abs(t[0]-s)<=i?s:Math.abs(r-t[0])<=i?r:t[0],a=n*Math.floor(t[1]/n),c=a+n;return[l,Math.abs(t[1]-a)<=o?a:Math.abs(c-t[1])<=o?c:t[1]]};this.toGrid=function(t){return null==this.params.grid?t:y(t,this.params.grid[0],this.params.grid[1])},this.snap=function(t,e){if(null!=m){t=t||(this.params.grid?this.params.grid[0]:50),e=e||(this.params.grid?this.params.grid[1]:50);var n=this.params.getPosition(m);this.params.setPosition(m,y(n,t,e,t,e))}},this.constrain="function"==typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment?function(t){return[Math.max(0,Math.min(j.w-this.size[0],t[0])),Math.max(0,Math.min(j.h-this.size[1],t[1]))]}:function(t){return t};var w={},_=this.setFilter=function(n,i){if(n){var o="function"==typeof(s=n)?(s._katavorioId=b(),s._katavorioId):s;w[o]=[function(i){var o,s=i.srcElement||i.target;return"string"==typeof n?o=t(s,n,e):"function"==typeof n&&(o=n(i,e)),o},!1!==i]}var s};this.addFilter=_,this.removeFilter=function(t){var e="function"==typeof t?t._katavorioId:t;delete w[e]},this.clearAllFilters=function(){w={}},this.canDrag=this.params.canDrag||c;var j,x=[],P=[];this.downListener=function(e){var n,s,a,c,u,h,f,b,v;if((this.rightButtonCanDrag||3!==e.which&&2!==e.button)&&this.isEnabled()&&this.canDrag()){var y=function(t){for(var e in w){var n=w[e],i=n[0](t);if(n[1]&&(i=!i),!i)return!1}return!0}(e)&&function(e,n,i){var o=e.srcElement||e.target;return!t(o,i.getInputFilterSelector(),n)}(e,this.el,this.k);if(y){if(g){(m=this.el.cloneNode(!0)).setAttribute("id",null),m.style.position="absolute";var _=(n=this.el.getBoundingClientRect(),s=document.body,a=document.documentElement,c=window.pageYOffset||a.scrollTop||s.scrollTop,u=window.pageXOffset||a.scrollLeft||s.scrollLeft,h=a.clientTop||s.clientTop||0,f=a.clientLeft||s.clientLeft||0,b=n.top+c-h,v=n.left+u-f,{top:Math.round(b),left:Math.round(v)});m.style.left=_.left+"px",m.style.top=_.top+"px",document.body.appendChild(m)}else m=this.el;d&&p(e),l=i(e),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),r.markSelection(this),this.params.addClass(document.body,o.noSelect)}else this.params.consumeFilteredEvents&&p(e)}}.bind(this),this.moveListener=function(t){if(l){if(!u&&!1!==S("start",{el:this.el,pos:a,e:t,drag:this})){if(!l)return;this.mark(!0),u=!0}if(l){P.length=0;var e=i(t),n=e[0]-l[0],o=e[1]-l[1],s=this.params.ignoreZoom?1:r.getZoom();n/=s,o/=s,this.moveBy(n,o,t),r.updateSelection(n,o,this)}}}.bind(this),this.upListener=function(t){l&&(l=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,o.noSelect),this.unmark(t),r.unmarkSelection(this,t),this.stop(t),r.notifySelectionDragStop(this,t),u=!1,g&&(m&&m.parentNode&&m.parentNode.removeChild(m),m=null))}.bind(this),this.getFilters=function(){return w},this.abort=function(){null!=l&&this.upListener()},this.getDragElement=function(){return m||this.el};var C={start:[],drag:[],stop:[],over:[],out:[]};n.events.start&&C.start.push(n.events.start),n.events.stop&&C.stop.push(n.events.stop),n.events.drag&&C.drag.push(n.events.drag),this.on=function(t,e){C[t]&&C[t].push(e)};var S=function(t,e){if(C[t])for(var n=0;n<C[t].length;n++)try{C[t][n](e)}catch(t){}};this.notifyStart=function(t){S("start",{el:this.el,pos:this.params.getPosition(m),e:t,drag:this})},this.stop=function(t,e){if(e||u){var n=[],i=r.getSelection(),o=this.params.getPosition(m);if(i.length>1)for(var s=0;s<i.length;s++){var l=this.params.getPosition(i[s].el);n.push([i[s].el,{left:l[0],top:l[1]},i[s]])}else n.push([m,{left:o[0],top:o[1]},this]);S("stop",{el:m,pos:o,e:t,drag:this,selection:n})}},this.mark=function(t){if(a=this.params.getPosition(m),this.size=this.params.getSize(m),x=r.getMatchingDroppables(this),h(x,!0,!1,this),this.params.addClass(m,this.params.dragClass||o.drag),this.params.constrain||this.params.containment){var e=this.params.getSize(m.parentNode);j={w:e[0],h:e[1]}}t&&r.notifySelectionDragStart(this)},this.unmark=function(t){h(x,!1,!0,this),this.params.removeClass(m,this.params.dragClass||o.drag),x.length=0;for(var e=0;e<P.length&&!0!==P[e].drop(this,t);e++);},this.moveBy=function(t,e,n){P.length=0;var i=this.constrain(this.toGrid([a[0]+t,a[1]+e]),m),o={x:i[0],y:i[1],w:this.size[0],h:this.size[1]};this.params.setPosition(m,i);for(var s=0;s<x.length;s++){var r={x:x[s].position[0],y:x[s].position[1],w:x[s].size[0],h:x[s].size[1]};this.params.intersects(o,r)&&x[s].canDrop(this)?(P.push(x[s]),x[s].setHover(this,!0,n)):x[s].isHover()&&x[s].setHover(this,!1,n)}S("drag",{el:this.el,pos:i,e:n,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?_(this.params.handle,!1):_(this.params.filter,this.params.filterExclude)},g=function(t,e,n,i){this._class=n.droppable,this.params=e||{},this._activeClass=e.activeClass||n.active,this._hoverClass=e.hoverClass||n.hover,f.apply(this,arguments);var o=!1;this.setActive=function(t){this.params[t?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(t){return!0},this.isHover=function(){return o},this.setHover=function(t,e,n){(e||null==this.el._katavorioDragHover||this.el._katavorioDragHover==t.el._katavorio)&&(this.params[e?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=e?t.el._katavorio:null,o!==e&&this.params.events[e?"over":"out"]({el:this.el,e:n,drag:t,drop:this}),o=e)},this.drop=function(t,e){return this.params.events.drop({drag:t,e,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,o=null}},b=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))},v=function(t){return null==t||null==(t="string"==typeof t?document.getElementById(t):t)?null:(t._katavorio=t._katavorio||b(),t)};this.Katavorio=function(t){var e=[],n={};this._dragsByScope={},this._dropsByScope={};var i=1,o=function(t,e){for(var n=0;n<t.scopes.length;n++)e[t.scopes[n]]=e[t.scopes[n]]||[],e[t.scopes[n]].push(t)},s=function(e,n){for(var i=0,o=0;o<e.scopes.length;o++)if(n[e.scopes[o]]){var s=t.indexOf(n[e.scopes[o]],e);-1!=s&&(n[e.scopes[o]].splice(s,1),i++)}return i>0},c=(this.getMatchingDroppables=function(t){for(var e=[],n={},i=0;i<t.scopes.length;i++){var o=this._dropsByScope[t.scopes[i]];if(o)for(var s=0;s<o.length;s++)o[s].canDrop(t)&&!n[o[s].uuid]&&o[s].el!==t.el&&(n[o[s].uuid]=!0,e.push(o[s]))}return e},function(e){e=e||{};var n={events:{}};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];for(i=0;i<l.length;i++)n.events[l[i]]=e[l[i]]||a;return n.katavorio=this,n}.bind(this)),h=function(t,e){for(var n=0;n<l.length;n++)e[l[n]]&&t.on(l[n],e[l[n]])}.bind(this),p={},f=t.css||{},b=t.scope||"katavorio-drag-scope";for(var y in r)p[y]=r[y];for(var y in f)p[y]=f[y];var w=t.inputFilterSelector||"input,textarea,select,button,option";this.getInputFilterSelector=function(){return w},this.setInputFilterSelector=function(t){return w=t,this},this.draggable=function(e,n){var i=[];return d(e,function(e){if(null!=(e=v(e)))if(null==e._katavorioDrag){var s=c(n);e._katavorioDrag=new m(e,s,p,b),o(e._katavorioDrag,this._dragsByScope),i.push(e._katavorioDrag),t.addClass(e,p.draggable)}else h(e._katavorioDrag,n)}.bind(this)),i},this.droppable=function(e,n){var i=[];return d(e,function(e){null!=(e=v(e))&&(e._katavorioDrop=new g(e,c(n),p,b),o(e._katavorioDrop,this._dropsByScope),i.push(e._katavorioDrop),t.addClass(e,p.droppable))}.bind(this)),i},this.select=function(i){return d(i,(function(){var i=v(this);i&&i._katavorioDrag&&(n[i._katavorio]||(e.push(i._katavorioDrag),n[i._katavorio]=[i,e.length-1],t.addClass(i,p.selected)))})),this},this.deselect=function(i){return d(i,(function(){var i=v(this);if(i&&i._katavorio&&n[i._katavorio]){for(var o=[],s=0;s<e.length;s++)e[s].el!==i&&o.push(e[s]);e=o,delete n[i._katavorio],t.removeClass(i,p.selected)}})),this},this.deselectAll=function(){for(var i in n){var o=n[i];t.removeClass(o[0],p.selected)}e.length=0,n={}},this.markSelection=function(t){u(e,(function(t){t.mark()}),t)},this.unmarkSelection=function(t,n){u(e,(function(t){t.unmark(n)}),t)},this.getSelection=function(){return e.slice(0)},this.updateSelection=function(t,n,i){u(e,(function(e){e.moveBy(t,n)}),i)},this.notifySelectionDragStop=function(t,n){u(e,(function(t){t.stop(n,!0)}),t)},this.notifySelectionDragStart=function(t,n){u(e,(function(t){t.notifyStart(n)}),t)},this.setZoom=function(t){i=t},this.getZoom=function(){return i};var _=function(t,e,n,i){null!=t&&(s(t,n),t[i](e),o(t,n))};d(["set","add","remove","toggle"],function(t){this[t+"Scope"]=function(e,n){_(e._katavorioDrag,n,this._dragsByScope,t+"Scope"),_(e._katavorioDrop,n,this._dropsByScope,t+"Scope")}.bind(this),this[t+"DragScope"]=function(e,n){_(e._katavorioDrag,n,this._dragsByScope,t+"Scope")}.bind(this),this[t+"DropScope"]=function(e,n){_(e._katavorioDrop,n,this._dropsByScope,t+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(t,e){for(var n in this._dragsByScope)u(this._dragsByScope[n],(function(n){n.snap(t,e)}))},this.getDragsForScope=function(t){return this._dragsByScope[t]},this.getDropsForScope=function(t){return this._dropsByScope[t]};var j=function(t,e,n){(t=v(t))[e]&&(s(t[e],n)&&t[e].destroy(),t[e]=null)};this.elementRemoved=function(t){this.destroyDraggable(t),this.destroyDroppable(t)},this.destroyDraggable=function(t){j(t,"_katavorioDrag",this._dragsByScope)},this.destroyDroppable=function(t){j(t,"_katavorioDrop",this._dropsByScope)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},e=[],n={}}}}.call(this),function(){var t=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e=function(t){return"string"==typeof t},n=function(t){return"boolean"==typeof t},i=function(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)},o=function(t){return"[object Date]"===Object.prototype.toString.call(t)},s=function(t){return"[object Function]"===Object.prototype.toString.call(t)},r=this.jsPlumbUtil={isArray:t,isString:e,isBoolean:n,isNull:function(t){return null==t},isObject:i,isDate:o,isFunction:s,isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)},clone:function(r){if(e(r))return""+r;if(n(r))return!!r;if(o(r))return new Date(r.getTime());if(s(r))return r;if(t(r)){for(var l=[],a=0;a<r.length;a++)l.push(this.clone(r[a]));return l}if(i(r)){var c={};for(var u in r)c[u]=this.clone(r[u]);return c}return r},merge:function(o,s,r){var l,a,c={};for(r=r||[],a=0;a<r.length;a++)c[r[a]]=!0;var u=this.clone(o);for(a in s)if(null==u[a])u[a]=s[a];else if(e(s[a])||n(s[a]))c[a]?((l=[]).push.apply(l,t(u[a])?u[a]:[u[a]]),l.push.apply(l,t(s[a])?s[a]:[s[a]]),u[a]=l):u[a]=s[a];else if(t(s[a]))l=[],t(u[a])&&l.push.apply(l,u[a]),l.push.apply(l,s[a]),u[a]=l;else if(i(s[a]))for(var h in i(u[a])||(u[a]={}),s[a])u[a][h]=s[a][h];return u},replace:function(t,e,n){if(null!=t){var i=t;return e.replace(/([^\.])+/g,(function(t,e,o,s){var r=t.match(/([^\[0-9]+){1}(\[)([0-9+])/),l=function(){return i[r[1]]||(i[r[1]]=[],i[r[1]])};if(o+t.length>=s.length)r?l()[r[3]]=n:i[t]=n;else if(r){var a=l();i=a[r[3]]||(a[r[3]]={},a[r[3]])}else i=i[t]||(i[t]={},i[t])})),t}},functionChain:function(t,e,n){for(var i=0;i<n.length;i++){var o=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(o===e)return o}return t},populate:function(n,o){var s=function(n){if(null!=n){if(e(n))return function(t){var e=t.match(/(\${.*?})/g);if(null!=e)for(var n=0;n<e.length;n++){var i=o[e[n].substring(2,e[n].length-1)]||"";null!=i&&(t=t.replace(e[n],i))}return t}(n);if(t(n)){for(var r=[],l=0;l<n.length;l++)r.push(s(n[l]));return r}if(i(n)){var a={};for(var c in n)a[c]=s(n[c]);return a}return n}};return s(n)},findWithFunction:function(t,e){if(t)for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1},indexOf:function(t,e){return t.indexOf?t.indexOf(e):r.findWithFunction(t,(function(t){return t==e}))},removeWithFunction:function(t,e){var n=r.findWithFunction(t,e);return n>-1&&t.splice(n,1),-1!=n},remove:function(t,e){var n=r.indexOf(t,e);return n>-1&&t.splice(n,1),-1!=n},addWithFunction:function(t,e,n){-1==r.findWithFunction(t,n)&&t.push(e)},addToList:function(t,e,n,i){var o=t[e];return null==o&&(o=[],t[e]=o),o[i?"unshift":"push"](n),o},extend:function(e,n,i){var o;for(n=t(n)?n:[n],o=0;o<n.length;o++)for(var s in n[o].prototype)n[o].prototype.hasOwnProperty(s)&&(e.prototype[s]=n[o].prototype[s]);var r=function(t,e){return function(){for(o=0;o<n.length;o++)n[o].prototype[t]&&n[o].prototype[t].apply(this,arguments);return e.apply(this,arguments)}},l=function(t){for(var n in t)e.prototype[n]=r(n,t[n])};if(arguments.length>2)for(o=2;o<arguments.length;o++)l(arguments[o]);return e},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))},logEnabled:!0,log:function(){if(r.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1];console.log(t)}catch(t){}},wrap:function(t,e,n){return t=t||function(){},e=e||function(){},function(){var i=null;try{i=e.apply(this,arguments)}catch(t){r.log("jsPlumb function failed : "+t)}if(null==n||i!==n)try{i=t.apply(this,arguments)}catch(t){r.log("wrapped function failed : "+t)}return i}}};r.EventGenerator=function(){var t={},e=!1,n={ready:!0};this.bind=function(e,n,i){var o=function(e){r.addToList(t,e,n,i),n.__jsPlumb=n.__jsPlumb||{},n.__jsPlumb[jsPlumbUtil.uuid()]=e};if("string"==typeof e)o(e);else if(null!=e.length)for(var s=0;s<e.length;s++)o(e[s]);return this},this.fire=function(i,o,s){if(!e&&t[i]){var l=t[i].length,a=0,c=!1,u=null;if(!this.shouldFireEvent||this.shouldFireEvent(i,o,s))for(;!c&&a<l&&!1!==u;){if(n[i])t[i][a].apply(this,[o,s]);else try{u=t[i][a].apply(this,[o,s])}catch(t){r.log("jsPlumb: fire failed for event "+i+" : "+t)}a++,null!=t&&null!=t[i]||(c=!0)}}return this},this.unbind=function(e,n){if(0===arguments.length)t={};else if(1===arguments.length){if("string"==typeof e)delete t[e];else if(e.__jsPlumb){var i;for(var o in e.__jsPlumb)i=e.__jsPlumb[o],r.remove(t[i]||[],e)}}else 2===arguments.length&&r.remove(t[e]||[],n);return this},this.getListener=function(e){return t[e]},this.setSuspendEvents=function(t){e=t},this.isSuspendEvents=function(){return e},this.silently=function(t){this.setSuspendEvents(!0);try{t()}catch(t){jsPlumbUtil.log("Cannot execute silent function "+t)}this.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var e in t)t[e]=null}},r.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}},Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},o=function(){return n.apply(this instanceof i&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o})}.call(this),function(){"use strict";var t=this.jsPlumbUtil;t.ieVersion=/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1,t.oldIE=t.ieVersion>-1&&t.ieVersion<9,t.matchesSelector=function(t,e,n){for(var i=(n=n||t.parentNode).querySelectorAll(e),o=0;o<i.length;o++)if(i[o]===t)return!0;return!1},t.consume=function(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()},t.sizeElement=function(t,e,n,i,o){t&&(t.style.height=o+"px",t.height=o,t.style.width=i+"px",t.width=i,t.style.left=e+"px",t.style.top=n+"px")}}.call(this),function(){"use strict";var t,n=[],i=this.jsPlumbUtil,o=function(){return""+(new Date).getTime()},s=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var e={};f.extend(e,t._jsPlumb.paintStyle),f.extend(e,t._jsPlumb.hoverPaintStyle),delete t._jsPlumb.hoverPaintStyle,e.gradient&&t._jsPlumb.paintStyle.fillStyle&&delete e.gradient,t._jsPlumb.hoverPaintStyle=e}},r=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],l=function(t){return null==t?null:t.split(" ")},a=function(t,e,n){for(var i in e)t[i]=n},c=function(t,e,n){if(t.getDefaultType){var o=t.getTypeDescriptor(),s={},r=t.getDefaultType(),l=i.merge({},r);a(s,r,"__default");for(var c=0,u=t._jsPlumb.types.length;c<u;c++){var h=t._jsPlumb.types[c];if("__default"!==h){var d=t._jsPlumb.instance.getType(h,o);null!=d&&(l=i.merge(l,d,["cssClass"]),a(s,d,h))}}e&&(l=i.populate(l,e)),t.applyType(l,n,s),n||t.repaint()}},u=window.jsPlumbUIComponent=function(t){jsPlumbUtil.EventGenerator.apply(this,arguments);var e=arguments,n=this.idPrefix+(new Date).getTime();this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(t,e,n){this._jsPlumb.typeCache[n]=this._jsPlumb.typeCache[n]||{},this._jsPlumb.typeCache[n][t]=e},this.getCachedTypeItem=function(t,e){return this._jsPlumb.typeCache[e]?this._jsPlumb.typeCache[e][t]:null},this.getId=function(){return n};var o=t.overlays||[],s={};if(this.defaultOverlayKeys){for(var r=0;r<this.defaultOverlayKeys.length;r++)Array.prototype.push.apply(o,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[r]]||[]);for(r=0;r<o.length;r++){var l=f.convertToFullOverlaySpec(o[r]);s[l[1].id]=l}}var a={overlays:s,parameters:t.parameters||{},scope:t.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return a},this.appendToDefaultType=function(t){for(var e in t)a[e]=t[e]},t.events)for(r in t.events)this.bind(r,t.events[r]);this.clone=function(){var t={};return this.constructor.apply(t,e),t}.bind(this),this.isDetachAllowed=function(t){var e=!0;if(this._jsPlumb.beforeDetach)try{e=this._jsPlumb.beforeDetach(t)}catch(t){i.log("jsPlumb: beforeDetach callback failed",t)}return e},this.isDropAllowed=function(t,e,n,o,s,r,l){var a=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:e,scope:n,connection:o,dropEndpoint:s,source:r,target:l});if(this._jsPlumb.beforeDrop)try{a=this._jsPlumb.beforeDrop({sourceId:t,targetId:e,scope:n,connection:o,dropEndpoint:s,source:r,target:l})}catch(t){i.log("jsPlumb: beforeDrop callback failed",t)}return a};var c=[];this.setListenerComponent=function(t){for(var e=0;e<c.length;e++)c[e][3]=t}},h=function(t,e){var n=t._jsPlumb.types[e],i=t._jsPlumb.instance.getType(n,t.getTypeDescriptor());null!=i&&i.cssClass&&t.canvas&&t._jsPlumb.instance.removeClass(t.canvas,i.cssClass)};jsPlumbUtil.extend(u,jsPlumbUtil.EventGenerator,{getParameter:function(t){return this._jsPlumb.parameters[t]},setParameter:function(t,e){this._jsPlumb.parameters[t]=e},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(t){this._jsPlumb.parameters=t},getClass:function(){return f.getClass(this.canvas)},hasClass:function(t){return f.hasClass(this.canvas,t)},addClass:function(t){f.addClass(this.canvas,t)},removeClass:function(t){f.removeClass(this.canvas,t)},updateClasses:function(t,e){f.updateClasses(this.canvas,t,e)},setType:function(t,e,n){this.clearTypes(),this._jsPlumb.types=l(t)||[],c(this,e,n)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(t,e){c(this,t,e)},hasType:function(t){return-1!=jsPlumbUtil.indexOf(this._jsPlumb.types,t)},addType:function(t,e,n){var i=l(t),o=!1;if(null!=i){for(var s=0,r=i.length;s<r;s++)this.hasType(i[s])||(this._jsPlumb.types.push(i[s]),o=!0);o&&c(this,e,n)}},removeType:function(t,e){var n=l(t),o=!1,s=function(t){var e=i.indexOf(this._jsPlumb.types,t);return-1!=e&&(h(this,e),this._jsPlumb.types.splice(e,1),!0)}.bind(this);if(null!=n){for(var r=0,a=n.length;r<a;r++)o=s(n[r])||o;o&&c(this,null,e)}},clearTypes:function(t){for(var e=this._jsPlumb.types.length,n=0;n<e;n++)h(this,0),this._jsPlumb.types.splice(0,1);c(this,{},t)},toggleType:function(t,e,n){var i=l(t);if(null!=i){for(var o=0,s=i.length;o<s;o++){var r=jsPlumbUtil.indexOf(this._jsPlumb.types,i[o]);-1!=r?(h(this,r),this._jsPlumb.types.splice(r,1)):this._jsPlumb.types.push(i[o])}c(this,e,n)}},applyType:function(t,e){if(this.setPaintStyle(t.paintStyle,e),this.setHoverPaintStyle(t.hoverPaintStyle,e),t.parameters)for(var n in t.parameters)this.setParameter(n,t.parameters[n]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(t,e){this._jsPlumb.paintStyle=t,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,s(this),e||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(t,e){this._jsPlumb.hoverPaintStyle=t,s(this),e||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(t){(t||null==this.typeId)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(t,e,n){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){if(this._jsPlumb.hover=t,null!=this.canvas){if(null!=this._jsPlumb.instance.hoverClass){var i=t?"addClass":"removeClass";this._jsPlumb.instance[i](this.canvas,this._jsPlumb.instance.hoverClass)}null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[i](this.canvas,this._jsPlumb.hoverClass)}null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=t?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(n=n||o(),this.repaint({timestamp:n,recalc:!1}))),this.getAttachedElements&&!e&&function(t,e,n,i){var o=t.getAttachedElements();if(o)for(var s=0,r=o.length;s<r;s++)i&&i==o[s]||o[s].setHover(e,!0,n)}(this,t,o(),this)}}});var d=0,p=window.jsPlumbInstance=function(e){this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:4,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},e&&f.extend(this.Defaults,e),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},jsPlumbUtil.EventGenerator.apply(this);var s=this,l=function(){var t=d+1;return d++,t}(),a=s.bind,c={},h=1,p=function(t){if(null==t)return null;if(3==t.nodeType||8==t.nodeType)return{el:t,text:!0};var e=s.getElement(t);return{el:e,id:jsPlumbUtil.isString(t)&&null==e?t:U(e)}};for(var m in this.getInstanceIndex=function(){return l},this.setZoom=function(t,e){return jsPlumbUtil.oldIE||(h=t,s.fire("zoom",h),e&&s.repaintEverything()),!jsPlumbUtil.oldIE},this.getZoom=function(){return h},this.Defaults)c[m]=this.Defaults[m];var g,b=[];this.unbindContainer=function(){if(null!=g&&b.length>0)for(var t=0;t<b.length;t++)s.off(g,b[t][0],b[t][1])},this.setContainer=function(t){this.unbindContainer(),t=this.getElement(t),this.select().each((function(e){e.moveParent(t)})),this.selectEndpoints().each((function(e){e.moveParent(t)}));var e=g;g=t,b.length=0;for(var n=function(t,e){var n=e.srcElement||e.target,i=(n&&n.parentNode?n.parentNode._jsPlumb:null)||(n?n._jsPlumb:null)||(n&&n.parentNode&&n.parentNode.parentNode?n.parentNode.parentNode._jsPlumb:null);i&&(i.fire(t,i,e),s.fire(t,i.component||i,e))},i=function(t,e,n){b.push([t,n]),s.on(g,t,e,n)},o=function(t){i(t,"._jsPlumb_connector > *",(function(e){n(t,e)})),i(t,"._jsPlumb_endpoint, ._jsPlumb_endpoint > *, ._jsPlumb_endpoint svg *",(function(e){n(t,e)})),i(t,"._jsPlumb_overlay, ._jsPlumb_overlay *",(function(e){n(t,e)}))},l=0;l<r.length;l++)o(r[l]);for(var a in x){var c=x[a].el;c.parentNode===e&&(e.removeChild(c),g.appendChild(c))}},this.getContainer=function(){return g},this.bind=function(t,e){"ready"===t&&y?e():a.apply(s,[t,e])},s.importDefaults=function(t){for(var e in t)s.Defaults[e]=t[e];return t.Container&&s.setContainer(t.Container),s},s.restoreDefaults=function(){return s.Defaults=f.extend({},c),s};var v=null,y=!1,w=[],_={},j={},x={},P={},C={},S={},E=!1,k=[],A=!1,D=null,T=this.Defaults.Scope,O=null,I=1,M=function(){return""+I++},L=function(t,e){g?g.appendChild(t):e?this.getElement(e).appendChild(t):this.appendToRoot(t)}.bind(this),F=function(t,e,n,i){if(!f.headless&&!A){var r=U(t),l=s.getDragManager().getElementsForDraggable(r);null==n&&(n=o());var a=at({elId:r,offset:e,recalc:!1,timestamp:n});if(l)for(var c in l)at({elId:l[c].id,offset:{left:a.o.left+l[c].offset.left,top:a.o.top+l[c].offset.top},recalc:!1,timestamp:n});if(s.anchorManager.redraw(r,e,n,null,i),l)for(var u in l)s.anchorManager.redraw(l[u].id,e,n,l[u].offset,i,!0)}},N=function(t){return j[t]},R=function(t,e,n,o){if(!f.headless&&null!=e&&e&&f.isDragSupported(t,s)){var r=n||s.Defaults.DragOptions;if(r=f.extend({},r),f.isAlreadyDraggable(t,s))n.force&&s.initDraggable(t,r);else{var l=f.dragEvents.drag,a=f.dragEvents.stop,c=f.dragEvents.start,u=s.getElement(t),h=s.getDragManager().getDragAncestor(u),d={left:0,top:0},p=d,m=!1;lt(o,t),r[c]=i.wrap(r[c],(function(){if(p=null!=h?s.getOffset(h):d,s.setHoverSuspended(!0),s.select({source:t}).addClass(s.elementDraggingClass+" "+s.sourceElementDraggingClass,!0),s.select({target:t}).addClass(s.elementDraggingClass+" "+s.targetElementDraggingClass,!0),s.setConnectionBeingDragged(!0),r.canDrag)return n.canDrag()}),!1),r[l]=i.wrap(r[l],(function(){var e=s.getUIPosition(arguments,s.getZoom());e.left+=p.left,e.top+=p.top,F(t,e,null,!0),m&&s.addClass(t,"jsPlumb_dragged"),m=!0})),r[a]=i.wrap(r[a],(function(){var e;e=1==arguments.length&&arguments[0].selection&&arguments[0].selection.length>0?arguments[0].selection:[[t,s.getUIPosition(arguments,s.getZoom(),!0)]];for(var n,i=0;i<e.length;i++)n=e[i],F(n[0],n[1]),s.removeClass(n[0],"jsPlumb_dragged"),s.select({source:n[0]}).removeClass(s.elementDraggingClass+" "+s.sourceElementDraggingClass,!0),s.select({target:n[0]}).removeClass(s.elementDraggingClass+" "+s.targetElementDraggingClass,!0),s.getDragManager().dragEnded(n[0]);m=!1,s.setHoverSuspended(!1),s.setConnectionBeingDragged(!1)}));var g=U(t);S[g]=!0;var b=S[g];r.disabled=null!=b&&!b,s.initDraggable(t,r),s.getDragManager().register(t)}}},V=function(t,e){var n=f.extend({},t);if(e&&f.extend(n,e),n.source&&(n.source.endpoint?n.sourceEndpoint=n.source:n.source=s.getElement(n.source)),n.target&&(n.target.endpoint?n.targetEndpoint=n.target:n.target=s.getElement(n.target)),t.uuids&&(n.sourceEndpoint=N(t.uuids[0]),n.targetEndpoint=N(t.uuids[1])),n.sourceEndpoint&&n.sourceEndpoint.isFull())i.log(s,"could not add connection; source endpoint is full");else if(n.targetEndpoint&&n.targetEndpoint.isFull())i.log(s,"could not add connection; target endpoint is full");else{if(!n.type&&n.sourceEndpoint&&(n.type=n.sourceEndpoint.connectionType),n.sourceEndpoint&&n.sourceEndpoint.connectorOverlays){n.overlays=n.overlays||[];for(var o=0,r=n.sourceEndpoint.connectorOverlays.length;o<r;o++)n.overlays.push(n.sourceEndpoint.connectorOverlays[o])}!n["pointer-events"]&&n.sourceEndpoint&&n.sourceEndpoint.connectorPointerEvents&&(n["pointer-events"]=n.sourceEndpoint.connectorPointerEvents);var l=function(t,e,i){if(n[t]&&!n[t].endpoint&&!n[t+"Endpoint"]&&!n.newConnection){var o=i[U(n[t])];if(o){if(!o.enabled)return!1;var r=null!=o.endpoint&&o.endpoint._jsPlumb?o.endpoint:function(t,e,i){return s.addEndpoint(t,function(t,e){var n=f.extend({},t);for(var i in e)e[i]&&(n[i]=e[i]);return n}(e,{anchor:n.anchors?n.anchors[i]:n.anchor,endpoint:n.endpoints?n.endpoints[i]:n.endpoint,paintStyle:n.endpointStyles?n.endpointStyles[i]:n.endpointStyle,hoverPaintStyle:n.endpointHoverStyles?n.endpointHoverStyles[i]:n.endpointHoverStyle}))}(n[t],o.def,e);if(r.isFull())return!1;n[t+"Endpoint"]=r,r._doNotDeleteOnDetach=!1,r._deleteOnDetach=!0,o.uniqueEndpoint&&(o.endpoint?r.finalEndpoint=o.endpoint:(o.endpoint=r,r._deleteOnDetach=!1,r._doNotDeleteOnDetach=!0))}}};if(!1!==l("source",0,this.sourceEndpointDefinitions)&&!1!==l("target",1,this.targetEndpointDefinitions))return n.sourceEndpoint&&n.targetEndpoint&&(function(t,e){for(var n=t.scope.split(/\s/),i=e.scope.split(/\s/),o=0;o<n.length;o++)for(var s=0;s<i.length;s++)if(i[s]==n[o])return!0;return!1}(n.sourceEndpoint,n.targetEndpoint)||(n=null)),n}}.bind(s),z=function(t){var e=s.Defaults.ConnectionType||s.getDefaultConnectionType();t._jsPlumb=s,t.newConnection=z,t.newEndpoint=W,t.endpointsByUUID=j,t.endpointsByElement=_,t.finaliseConnection=B,t.id="con_"+M();var n=new e(t);return n.isDetachable()&&(n.endpoints[0].initDraggable("_jsPlumbSource"),n.endpoints[1].initDraggable("_jsPlumbTarget")),n},B=s.finaliseConnection=function(t,e,n,i){if(e=e||{},t.suspendedEndpoint||w.push(t),t.endpoints[0].isTemporarySource=!1,(null==t.suspendedEndpoint||i)&&s.anchorManager.newConnection(t),F(t.source),!e.doNotFireConnectionEvent&&!1!==e.fireEvent){var o={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]};s.fire("connection",o,n)}},W=function(t,e){var n=s.Defaults.EndpointType||f.Endpoint,i=f.extend({},t);i._jsPlumb=s,i.newConnection=z,i.newEndpoint=W,i.endpointsByUUID=j,i.endpointsByElement=_,i.fireDetachEvent=$,i.elementId=e||U(i.source);var o=new n(i);return o.id="ep_"+M(),lt(i.elementId,i.source),f.headless||s.getDragManager().endpointAdded(i.source,e),o},H=function(t,e,n){var i=_[t];if(i&&i.length)for(var o=0,s=i.length;o<s;o++){for(var r=0,l=i[o].connections.length;r<l;r++)if(e(i[o].connections[r]))return;n&&n(i[o])}},q=function(t,e,n){e="block"===e;var i=null;n&&(i=e?function(t){t.setVisible(!0,!0,!0)}:function(t){t.setVisible(!1,!0,!0)});var o=p(t);H(o.id,(function(t){if(e&&n){var i=t.sourceId===o.id?1:0;t.endpoints[i].isVisible()&&t.setVisible(!0)}else t.setVisible(e)}),i)},U=function(t,e,n){if(jsPlumbUtil.isString(t))return t;if(null==t)return null;var i=s.getAttribute(t,"id");return i&&"undefined"!==i||(2==arguments.length&&void 0!==arguments[1]?i=e:(1==arguments.length||3==arguments.length&&!arguments[2])&&(i="jsPlumb_"+l+"_"+M()),n||s.setAttribute(t,"id",i)),i};this.setConnectionBeingDragged=function(t){E=t},this.isConnectionBeingDragged=function(){return E},this.getManagedElements=function(){return x},this.connectorClass="_jsPlumb_connector",this.connectorOutlineClass="_jsPlumb_connector_outline",this.connectedClass="_jsPlumb_connected",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.hoverSourceClass="_jsPlumb_source_hover",this.hoverTargetClass="_jsPlumb_target_hover",this.dragSelectClass="_jsPlumb_drag_select",this.Anchors={},this.Connectors={svg:{},vml:{}},this.Endpoints={svg:{},vml:{}},this.Overlays={svg:{},vml:{}},this.ConnectorRenderers={},this.SVG="svg",this.VML="vml",this.addEndpoint=function(t,e,n){n=n||{};var o=f.extend({},n);f.extend(o,e),o.endpoint=o.endpoint||s.Defaults.Endpoint,o.paintStyle=o.paintStyle||s.Defaults.EndpointStyle;for(var r=[],l=i.isArray(t)||null!=t.length&&!i.isString(t)?t:[t],a=0,c=l.length;a<c;a++){o.source=s.getElement(l[a]),rt(o.source);var u=U(o.source),h=W(o,u),d=lt(u,o.source).info.o;i.addToList(_,u,h),A||h.paint({anchorLoc:h.anchor.compute({xy:[d.left,d.top],wh:k[u],element:h,timestamp:D}),timestamp:D}),r.push(h),h._doNotDeleteOnDetach=!0}return 1==r.length?r[0]:r},this.addEndpoints=function(t,e,n){for(var o=[],r=0,l=e.length;r<l;r++){var a=s.addEndpoint(t,e[r],n);i.isArray(a)?Array.prototype.push.apply(o,a):o.push(a)}return o},this.animate=function(t,e,n){if(!this.animationSupported)return!1;n=n||{};var o=s.getElement(t),r=U(o),l=f.animEvents.step,a=f.animEvents.complete;n[l]=i.wrap(n[l],(function(){s.revalidate(r)})),n[a]=i.wrap(n[a],(function(){s.revalidate(r)})),s.doAnimate(o,e,n)},this.checkCondition=function(t,e){var n=s.getListener(t),o=!0;if(n&&n.length>0){var r=Array.prototype.slice.call(arguments,1);try{for(var l=0,a=n.length;l<a;l++)o=o&&n[l].apply(n[l],r)}catch(e){i.log(s,"cannot check condition ["+t+"]"+e)}}return o},this.connect=function(t,e){var n,i=V(t,e);if(i){if(null==i.source&&null==i.sourceEndpoint)return void jsPlumbUtil.log("Cannot establish connection - source does not exist");if(null==i.target&&null==i.targetEndpoint)return void jsPlumbUtil.log("Cannot establish connection - target does not exist");rt(i.source),n=z(i),B(n,i)}return n};var X=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],Y=function(t,e,n,i){var o,s,r,l=X[n],a=t[l.elId],c=(t[l.el],t.endpoints[n]),u={index:n,originalSourceId:0===n?a:t.sourceId,newSourceId:t.sourceId,originalTargetId:1==n?a:t.targetId,newTargetId:t.targetId,connection:t};if(e.constructor==f.Endpoint)(o=e).addConnection(t);else if(s=U(e),r=this[l.epDefs][s],s===t[l.elId])o=null;else if(r){if(!r.enabled)return;o=null!=r.endpoint&&r.endpoint._jsPlumb?r.endpoint:this.addEndpoint(e,r.def),r.uniqueEndpoint&&(r.endpoint=o),o._doNotDeleteOnDetach=!1,o._deleteOnDetach=!0,o.addConnection(t)}else(o=t.makeEndpoint(0===n,e,s))._doNotDeleteOnDetach=!1,o._deleteOnDetach=!0;return null!=o&&(c.detachFromConnection(t),t.endpoints[n]=o,t[l.el]=o.element,t[l.elId]=o.elementId,u[0===n?"newSourceId":"newTargetId"]=o.elementId,G(u),i||t.repaint()),u}.bind(this);this.setSource=function(t,e,n){var i=Y(t,e,0,n);this.anchorManager.sourceChanged(i.originalSourceId,i.newSourceId,t)},this.setTarget=function(t,e,n){var i=Y(t,e,1,n);this.anchorManager.updateOtherEndpoint(i.originalSourceId,i.originalTargetId,i.newTargetId,t)},this.deleteEndpoint=function(t,e){var n="string"==typeof t?j[t]:t;return n&&s.deleteObject({endpoint:n,dontUpdateHover:e}),s},this.deleteEveryEndpoint=function(){var t=s.setSuspendDrawing(!0);for(var e in _){var n=_[e];if(n&&n.length)for(var i=0,o=n.length;i<o;i++)s.deleteEndpoint(n[i],!0)}return _={},x={},j={},P={},C={},s.anchorManager.reset(),s.getDragManager().reset(),t||s.setSuspendDrawing(!1),s};var $=function(t,e,n){var i=s.Defaults.ConnectionType||s.getDefaultConnectionType(),o=t.constructor==i?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;e&&s.fire("connectionDetached",o,n),s.anchorManager.connectionDetached(o)},G=s.fireMoveEvent=function(t,e){s.fire("connectionMoved",t,e)};this.unregisterEndpoint=function(t){for(var e in t._jsPlumb.uuid&&(j[t._jsPlumb.uuid]=null),s.anchorManager.deleteEndpoint(t),_){var n=_[e];if(n){for(var i=[],o=0,r=n.length;o<r;o++)n[o]!=t&&i.push(n[o]);_[e]=i}_[e].length<1&&delete _[e]}},this.detach=function(){if(0!==arguments.length){var t=s.Defaults.ConnectionType||s.getDefaultConnectionType(),e=arguments[0].constructor==t,n=2==arguments.length&&e?arguments[1]||{}:arguments[0],i=!1!==n.fireEvent,o=n.forceDetach,r=e?arguments[0]:n.connection;if(r)(o||jsPlumbUtil.functionChain(!0,!1,[[r.endpoints[0],"isDetachAllowed",[r]],[r.endpoints[1],"isDetachAllowed",[r]],[r,"isDetachAllowed",[r]],[s,"checkCondition",["beforeDetach",r]]]))&&r.endpoints[0].detach(r,!1,!0,i);else{var l=f.extend({},n);if(l.uuids)N(l.uuids[0]).detachFrom(N(l.uuids[1]),i);else if(l.sourceEndpoint&&l.targetEndpoint)l.sourceEndpoint.detachFrom(l.targetEndpoint);else{var a=U(s.getElement(l.source)),c=U(s.getElement(l.target));H(a,(function(t){(t.sourceId==a&&t.targetId==c||t.targetId==a&&t.sourceId==c)&&s.checkCondition("beforeDetach",t)&&t.endpoints[0].detach(t,!1,!0,i)}))}}}},this.detachAllConnections=function(t,e){e=e||{},t=s.getElement(t);var n=U(t),i=_[n];if(i&&i.length)for(var o=0,r=i.length;o<r;o++)i[o].detachAll(!1!==e.fireEvent,e.forceDetach);return s},this.detachEveryConnection=function(t){return t=t||{},s.batch((function(){for(var e in _){var n=_[e];if(n&&n.length)for(var i=0,o=n.length;i<o;i++)n[i].detachAll(!1!==t.fireEvent,t.forceDetach)}w.length=0})),s},this.deleteObject=function(t){var e={endpoints:{},connections:{},endpointCount:0,connectionCount:0},n=!1!==t.fireEvent,i=!1!==t.deleteAttachedObjects,o=function(n){if(null!=n&&null==e.connections[n.id]&&(t.dontUpdateHover||null==n._jsPlumb||n.setHover(!1),e.connections[n.id]=n,e.connectionCount++,i))for(var o=0;o<n.endpoints.length;o++)n.endpoints[o]._deleteOnDetach&&r(n.endpoints[o])},r=function(n){if(null!=n&&null==e.endpoints[n.id]&&(t.dontUpdateHover||null==n._jsPlumb||n.setHover(!1),e.endpoints[n.id]=n,e.endpointCount++,i))for(var s=0;s<n.connections.length;s++){var r=n.connections[s];o(r)}};for(var l in t.connection?o(t.connection):r(t.endpoint),e.connections){var a=e.connections[l];a._jsPlumb&&(jsPlumbUtil.removeWithFunction(w,(function(t){return a.id==t.id})),$(a,n,t.originalEvent),a.endpoints[0].detachFromConnection(a),a.endpoints[1].detachFromConnection(a),a.cleanup(!0),a.destroy(!0))}for(var c in e.endpoints){var u=e.endpoints[c];u._jsPlumb&&(s.unregisterEndpoint(u),u.cleanup(!0),u.destroy(!0))}return e},this.draggable=function(t,e){var n,i,o;if("object"==typeof t&&t.length)for(n=0,i=t.length;n<i;n++)(o=p(t[n])).el&&R(o.el,!0,e,o.id);else(o=p(t)).el&&R(o.el,!0,e,o.id);return s};var Z=function(t,e,n){return function(){return function(t,e,n,i){for(var o=0,s=t.length;o<s;o++)t[o][e].apply(t[o],n);return i(t)}(t,e,arguments,n)}},J=function(t,e){return function(){return function(t,e,n){for(var i=[],o=0,s=t.length;o<s;o++)i.push([t[o][e].apply(t[o],n),t[o]]);return i}(t,e,arguments)}},K=function(t,e){var n=[];if(t)if("string"==typeof t){if("*"===t)return t;n.push(t)}else if(e)n=t;else if(t.length)for(var i=0,o=t.length;i<o;i++)n.push(p(t[i]).id);else n.push(p(t).id);return n},Q=function(t,e,n){return"*"===t||(t.length>0?-1!=jsPlumbUtil.indexOf(t,e):!n)};this.getConnections=function(t,e){t?t.constructor==String&&(t={scope:t}):t={};for(var n=t.scope||s.getDefaultScope(),i=K(n,!0),o=K(t.source),r=K(t.target),l=!e&&i.length>1?{}:[],a=function(t,n){if(!e&&i.length>1){var o=l[t];null==o&&(o=l[t]=[]),o.push(n)}else l.push(n)},c=0,u=w.length;c<u;c++){var h=w[c];Q(i,h.scope)&&Q(o,h.sourceId)&&Q(r,h.targetId)&&a(h.scope,h)}return l};var tt=function(t,e){return function(n){for(var i=0,o=t.length;i<o;i++)n(t[i]);return e(t)}},et=function(t){return function(e){return t[e]}},nt=function(t,e){var n,i,o={length:t.length,each:tt(t,e),get:et(t)},s=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],r=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(n=0,i=s.length;n<i;n++)o[s[n]]=Z(t,s[n],e);for(n=0,i=r.length;n<i;n++)o[r[n]]=J(t,r[n]);return o},it=function(t){var e=nt(t,it);return f.extend(e,{setDetachable:Z(t,"setDetachable",it),setReattach:Z(t,"setReattach",it),setConnector:Z(t,"setConnector",it),detach:function(){for(var e=0,n=t.length;e<n;e++)s.detach(t[e])},isDetachable:J(t,"isDetachable"),isReattach:J(t,"isReattach")})},ot=function(t){var e=nt(t,ot);return f.extend(e,{setEnabled:Z(t,"setEnabled",ot),setAnchor:Z(t,"setAnchor",ot),isEnabled:J(t,"isEnabled"),detachAll:function(){for(var e=0,n=t.length;e<n;e++)t[e].detachAll()},remove:function(){for(var e=0,n=t.length;e<n;e++)s.deleteObject({endpoint:t[e]})}})};this.select=function(t){return(t=t||{}).scope=t.scope||"*",it(t.connections||s.getConnections(t,!0))},this.selectEndpoints=function(t){(t=t||{}).scope=t.scope||"*";var e=!t.element&&!t.source&&!t.target,n=e?"*":K(t.element),i=e?"*":K(t.source),o=e?"*":K(t.target),s=K(t.scope,!0),r=[];for(var l in _){var a=Q(n,l,!0),c=Q(i,l,!0),u="*"!=i,h=Q(o,l,!0),d="*"!=o;if(a||c||h)t:for(var p=0,f=_[l].length;p<f;p++){var m=_[l][p];if(Q(s,m.scope,!0)){var g=u&&i.length>0&&!m.isSource,b=d&&o.length>0&&!m.isTarget;if(g||b)continue t;r.push(m)}}}return ot(r)},this.getAllConnections=function(){return w},this.getDefaultScope=function(){return T},this.getEndpoint=N,this.getEndpoints=function(t){return _[p(t).id]},this.getDefaultEndpointType=function(){return f.Endpoint},this.getDefaultConnectionType=function(){return f.Connection},this.getId=U,this.appendElement=L;var st=!1;this.isHoverSuspended=function(){return st},this.setHoverSuspended=function(t){st=t},this.hide=function(t,e){return q(t,"none",e),s},this.idstamp=M,this.connectorsInitialized=!1,this.registerConnectorType=function(t,e){n.push([t,e])};var rt=function(t){if(!g&&t){var e=s.getElement(t);e.offsetParent&&s.setContainer(e.offsetParent)}},lt=s.manage=function(t,e,n){return x[t]||(x[t]={el:e,endpoints:[],connections:[]},x[t].info=at({elId:t,timestamp:D}),n||s.fire("manageElement",{id:t,info:x[t].info,el:e})),x[t]},at=this.updateOffset=function(t){var e,n=t.timestamp,i=t.recalc,o=t.offset,r=t.elId;return A&&!n&&(n=D),!i&&n&&n===C[r]?{o:t.offset||P[r],s:k[r]}:(i||!o&&null==P[r]?null!=(e=x[r]?x[r].el:null)&&(k[r]=s.getSize(e),P[r]=s.getOffset(e),C[r]=n):(P[r]=o||P[r],null==k[r]&&null!=(e=x[r].el)&&(k[r]=s.getSize(e)),C[r]=n),P[r]&&!P[r].right&&(P[r].right=P[r].left+k[r][0],P[r].bottom=P[r].top+k[r][1],P[r].width=k[r][0],P[r].height=k[r][1],P[r].centerx=P[r].left+P[r].width/2,P[r].centery=P[r].top+P[r].height/2),{o:P[r],s:k[r]})};this.init=function(){t=f.getRenderModes();var e=function(t,e,n){f.Connectors[t][e]=function(){n.apply(this,arguments),f.ConnectorRenderers[t].apply(this,arguments)},jsPlumbUtil.extend(f.Connectors[t][e],[n,f.ConnectorRenderers[t]])};if(!f.connectorsInitialized){for(var i=0;i<n.length;i++)for(var o=0;o<t.length;o++)e(t[o],n[i][1],n[i][0]);f.connectorsInitialized=!0}y||(s.Defaults.Container&&s.setContainer(s.Defaults.Container),s.anchorManager=new f.AnchorManager({jsPlumbInstance:s}),s.setRenderMode(s.Defaults.RenderMode),y=!0,s.fire("ready",s))}.bind(this),this.log=v,this.jsPlumbUIComponent=u,this.makeAnchor=function(){var t,e=function(t,e){if(f.Anchors[t])return new f.Anchors[t](e);if(!s.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"}};if(0===arguments.length)return null;var n=arguments[0],o=arguments[1],r=null;if(n.compute&&n.getOrientation)return n;if("string"==typeof n)r=e(arguments[0],{elementId:o,jsPlumbInstance:s});else if(i.isArray(n))if(i.isArray(n[0])||i.isString(n[0]))2==n.length&&i.isObject(n[1])?i.isString(n[0])?(t=f.extend({elementId:o,jsPlumbInstance:s},n[1]),r=e(n[0],t)):(t=f.extend({elementId:o,jsPlumbInstance:s,anchors:n[0]},n[1]),r=new f.DynamicAnchor(t)):r=new f.DynamicAnchor({anchors:n,selector:null,elementId:o,jsPlumbInstance:s});else{var l={x:n[0],y:n[1],orientation:n.length>=4?[n[2],n[3]]:[0,0],offsets:n.length>=6?[n[4],n[5]]:[0,0],elementId:o,jsPlumbInstance:s,cssClass:7==n.length?n[6]:null};(r=new f.Anchor(l)).clone=function(){return new f.Anchor(l)}}return r.id||(r.id="anchor_"+M()),r},this.makeAnchors=function(t,e,n){for(var o=[],r=0,l=t.length;r<l;r++)"string"==typeof t[r]?o.push(f.Anchors[t[r]]({elementId:e,jsPlumbInstance:n})):i.isArray(t[r])&&o.push(s.makeAnchor(t[r],e,n));return o},this.makeDynamicAnchor=function(t,e){return new f.DynamicAnchor({anchors:t,selector:e,elementId:null,jsPlumbInstance:s})},this.targetEndpointDefinitions={};var ct=function(t,e,n){t.paintStyle=t.paintStyle||n.Defaults.EndpointStyles[e]||n.Defaults.EndpointStyle,t.hoverPaintStyle=t.hoverPaintStyle||n.Defaults.EndpointHoverStyles[e]||n.Defaults.EndpointHoverStyle,t.anchor=t.anchor||n.Defaults.Anchors[e]||n.Defaults.Anchor,t.endpoint=t.endpoint||n.Defaults.Endpoints[e]||n.Defaults.Endpoint};this.sourceEndpointDefinitions={};var ut=function(t,e,n,o,r){var l=new u(e),a=e._jsPlumb.EndpointDropHandler({jsPlumb:s,enabled:function(){return t.def.enabled},isFull:function(){var e=s.select({target:t.id}).length;return t.def.maxConnections>0&&e>=t.def.maxConnections},element:t.el,elementId:t.id,isSource:o,isTarget:r,addClass:function(e){s.addClass(t.el,e)},removeClass:function(e){s.removeClass(t.el,e)},onDrop:function(t){t.endpoints[0].anchor.locked=!1},isDropAllowed:function(){return l.isDropAllowed.apply(l,arguments)},isRedrop:function(e){return null!=e.suspendedElement&&null!=e.suspendedEndpoint&&e.suspendedEndpoint.element===t.el},getEndpoint:function(n){var i=t.def.endpoint;if(null!=i&&null!=i._jsPlumb||((i=s.addEndpoint(t.el,e))._mtNew=!0),e.uniqueEndpoint&&(t.def.endpoint=i),i._doNotDeleteOnDetach=!1,i._deleteOnDetach=!0,n.isDetachable()&&i.initDraggable(),null!=i.anchor.positionFinder){var o=s.getUIPosition(arguments,s.getZoom()),r=s.getOffset(t.el),l=s.getSize(t.el),a=i.anchor.positionFinder(o,r,l,i.anchor.constructorParams);i.anchor.x=a[0],i.anchor.y=a[1]}return i},maybeCleanup:function(t){t._mtNew&&0===t.connections.length?s.deleteObject({endpoint:t}):delete t._mtNew}}),c=f.dragEvents.drop;return n.scope=n.scope||e.scope||s.Defaults.Scope,n[c]=i.wrap(n[c],a,!0),r&&(n[f.dragEvents.over]=function(){return!0}),!1===e.allowLoopback&&(n.canDrop=function(e){return e.getDragElement()._jsPlumbRelatedElement!=t.el}),s.initDroppable(t.el,n,"internal"),a};this.makeTarget=function(t,e,n){var i=f.extend({_jsPlumb:this},n);f.extend(i,e),ct(i,1,this),i.deleteEndpointsOnDetach;for(var o=i.maxConnections||-1,s=function(t){var e=p(t),n=e.id,s=f.extend({},i.dropOptions||{});rt(n);var r={def:i,uniqueEndpoint:i.uniqueEndpoint,maxConnections:o,enabled:!0};e.def=r,this.targetEndpointDefinitions[n]=r,ut(e,i,s,!0===i.isSource,!0)}.bind(this),r=t.length&&t.constructor!=String?t:[t],l=0,a=r.length;l<a;l++)s(r[l]);return this},this.unmakeTarget=function(t,e){var n=p(t);return f.destroyDroppable(n.el),e||delete this.targetEndpointDefinitions[n.id],this},this.makeSource=function(t,e,n){var o=f.extend({_jsPlumb:this},n);f.extend(o,e),ct(o,0,this);for(var r=o.maxConnections||1,l=o.onMaxConnections,a=function(t){var e=t.id,n=this.getElement(t.el);rt(e);var a={def:o,uniqueEndpoint:o.uniqueEndpoint,maxConnections:r,enabled:!0};this.sourceEndpointDefinitions[e]=a,t.def=a;var c=f.dragEvents.stop,u=f.dragEvents.drag,d=f.extend({},o.dragOptions||{}),p=d.drag,m=d.stop,g=null,b=!1;d.scope=d.scope||o.scope,d[u]=i.wrap(d[u],(function(){p&&p.apply(this,arguments),b=!1})),d[c]=i.wrap(d[c],function(){if(m&&m.apply(this,arguments),this.currentlyDragging=!1,null!=g._jsPlumb){var t=o.anchor||this.Defaults.Anchor,n=g.anchor,i=g.connections[0],r=this.makeAnchor(t,e,this),l=g.element;if(null!=r.positionFinder){var a=s.getOffset(l),c=this.getSize(l),u={left:a.left+n.x*c[0],top:a.top+n.y*c[1]},h=r.positionFinder(u,a,c,r.constructorParams);r.x=h[0],r.y=h[1]}g.setAnchor(r,!0),g.repaint(),this.repaint(g.elementId),null!=i&&this.repaint(i.targetId)}}.bind(this));var v=function(i){var a=this.getOriginalEvent(i);if(3!==i.which&&2!==i.button){var c=this.sourceEndpointDefinitions[e];if(c.enabled){if(e=this.getId(this.getElement(t.el)),o.filter&&!1===(jsPlumbUtil.isString(o.filter)?function(t,e,n,i,o){for(var s=t.target||t.srcElement,r=!1,l=i.getSelector(e,n),a=0;a<l.length;a++)if(l[a]==s){r=!0;break}return o?!r:r}(a,t.el,o.filter,this,o.filterExclude):o.filter(a,t.el)))return;var u=this.select({source:e}).length;if(c.maxConnections>=0&&c.uniqueEndpoint&&u>=c.maxConnections)return l&&l({element:t.el,maxConnections:r},i),!1;var p=f.getPositionOnElement(a,n,h),m={};f.extend(m,o),m.isTemporarySource=!0,m.anchor=[p[0],p[1],0,0],m.dragOptions=d,g=this.addEndpoint(e,m),b=!0,g._doNotDeleteOnDetach=!1,g._deleteOnDetach=!0,c.uniqueEndpoint&&(c.endpoint?g.finalEndpoint=c.endpoint:(c.endpoint=g,g._deleteOnDetach=!1,g._doNotDeleteOnDetach=!0));var v=function(){s.off(g.canvas,"mouseup",v),s.off(t.el,"mouseup",v),b&&(b=!1,s.deleteEndpoint(g))};s.on(g.canvas,"mouseup",v),s.on(t.el,"mouseup",v),s.trigger(g.canvas,"mousedown",i),jsPlumbUtil.consume(i)}}}.bind(this);this.on(t.el,"mousedown",v),a.trigger=v,o.filter&&(jsPlumbUtil.isString(o.filter)||jsPlumbUtil.isFunction(o.filter))&&s.setDragFilter(t.el,o.filter);var y=f.extend({},o.dropOptions||{});ut(t,o,y,!0,!0===o.isTarget)}.bind(this),c=t.length&&t.constructor!=String?t:[t],u=0,d=c.length;u<d;u++)a(p(c[u]));return this},this.unmakeSource=function(t,e){var n=p(t),i=this.sourceEndpointDefinitions[n.id].trigger;return i&&s.off(n.el,"mousedown",i),e||delete this.sourceEndpointDefinitions[n.id],this},this.unmakeEverySource=function(){for(var t in this.sourceEndpointDefinitions)s.unmakeSource(t,!0);return this.sourceEndpointDefinitions={},this};var ht=function(t,e){e=jsPlumbUtil.isArray(e)?e:[e];for(var n=U(t),i=0;i<e.length;i++){var o=this[e[i]][n];if(o)return o.def.scope||this.Defaults.Scope}}.bind(this),dt=function(t,e,n){n=jsPlumbUtil.isArray(n)?n:[n];for(var i=U(t),o=0;o<n.length;o++){var s=this[n[o]][i];s&&(s.def.scope=e,null!=this.scopeChange&&this.scopeChange(t,i,_[i],e,n[o]))}}.bind(this);this.getScope=function(t,e){return ht(t,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(t){return ht(t,"sourceEndpointDefinitions")},this.getTargetScope=function(t){return ht(t,"targetEndpointDefinitions")},this.setScope=function(t,e){dt(t,e,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.setSourceScope=function(t,e){dt(t,e,"sourceEndpointDefinitions")},this.setTargetScope=function(t,e){dt(t,e,"targetEndpointDefinitions")},this.unmakeEveryTarget=function(){for(var t in this.targetEndpointDefinitions)s.unmakeTarget(t,!0);return this.targetEndpointDefinitions={},this};var pt=function(t,e,n,o){var s="source"==t?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;if(i.isString(e))s[e].enabled=o?!s[e].enabled:n;else if(e.length)for(var r=0,l=e.length;r<l;r++){var a=p(e[r]);s[a.id]&&(s[a.id].enabled=o?!s[a.id].enabled:n)}else{var c=p(e).id;s[c].enabled=o?!s[c].enabled:n}return this}.bind(this),ft=function(t,e){return i.isString(t)||!t.length?e.apply(this,[t]):t.length?e.apply(this,[t[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(t){return pt("source",t,null,!0),this.isSourceEnabled(t)},this.setSourceEnabled=function(t,e){return pt("source",t,e)},this.isSource=function(t){return ft(t,function(t){return null!=this.sourceEndpointDefinitions[p(t).id]}.bind(this))},this.isSourceEnabled=function(t){return ft(t,function(t){var e=this.sourceEndpointDefinitions[p(t).id];return e&&!0===e.enabled}.bind(this))},this.toggleTargetEnabled=function(t){return pt("target",t,null,!0),this.isTargetEnabled(t)},this.isTarget=function(t){return ft(t,function(t){return null!=this.targetEndpointDefinitions[p(t).id]}.bind(this))},this.isTargetEnabled=function(t){return ft(t,function(t){var e=this.targetEndpointDefinitions[p(t).id];return e&&!0===e.enabled}.bind(this))},this.setTargetEnabled=function(t,e){return pt("target",t,e)},this.ready=function(t){s.bind("ready",t)};var mt=function(t,e){if("object"==typeof t&&t.length)for(var n=0,i=t.length;n<i;n++)e(t[n]);else e(t);return s};this.repaint=function(t,e,n){return mt(t,(function(t){F(t,e,n)}))},this.revalidate=function(t,e,n){return mt(t,(function(t){var i=n?t:s.getId(t);s.updateOffset({elId:i,recalc:!0,timestamp:e}),s.repaint(t)}))},this.repaintEverything=function(){var t,e=o();for(t in _)s.updateOffset({elId:t,recalc:!0,timestamp:e});for(t in _)F(t,null,e);return this},this.removeAllEndpoints=function(t,e,n){n=n||[];var i=function(t){var o,r,l=p(t),a=_[l.id];if(a)for(n.push(l),o=0,r=a.length;o<r;o++)s.deleteEndpoint(a[o]);if(delete _[l.id],e&&l.el&&3!=l.el.nodeType&&8!=l.el.nodeType)for(o=0,r=l.el.childNodes.length;o<r;o++)i(l.el.childNodes[o])};return i(t),this};var gt=function(t,e){s.removeAllEndpoints(t.id,!0,e);for(var n=function(t){s.getDragManager().elementRemoved(t.id),s.anchorManager.clearFor(t.id),s.anchorManager.removeFloatingConnection(t.id),delete s.floatingConnections[t.id],delete x[t.id],delete P[t.id],t.el&&(s.removeElement(t.el),t.el._jsPlumb=null)},i=1;i<e.length;i++)n(e[i]);n(t)};this.remove=function(t,e){var n=p(t),i=[];return n.text?n.el.parentNode.removeChild(n.el):n.id&&s.batch((function(){gt(n,i)}),!1===e),s},this.empty=function(t,e){var n=[],i=function(t,e){var o=p(t);if(o.text)o.el.parentNode.removeChild(o.el);else if(o.el){for(;o.el.childNodes.length>0;)i(o.el.childNodes[0]);e||gt(o,n)}};return s.batch((function(){i(t,!0)}),!1===e),s},this.reset=function(){s.silently(function(){s.deleteEveryEndpoint(),s.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},w.length=0,this.doReset&&this.doReset()}.bind(this))};var bt=function(t){t.canvas&&t.canvas.parentNode&&t.canvas.parentNode.removeChild(t.canvas),t.cleanup(),t.destroy()};this.clear=function(){s.select().each(bt),s.selectEndpoints().each(bt),_={},j={}},this.setDefaultScope=function(t){return T=t,s},this.setDraggable=function(t,e){return f.each(t,(function(t){s.isDragSupported(t)&&(S[s.getAttribute(t,"id")]=e,s.setElementDraggable(t,e))}))},this.setId=function(t,e,n){var i;jsPlumbUtil.isString(t)?i=t:(t=this.getElement(t),i=this.getId(t));var o=this.getConnections({source:i,scope:"*"},!0),s=this.getConnections({target:i,scope:"*"},!0);e=""+e,n?t=this.getElement(e):(t=this.getElement(i),this.setAttribute(t,"id",e)),_[e]=_[i]||[];for(var r=0,l=_[e].length;r<l;r++)_[e][r].setElementId(e),_[e][r].setReferenceElement(t);delete _[i],this.sourceEndpointDefinitions[e]=this.sourceEndpointDefinitions[i],delete this.sourceEndpointDefinitions[i],this.targetEndpointDefinitions[e]=this.targetEndpointDefinitions[i],delete this.targetEndpointDefinitions[i],this.anchorManager.changeId(i,e),this.getDragManager().changeId(i,e),x[e]=x[i],delete x[i];var a=function(n,i,o){for(var s=0,r=n.length;s<r;s++)n[s].endpoints[i].setElementId(e),n[s].endpoints[i].setReferenceElement(t),n[s][o+"Id"]=e,n[s][o]=t};a(o,0,"source"),a(s,1,"target"),this.repaint(e)},this.setDebugLog=function(t){v=t},this.setSuspendDrawing=function(t,e){var n=A;return A=t,D=t?(new Date).getTime():null,e&&this.repaintEverything(),n},this.isSuspendDrawing=function(){return A},this.getSuspendedAt=function(){return D},this.batch=function(t,e){var n=this.isSuspendDrawing();n||this.setSuspendDrawing(!0);try{t()}catch(t){i.log("Function run while suspended failed",t)}n||this.setSuspendDrawing(!1,!e)},this.doWhileSuspended=this.batch,this.getCachedData=function(t){var e=P[t];return e?{o:e,s:k[t]}:at({elId:t})},this.timestamp=o,this.setRenderMode=function(t){if(t!==f.SVG&&t!==f.VML)throw new TypeError("Render mode ["+t+"] not supported");return O=this.trySetRenderMode(t)},this.getRenderMode=function(){return O},this.show=function(t,e){return q(t,"block",e),s},this.toggleVisible=function(t,e){var n=null;e&&(n=function(t){var e=t.isVisible();t.setVisible(!e)}),H(t,(function(t){var e=t.isVisible();t.setVisible(!e)}),n)},this.toggleDraggable=function(t){return f.each(t,function(t){var e=s.getAttribute(t,"id"),n=null!=S[e]&&S[e];return n=!n,S[e]=n,s.setDraggable(t,n),n}.bind(this))},this.addListener=this.bind};jsPlumbUtil.extend(p,jsPlumbUtil.EventGenerator,{setAttribute:function(t,e,n){this.setAttribute(t,e,n)},getAttribute:function(t,e){return this.getAttribute(f.getElement(t),e)},convertToFullOverlaySpec:function(t){return jsPlumbUtil.isString(t)&&(t=[t,{}]),t[1].id=t[1].id||jsPlumbUtil.uuid(),t},registerConnectionType:function(t,e){if(this._connectionTypes[t]=f.extend({},e),e.overlays){for(var n={},i=0;i<e.overlays.length;i++){var o=this.convertToFullOverlaySpec(e.overlays[i]);n[o[1].id]=o}this._connectionTypes[t].overlays=n}},registerConnectionTypes:function(t){for(var e in t)this.registerConnectionType(e,t[e])},registerEndpointType:function(t,e){this._endpointTypes[t]=f.extend({},e)},registerEndpointTypes:function(t){for(var e in t)this._endpointTypes[e]=f.extend({},t[e])},getType:function(t,e){return"connection"===e?this._connectionTypes[t]:this._endpointTypes[t]},setIdChanged:function(t,e){this.setId(t,e,!0)},setParent:function(t,e){var n=this.getElement(t),i=this.getId(n),o=this.getElement(e),s=this.getId(o);n.parentNode.removeChild(n),o.appendChild(n),this.getDragManager().setParent(n,i,o,s)},extend:function(t,e,n){var i;if(n)for(i=0;i<n.length;i++)t[n[i]]=e[n[i]];else for(i in e)t[i]=e[i];return t},floatingConnections:{},getFloatingAnchorIndex:function(t){return t.endpoints[0].isFloating()?0:1}});var f=new p;"undefined"!=typeof window&&(window.jsPlumb=f),f.getInstance=function(t){var e=new p(t);return e.init(),e},f.each=function(t,e){if(null!=t)if("string"==typeof t)e(f.getElement(t));else if(null!=t.length)for(var n=0;n<t.length;n++)e(f.getElement(t[n]));else e(t)},e.W=f}.call(this),function(){this.jsPlumbUtil;var t=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),e=function(){if(void 0===e.vml){var t=document.body.appendChild(document.createElement("div"));t.innerHTML='<v:shape id="vml_flag1" adj="1" />';var n=t.firstChild;null!=n&&null!=n.style?(n.style.behavior="url(#default#VML)",e.vml=!n||"object"==typeof n.adj):e.vml=!1,t.parentNode.removeChild(t)}return e.vml},n=function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(e)&&(t=parseFloat(RegExp.$1))}return t}(),i=n>-1&&n<9,o=function(t,e){if(null==t)return[0,0];var n=r(t),i=s(n,0);return[i[e+"X"],i[e+"Y"]]},s=function(t,e){return t.item?t.item(e):t[e]},r=function(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]},l=function(t){var e={},n=[],i={},o={},s={};this.register=function(r){var l=t.getId(r),a=t.getOffset(r);e[l]||(e[l]=r,n.push(r),i[l]={});var c=function(e){if(e)for(var n=0;n<e.childNodes.length;n++)if(3!=e.childNodes[n].nodeType&&8!=e.childNodes[n].nodeType){var r=jsPlumb.getElement(e.childNodes[n]),u=t.getId(e.childNodes[n],null,!0);if(u&&o[u]&&o[u]>0){var h=t.getOffset(r);i[l][u]={id:u,offset:{left:h.left-a.left,top:h.top-a.top}},s[u]=l}c(e.childNodes[n])}};c(r)},this.updateOffsets=function(e){if(null!=e){var n=jsPlumb.getElement(e),o=t.getId(n),r=i[o],l=t.getOffset(n);if(r)for(var a in r)if(r.hasOwnProperty(a)){var c=jsPlumb.getElement(a),u=t.getOffset(c);i[o][a]={id:a,offset:{left:u.left-l.left,top:u.top-l.top}},s[a]=o}}},this.endpointAdded=function(n,r){r=r||t.getId(n);var l=document.body,a=n.parentNode;for(o[r]=o[r]?o[r]+1:1;null!=a&&a!=l;){var c=t.getId(a,null,!0);if(c&&e[c]){var u=t.getOffset(a);if(null==i[c][r]){var h=t.getOffset(n);i[c][r]={id:r,offset:{left:h.left-u.left,top:h.top-u.top}},s[r]=c}break}a=a.parentNode}},this.endpointDeleted=function(t){if(o[t.elementId]&&(o[t.elementId]--,o[t.elementId]<=0))for(var e in i)i.hasOwnProperty(e)&&i[e]&&(delete i[e][t.elementId],delete s[t.elementId])},this.changeId=function(t,e){i[e]=i[t],i[t]={},s[e]=s[t],s[t]=null},this.getElementsForDraggable=function(t){return i[t]},this.elementRemoved=function(t){var e=s[t];e&&(delete i[e][t],delete s[t])},this.reset=function(){e={},n=[],i={},o={}},this.dragEnded=function(e){var n=t.getId(e),i=s[n];i&&this.updateOffsets(i)},this.setParent=function(e,n,o,r){var l=s[n];if(l){i[r]||(i[r]={}),i[r][n]=i[l][n],delete i[l][n];var a=t.getOffset(o),c=t.getOffset(e);i[r][n].offset={left:c.left-a.left,top:c.top-a.top},s[n]=r}},this.getDragAncestor=function(e){var n=jsPlumb.getElement(e),i=t.getId(n),o=s[i];return o?jsPlumb.getElement(o):null}},a=function(t,e){var n;e=null==(n=e)?null:n.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0!==t.className.baseVal?t.className.baseVal=e:t.className=e},c=function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},u=function(t,e,n){e=null==e?[]:jsPlumbUtil.isArray(e)?e:e.split(/\s+/),n=null==n?[]:jsPlumbUtil.isArray(n)?n:n.split(/\s+/);var i=c(t).split(/\s+/),o=function(t,e){for(var n=0;n<e.length;n++)if(t)-1==jsPlumbUtil.indexOf(i,e[n])&&i.push(e[n]);else{var o=jsPlumbUtil.indexOf(i,e[n]);-1!=o&&i.splice(o,1)}};o(!0,e),o(!1,n),a(t,i.join(" "))};jsPlumb.extend(jsPlumbInstance.prototype,{headless:!1,pageLocation:function(t){return null==t?[0,0]:i?[t.clientX+document.documentElement.scrollLeft,t.clientY+document.documentElement.scrollTop]:o(t,"page")},screenLocation:function(t){return o(t,"screen")},clientLocation:function(t){return o(t,"client")},getDragManager:function(){return null==this.dragManager&&(this.dragManager=new l(this)),this.dragManager},recalculateOffsets:function(t){this.getDragManager().updateOffsets(t)},createElement:function(t,e,n,i){return this.createElementNS(null,t,e,n,i)},createElementNS:function(t,e,n,i,o){var s,r=null==t?document.createElement(e):document.createElementNS(t,e);for(s in n=n||{})r.style[s]=n[s];for(s in i&&(r.className=i),o=o||{})r.setAttribute(s,""+o[s]);return r},getAttribute:function(t,e){return null!=t.getAttribute?t.getAttribute(e):null},setAttribute:function(t,e,n){null!=t.setAttribute&&t.setAttribute(e,n)},setAttributes:function(t,e){for(var n in e)e.hasOwnProperty(n)&&t.setAttribute(n,e[n])},appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["svg","vml"]},isRenderModeAvailable:function(n){return{svg:t,vml:e()}[n]},trySetRenderMode:function(t){var e;if(t){t=t.toLowerCase();var n=this.isRenderModeAvailable("svg"),i=this.isRenderModeAvailable("vml");"svg"===t&&n?e="svg":i&&(e="vml")}return e},getClass:c,addClass:function(t,e){jsPlumb.each(t,(function(t){u(t,e)}))},hasClass:function(t,e){return(t=jsPlumb.getElement(t)).classList?t.classList.contains(e):-1!=c(t).indexOf(e)},removeClass:function(t,e){jsPlumb.each(t,(function(t){u(t,null,e)}))},updateClasses:function(t,e,n){jsPlumb.each(t,(function(t){u(t,e,n)}))},setClass:function(t,e){jsPlumb.each(t,(function(t){a(t,e)}))},setPosition:function(t,e){t.style.left=e.left+"px",t.style.top=e.top+"px"},getPosition:function(t){var e=function(e){var n=t.style[e];return n?n.substring(0,n.length-2):0};return{left:e("left"),top:e("top")}},getStyle:function(t,e){return void 0!==window.getComputedStyle?getComputedStyle(t,null).getPropertyValue(e):t.currentStyle[e]},getSelector:function(t,e){return 1==arguments.length?null!=t.nodeType?t:document.querySelectorAll(t):t.querySelectorAll(e)},getOffset:function(t,e){t=jsPlumb.getElement(t);for(var n=this.getContainer(),i={left:t.offsetLeft,top:t.offsetTop},o=e||null!=n&&t!=n&&t.offsetParent!=n?t.offsetParent:null,s=function(t){null!=t&&t!==document.body&&(t.scrollTop>0||t.scrollLeft>0)&&(i.left-=t.scrollLeft,i.top-=t.scrollTop)}.bind(this);null!=o;)i.left+=o.offsetLeft,i.top+=o.offsetTop,s(o),o=e?o.offsetParent:o.offsetParent==n?null:o.offsetParent;if(null!=n&&!e&&(n.scrollTop>0||n.scrollLeft>0)){var r=null!=t.offsetParent?this.getStyle(t.offsetParent,"position"):"static",l=this.getStyle(t,"position");"absolute"!==l&&"fixed"!==l&&"absolute"!==r&&"fixed"!=r&&(i.left-=n.scrollLeft,i.top-=n.scrollTop)}return i},getPositionOnElement:function(t,e,n){var i=void 0!==e.getBoundingClientRect?e.getBoundingClientRect():{left:0,top:0,width:0,height:0},o=document.body,s=document.documentElement,r=window.pageYOffset||s.scrollTop||o.scrollTop,l=window.pageXOffset||s.scrollLeft||o.scrollLeft,a=s.clientTop||o.clientTop||0,c=s.clientLeft||o.clientLeft||0,u=i.top+r-a+0*n,h=i.left+l-c+0*n,d=jsPlumb.pageLocation(t),p=i.width||e.offsetWidth*n,f=i.height||e.offsetHeight*n;return[(d[0]-h)/p,(d[1]-u)/f]},getAbsolutePosition:function(t){var e=function(e){var n=t.style[e];if(n)return parseFloat(n.substring(0,n.length-2))};return[e("left"),e("top")]},setAbsolutePosition:function(t,e,n,i){n?this.animate(t,{left:"+="+(e[0]-n[0]),top:"+="+(e[1]-n[1])},i):(t.style.left=e[0]+"px",t.style.top=e[1]+"px")},getSize:function(t){return[t.offsetWidth,t.offsetHeight]},getWidth:function(t){return t.offsetWidth},getHeight:function(t){return t.offsetHeight}})}.call(this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n="__label";t.OverlayCapableJsPlumbUIComponent=function(t){jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},t.label&&(this.getDefaultType().overlays[n]=["Label",{label:t.label,location:t.labelLocation||this.defaultLabelLocation||.5,labelStyle:t.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:n}]),this.setListenerComponent=function(t){if(this._jsPlumb)for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].setListenerComponent(t)}},t.OverlayCapableJsPlumbUIComponent.applyType=function(t,e){if(e.overlays){var n,i={};for(n in e.overlays){var o=t._jsPlumb.overlays[e.overlays[n][1].id];if(o)o.updateFrom(e.overlays[n][1]),i[e.overlays[n][1].id]=!0;else{var s=t.getCachedTypeItem("overlay",e.overlays[n][1].id);null!=s?(s.reattach(t._jsPlumb.instance),s.updateFrom(e.overlays[n][1]),t._jsPlumb.overlays[s.id]=s):s=t.addOverlay(e.overlays[n],!0),i[s.id]=!0}}for(n in t._jsPlumb.overlays)null==i[t._jsPlumb.overlays[n].id]&&t.removeOverlay(t._jsPlumb.overlays[n].id)}},e.extend(t.OverlayCapableJsPlumbUIComponent,jsPlumbUIComponent,{setHover:function(t,e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n][t?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(n,i){var o=function(n,i){var o=null;if(e.isArray(i)){var s=i[0],r=t.extend({component:n,_jsPlumb:n._jsPlumb.instance},i[1]);3==i.length&&t.extend(r,i[2]),o=new(t.Overlays[n._jsPlumb.instance.getRenderMode()][s])(r)}else o=i.constructor==String?new(t.Overlays[n._jsPlumb.instance.getRenderMode()][i])({component:n,_jsPlumb:n._jsPlumb.instance}):i;return o.id=o.id||e.uuid(),n.cacheTypeItem("overlay",o,o.id),n._jsPlumb.overlays[o.id]=o,o}(this,n);return i||this.repaint(),o},getOverlay:function(t){return this._jsPlumb.overlays[t]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(t){var e=this.getOverlay(t);e&&e.hide()},hideOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].hide()},showOverlay:function(t){var e=this.getOverlay(t);e&&e.show()},showOverlays:function(){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].show()},removeAllOverlays:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup&&this._jsPlumb.overlays[e].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,t||this.repaint()},removeOverlay:function(t){var e=this._jsPlumb.overlays[t];e&&(e.cleanup&&e.cleanup(),delete this._jsPlumb.overlays[t],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[t])},removeOverlays:function(){for(var t=0,e=arguments.length;t<e;t++)this.removeOverlay(arguments[t])},moveParent:function(t){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),t.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode)for(var e in this.canvas.parentNode.removeChild(this.canvas),t.appendChild(this.canvas),this._jsPlumb.overlays)if(this._jsPlumb.overlays[e].isAppendedAtTopLevel){var n=this._jsPlumb.overlays[e].getElement();n.parentNode.removeChild(n),t.appendChild(n)}},getLabel:function(){var t=this.getOverlay(n);return null!=t?t.getLabel():null},getLabelOverlay:function(){return this.getOverlay(n)},setLabel:function(e){var i,o,s,r,l=this.getOverlay(n);l?e.constructor==String||e.constructor==Function?l.setLabel(e):(e.label&&l.setLabel(e.label),e.location&&l.setLocation(e.location)):(i=this,o=e.constructor==String||e.constructor==Function?{label:e}:e,s={cssClass:o.cssClass,labelStyle:i.labelStyle,id:n,component:i,_jsPlumb:i._jsPlumb.instance},r=jsPlumb.extend(s,o),l=new(t.Overlays[i._jsPlumb.instance.getRenderMode()].Label)(r),this._jsPlumb.overlays[n]=l),this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(t){for(var e in this._jsPlumb.overlays)this._jsPlumb.overlays[e].cleanup(t),this._jsPlumb.overlays[e].destroy(t);t&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(t){this[t?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(t,e){this._jsPlumb.overlayPositions[t.id]=e},getAbsoluteOverlayPosition:function(t){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[t.id]:null}})}.call(this),function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,i=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],o=function(t,e){return n.findWithFunction(e.connections,(function(e){return e.id==t.id}))};e.Endpoint=function(t){var s=t._jsPlumb,r=t.newConnection,l=t.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:t.connectionType,maxConnections:null==t.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:t.maxConnections,paintStyle:t.endpointStyle||t.paintStyle||t.style||this._jsPlumb.instance.Defaults.EndpointStyle||e.Defaults.EndpointStyle,hoverPaintStyle:t.endpointHoverStyle||t.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||e.Defaults.EndpointHoverStyle,connectorStyle:t.connectorStyle,connectorHoverStyle:t.connectorHoverStyle,connectorClass:t.connectorClass,connectorHoverClass:t.connectorHoverClass,connectorOverlays:t.connectorOverlays,connector:t.connector,connectorTooltip:t.connectorTooltip}),this._jsPlumb.enabled=!(!1===t.enabled),this._jsPlumb.visible=!0,this.element=e.getElement(t.source),this._jsPlumb.uuid=t.uuid,this._jsPlumb.floatingEndpoint=null;var a=null;this._jsPlumb.uuid&&(t.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=t.elementId,this._jsPlumb.connectionCost=t.connectionCost,this._jsPlumb.connectionsDirected=t.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var c=function(){var t=s.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var e=s.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"_"+this._jsPlumb.currentAnchorClass:"");this.removeClass(t),this.addClass(e),jsPlumb.updateClasses(this.element,e,t)}.bind(this);this.prepareAnchor=function(t){var e=this._jsPlumb.instance.makeAnchor(t,this.elementId,s);return e.bind("anchorChanged",function(t){this.fire("anchorChanged",{endpoint:this,anchor:t}),c()}.bind(this)),e},this.setPreparedAnchor=function(t,e){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=t,c(),e||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(t,e){var n=this.prepareAnchor(t);return this.setPreparedAnchor(n,e),this};var u=function(t){if(this.connections.length>0)for(var e=0;e<this.connections.length;e++)this.connections[e].setHover(t,!1);else this.setHover(t)}.bind(this);this.bind("mouseover",(function(){u(!0)})),this.bind("mouseout",(function(){u(!1)})),t._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(i,o){var r,l=function(t,n){var i=s.getRenderMode();if(e.Endpoints[i][t])return new e.Endpoints[i][t](n);if(!s.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"}},a={_jsPlumb:this._jsPlumb.instance,cssClass:t.cssClass,container:t.container,tooltip:t.tooltip,connectorTooltip:t.connectorTooltip,endpoint:this};return n.isString(i)?r=l(i,a):n.isArray(i)?(a=n.merge(i[1],a),r=l(i[0],a)):r=i.clone(),r.clone=function(){return n.isString(i)?l(i,a):n.isArray(i)?(a=n.merge(i[1],a),l(i[0],a)):void 0}.bind(this),r.typeId=o,r},this.setEndpoint=function(t,e){var n=this.prepareEndpoint(t);this.setPreparedEndpoint(n,!0)},this.setPreparedEndpoint=function(t,e){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=t,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},e.extend(this,t,i),this.isSource=t.isSource||!1,this.isTemporarySource=t.isTemporarySource||!1,this.isTarget=t.isTarget||!1,this.connections=t.connections||[],this.connectorPointerEvents=t["connector-pointer-events"],this.scope=t.scope||s.getDefaultScope(),this.timestamp=null,this.reattachConnections=t.reattach||s.Defaults.ReattachConnections,this.connectionsDetachable=s.Defaults.ConnectionsDetachable,!1!==t.connectionsDetachable&&!1!==t.detachable||(this.connectionsDetachable=!1),this.dragAllowedWhenFull=!1!==t.dragAllowedWhenFull,t.onMaxConnections&&this.bind("maxConnections",t.onMaxConnections),this.addConnection=function(t){this.connections.push(t),this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass)},this.detachFromConnection=function(t,e,n){(e=null==e?o(t,this):e)>=0&&(this.connections.splice(e,1),this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass)),!n&&this._deleteOnDetach&&0===this.connections.length&&s.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!1})},this.detach=function(t,e,n,i,r,l,a){var c=!1;return i=!1!==i,(null==a?o(t,this):a)>=0&&(n||t._forceDetach||t.isDetachable()&&t.isDetachAllowed(t)&&this.isDetachAllowed(t)&&s.checkCondition("beforeDetach",t,l))&&(s.deleteObject({connection:t,fireEvent:!e&&i,originalEvent:r,deleteAttachedObjects:!1}),c=!0),c},this.detachAll=function(t,e){for(var n=[];this.connections.length>0;)this.detach(this.connections[0],!1,!0===e,!1!==t,null,this,0)||(n.push(this.connections[0]),this.connections.splice(0,1));return this.connections=n,this},this.detachFrom=function(t,e,n){for(var i=[],o=0;o<this.connections.length;o++)this.connections[o].endpoints[1]!=t&&this.connections[o].endpoints[0]!=t||i.push(this.connections[o]);for(var s=0;s<i.length;s++)this.detach(i[s],!1,!0,e,n);return this},this.getElement=function(){return this.element},this.setElement=function(e){var i=this._jsPlumb.instance.getId(e),o=this.elementId;return n.removeWithFunction(t.endpointsByElement[this.elementId],function(t){return t.id==this.id}.bind(this)),this.element=jsPlumb.getElement(e),this.elementId=s.getId(this.element),s.anchorManager.rehomeEndpoint(this,o,this.element),s.dragManager.endpointAdded(this.element),n.addToList(t.endpointsByElement,i,this),this},this.makeInPlaceCopy=function(){var e=this.anchor.getCurrentLocation({element:this}),n=this.anchor.getOrientation(this),i=this.anchor.getCssClass(),o={bind:function(){},compute:function(){return[e[0],e[1]]},getCurrentLocation:function(){return[e[0],e[1]]},getOrientation:function(){return n},getCssClass:function(){return i}};return l({dropOptions:t.dropOptions,anchor:o,source:this.element,paintStyle:this.getPaintStyle(),endpoint:t.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){var t=this.connections[0];return t||(this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:t)},this.setStyle=this.setPaintStyle,this.paint=function(t){var e=(t=t||{}).timestamp,n=!(!1===t.recalc);if(!e||this.timestamp!==e){var i=s.updateOffset({elId:this.elementId,timestamp:e}),o=t.offset?t.offset.o:i.o;if(null!=o){var r=t.anchorPoint,l=t.connectorPaintStyle;if(null==r){var a=t.dimensions||i.s,c={xy:[o.left,o.top],wh:a,element:this,timestamp:e};if(n&&this.anchor.isDynamic&&this.connections.length>0){var u=function(t,e){var n=0;if(null!=e)for(var i=0;i<t.connections.length;i++)if(t.connections[i].sourceId==e||t.connections[i].targetId==e){n=i;break}return t.connections[n]}(this,t.elementWithPrecedence),h=u.endpoints[0]==this?1:0,d=0===h?u.sourceId:u.targetId,p=s.getCachedData(d),f=p.o,m=p.s;c.txy=[f.left,f.top],c.twh=m,c.tElement=u.endpoints[h]}r=this.anchor.compute(c)}for(var g in this.endpoint.compute(r,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,l||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=e,this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(g)){var b=this._jsPlumb.overlays[g];b.isVisible()&&(this._jsPlumb.overlayPlacements[g]=b.draw(this.endpoint,this._jsPlumb.paintStyleInUse),b.paint(this._jsPlumb.overlayPlacements[g]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var h=!1;this.initDraggable=function(){if(!h&&e.isDragSupported(this.element)){var i={id:null,element:null},o=null,c=!1,u=null,d=function(t,n){var i=!1;return{drag:function(){if(i)return i=!1,!0;var o=e.getUIPosition(arguments,n.getZoom());t.element&&(jsPlumb.setPosition(t.element,o),n.repaint(t.element,o))},stopDrag:function(){i=!0}}}(i,s),p=t.dragOptions||{},f=e.dragEvents.start,m=e.dragEvents.stop,g=e.dragEvents.drag,b=function(){o=this.connectorSelector();var h=!0;this.isEnabled()||(h=!1),null!=o||this.isSource||this.isTemporarySource||(h=!1),!this.isSource||!this.isFull()||null!=o&&this.dragAllowedWhenFull||(h=!1),null==o||o.isDetachable(this)||(h=!1);var p=s.checkCondition(null==o?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:o});if(!1===p&&(h=!1),!1===h)return s.stopDrag&&s.stopDrag(this.canvas),d.stopDrag(),!1;for(var f=0;f<this.connections.length;f++)this.connections[f].setHover(!1);this.addClass("endpointDrag"),s.setConnectionBeingDragged(!0),o&&!this.isFull()&&this.isSource&&(o=null),s.updateOffset({elId:this.elementId}),(a=this.makeInPlaceCopy()).addClass(s.draggingClass),a.referenceEndpoint=this,a.paint(),function(t,e){var n=jsPlumb.createElement("div",{position:"absolute"});e.appendElement(n);var i=e.getId(n);e.manage(i,n,!0),t.id=i,t.element=n}(i,s);var m=this._jsPlumb.instance.getOffset(a.canvas),g=this.canvas;if(jsPlumb.setPosition(i.element,m),this.parentAnchor&&(this.anchor=s.makeAnchor(this.parentAnchor,this.elementId,s)),s.setAttributes(this.canvas,{dragId:i.id,elId:this.elementId}),this._jsPlumb.floatingEndpoint=function(t,n,i,o,s,r,l,a){return l({paintStyle:t,endpoint:i,anchor:new e.FloatingAnchor({reference:n,referenceCanvas:o,jsPlumbInstance:r}),source:s,scope:a})}(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,i.element,s,l,this.scope),this.canvas.style.visibility="hidden",null==o)this.anchor.locked=!0,this.setHover(!1,!1),(o=r({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:i.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:t.connectorStyle,hoverPaintStyle:t.connectorHoverStyle,connector:t.connector,overlays:t.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,data:p})).addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.addClass(s.draggingClass),s.fire("connectionDrag",o);else{c=!0,o.setHover(!1);var b=o.endpoints[0].id==this.id?0:1;this.detachFromConnection(o,null,!0);var v=s.getDragScope(g);s.setAttribute(this.canvas,"originalScope",v);var y=s.getDropScope(g);s.setDragScope(g,y),s.fire("connectionDrag",o),0===b?(u=[o.source,o.sourceId,g,v],o.source=i.element,o.sourceId=i.id):(u=[o.target,o.targetId,g,v],o.target=i.element,o.targetId=i.id),o.endpoints[0===b?1:0].anchor.locked=!0,o.suspendedEndpoint=o.endpoints[b],o.suspendedElement=o.endpoints[b].getElement(),o.suspendedElementId=o.endpoints[b].elementId,o.suspendedElementType=0===b?"source":"target",o.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=o.suspendedEndpoint,o.endpoints[b]=this._jsPlumb.floatingEndpoint,o.addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.addClass(s.draggingClass)}s.floatingConnections[i.id]=o,s.anchorManager.addFloatingConnection(i.id,o),n.addToList(t.endpointsByElement,i.id,this._jsPlumb.floatingEndpoint),s.currentlyDragging=!0}.bind(this),v=function(){if(s.setConnectionBeingDragged(!1),o&&null!=o.endpoints){var t=s.getDropEvent(arguments),e=s.getFloatingAnchorIndex(o);if(o.endpoints[0===e?1:0].anchor.locked=!1,o.removeClass(s.draggingClass),this._jsPlumb&&(o.deleteConnectionNow||o.endpoints[e]==this._jsPlumb.floatingEndpoint)&&c&&o.suspendedEndpoint){0===e?(o.source=u[0],o.sourceId=u[1]):(o.target=u[0],o.targetId=u[1]);var n=this._jsPlumb.floatingEndpoint;s.setDragScope(u[2],u[3]),o.endpoints[e]=o.suspendedEndpoint,o.isReattach()||o._forceReattach||o._forceDetach||!o.endpoints[0===e?1:0].detach(o,!1,!1,!0,t,!0)?(o.setHover(!1),o._forceDetach=null,o._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(o),o.suspendedEndpoint.addConnection(o),s.repaint(u[1])):s.deleteObject({endpoint:n})}this.deleteAfterDragStop?s.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),s.fire("connectionDragStop",o,t),s.currentlyDragging=!1,o=null}i&&i.element&&s.remove(i.element,!1),a&&s.deleteObject({endpoint:a}),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);(p=e.extend({},p)).scope=this.scope||p.scope,p[f]=n.wrap(p[f],b,!1),p[g]=n.wrap(p[g],d.drag),p[m]=n.wrap(p[m],v),p.multipleDrop=!1,p.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0}.bind(this),s.initDraggable(this.canvas,p,"internal"),this.canvas._jsPlumbRelatedElement=this.element,h=!0}};var d=t.endpoint||this._jsPlumb.instance.Defaults.Endpoint||e.Defaults.Endpoint;this.setEndpoint(d,!0);var p=t.anchor?t.anchor:t.anchors?t.anchors:s.Defaults.Anchor||"Top";this.setAnchor(p,!0);var f=["default",t.type||""].join(" ");this.addType(f,t.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var m=function(i,o,r,l){if(e.isDropSupported(this.element)){var a=t.dropOptions||s.Defaults.DropOptions||e.Defaults.DropOptions;(a=e.extend({},a)).scope=a.scope||this.scope;var c=e.dragEvents.drop,u=e.dragEvents.over,h=e.dragEvents.out,d=this,p=s.EndpointDropHandler({getEndpoint:function(){return d},jsPlumb:s,enabled:function(){return null==r||r.isEnabled()},isFull:function(){return r.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(t){d.addClass(t)},removeClass:function(t){d.removeClass(t)},isDropAllowed:function(){return d.isDropAllowed.apply(d,arguments)},reference:l,isRedrop:function(t,e){return t.suspendedEndpoint&&e.reference&&t.suspendedEndpoint.id===e.reference.id}});a[c]=n.wrap(a[c],p,!0),a[u]=n.wrap(a[u],function(){var t=e.getDragObject(arguments),n=s.getAttribute(e.getElement(t),"dragId"),i=s.floatingConnections[n];if(null!=i){var o=s.getFloatingAnchorIndex(i);if(this.isTarget&&0!==o||i.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==i.suspendedEndpoint.id){var r=s.checkCondition("checkDropAllowed",{sourceEndpoint:i.endpoints[o],targetEndpoint:this,connection:i});this[(r?"add":"remove")+"Class"](s.endpointDropAllowedClass),this[(r?"remove":"add")+"Class"](s.endpointDropForbiddenClass),i.endpoints[o].anchor.over(this.anchor,this)}}}.bind(this)),a[h]=n.wrap(a[h],function(){var t=e.getDragObject(arguments),n=null==t?null:s.getAttribute(e.getElement(t),"dragId"),i=n?s.floatingConnections[n]:null;if(null!=i){var o=s.getFloatingAnchorIndex(i);(this.isTarget&&0!==o||i.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==i.suspendedEndpoint.id)&&(this.removeClass(s.endpointDropAllowedClass),this.removeClass(s.endpointDropForbiddenClass),i.endpoints[o].anchor.out())}}.bind(this)),s.initDroppable(i,a,"internal",o)}}.bind(this);return this.anchor.isFloating||m(this.canvas,!(t._transient||this.anchor.isFloating),this,t.reference),this},n.extend(e.Endpoint,e.OverlayCapableJsPlumbUIComponent,{setVisible:function(t,e,n){if(this._jsPlumb.visible=t,this.canvas&&(this.canvas.style.display=t?"block":"none"),this[t?"showOverlays":"hideOverlays"](),!e)for(var i=0;i<this.connections.length;i++)if(this.connections[i].setVisible(t),!n){var o=this===this.connections[i].endpoints[0]?1:0;1==this.connections[i].endpoints[o].connections.length&&this.connections[i].endpoints[o].setVisible(t,!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(t,n){this.setPaintStyle(t.endpointStyle||t.paintStyle,n),this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle,n),null!=t.maxConnections&&(this._jsPlumb.maxConnections=t.maxConnections),t.scope&&(this.scope=t.scope),e.extend(this,t,i),null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass),e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(t){this._jsPlumb.enabled=t},cleanup:function(){var t=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"_"+this._jsPlumb.currentAnchorClass:"");jsPlumb.removeClass(this.element,t),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(t){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(t)},isFull:function(){return 0===this._jsPlumb.maxConnections||!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(t){var e=!1;if(t)for(var n=0;n<this.connections.length;n++)if(this.connections[n].endpoints[1]==t||this.connections[n].endpoints[0]==t){e=!0;break}return e},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(t){this._jsPlumb.connectionCost=t},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(t){this._jsPlumb.connectionsDirected=t},setElementId:function(t){this.elementId=t,this.anchor.elementId=t},setReferenceElement:function(t){this.element=e.getElement(t)},setDragAllowedWhenFull:function(t){this.dragAllowedWhenFull=t},equals:function(t){return this.anchor.equals(t.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(t){return this.anchor.compute(t)}}),t.jsPlumbInstance.prototype.EndpointDropHandler=function(t){return function(e){var n=t.jsPlumb;t.removeClass(n.endpointDropAllowedClass),t.removeClass(n.endpointDropForbiddenClass);var i=n.getDropEvent(arguments),o=n.getDragObject(arguments),s=n.getAttribute(o,"dragId"),r=(n.getAttribute(o,"elId"),n.getAttribute(o,"originalScope")),l=n.floatingConnections[s];if(null!=l&&(!l.suspendedEndpoint||null!=l.suspendedEndpoint._jsPlumb)){var a=t.getEndpoint(l);if(null!=a){if(t.isRedrop(l,t))return l._forceReattach=!0,l.setHover(!1),void(t.maybeCleanup&&t.maybeCleanup(a));var c=n.getFloatingAnchorIndex(l);if(0===c&&!t.isSource||1===c&&!t.isTarget)t.maybeCleanup&&t.maybeCleanup(a);else{t.onDrop&&t.onDrop(l),r&&n.setDragScope(o,r);var u=t.isFull(e);if(u&&a.fire("maxConnections",{endpoint:this,connection:l,maxConnections:a._jsPlumb.maxConnections},i),!u&&(0!==c||t.isSource)&&(1!=c||t.isTarget)&&t.enabled()){var h=!0;0===c?(l.source=t.element,l.sourceId=t.elementId):(l.target=t.element,l.targetId=t.elementId),l.suspendedEndpoint&&l.suspendedEndpoint._jsPlumb&&l.suspendedEndpoint.id!=a.id&&(l.isDetachAllowed(l)&&l.endpoints[c].isDetachAllowed(l)&&l.suspendedEndpoint.isDetachAllowed(l)&&n.checkCondition("beforeDetach",l)||(h=!1));var d=function(t){l.endpoints[c].detachFromConnection(l),l.suspendedEndpoint&&l.suspendedEndpoint.detachFromConnection(l),l.endpoints[c]=a,a.addConnection(l);var e=a.getParameters();for(var o in e)l.setParameter(o,e[o]);if(l.suspendedEndpoint){var s=l.suspendedEndpoint.elementId;n.fireMoveEvent({index:c,originalSourceId:0===c?s:l.sourceId,newSourceId:0===c?a.elementId:l.sourceId,originalTargetId:1==c?s:l.targetId,newTargetId:1==c?a.elementId:l.targetId,originalSourceEndpoint:0===c?l.suspendedEndpoint:l.endpoints[0],newSourceEndpoint:0===c?a:l.endpoints[0],originalTargetEndpoint:1==c?l.suspendedEndpoint:l.endpoints[1],newTargetEndpoint:1==c?a:l.endpoints[1],connection:l},i)}else e.draggable&&n.initDraggable(this.element,dragOptions,"internal",n);1==c?n.anchorManager.updateOtherEndpoint(l.sourceId,l.suspendedElementId,l.targetId,l):n.anchorManager.sourceChanged(l.suspendedEndpoint.elementId,l.sourceId,l),l.endpoints[0].finalEndpoint&&(l.endpoints[0].detachFromConnection(l),l.endpoints[0]=l.endpoints[0].finalEndpoint,l.endpoints[0].addConnection(l)),jsPlumbUtil.isObject(t)&&l.mergeData(t),n.finaliseConnection(l,null,i),l.setHover(!1)}.bind(this);if(h=h&&t.isDropAllowed(l.sourceId,l.targetId,l.scope,l,a))return d(h),!0;l.suspendedEndpoint&&(l.endpoints[c]=l.suspendedEndpoint,l.setHover(!1),l._forceDetach=!0,0===c?(l.source=l.suspendedEndpoint.element,l.sourceId=l.suspendedEndpoint.elementId):(l.target=l.suspendedEndpoint.element,l.targetId=l.suspendedEndpoint.elementId),l.suspendedEndpoint.addConnection(l),n.repaint(l.sourceId),l._forceDetach=!1)}t.maybeCleanup&&t.maybeCleanup(a),n.currentlyDragging=!1}}}}}}.call(this),function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,i=function(t,n,i,o,s){if(!t.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[n][i])throw{msg:"jsPlumb: unknown connector type '"+i+"'"};return new e.Connectors[n][i](o,s)},o=function(t,e,n){return t?n.makeAnchor(t,e,n):null},s=function(t,e,i,o){null!=e&&(e._jsPlumbConnections=e._jsPlumbConnections||{},o?delete e._jsPlumbConnections[t.id]:e._jsPlumbConnections[t.id]=!0,n.isEmpty(e._jsPlumbConnections)?i.removeClass(e,i.connectedClass):i.addClass(e,i.connectedClass))};e.Connection=function(t){var i=t.newEndpoint;this.id=t.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=t.previousConnection,this.source=e.getElement(t.source),this.target=e.getElement(t.target),t.sourceEndpoint&&(this.source=t.sourceEndpoint.getElement()),t.targetEndpoint&&(this.target=t.targetEndpoint.getElement()),e.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var o=this._jsPlumb.instance;o.manage(this.sourceId,this.source),o.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.editable=!0===t.editable,this._jsPlumb.params={cssClass:t.cssClass,container:t.container,"pointer-events":t["pointer-events"],editorParams:t.editorParams,overlays:t.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(e,n,s,r){return s=s||this._jsPlumb.instance.getId(n),this.prepareEndpoint(o,i,this,r,e?0:1,t,n,s)};var s=this.makeEndpoint(!0,this.source,this.sourceId,t.sourceEndpoint),r=this.makeEndpoint(!1,this.target,this.targetId,t.targetEndpoint);s&&n.addToList(t.endpointsByElement,this.sourceId,s),r&&n.addToList(t.endpointsByElement,this.targetId,r),this.scope||(this.scope=this.endpoints[0].scope),null!=t.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=t.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=t.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0));var l=o.Defaults.ConnectionsDetachable;!1===t.detachable&&(l=!1),!1===this.endpoints[0].connectionsDetachable&&(l=!1),!1===this.endpoints[1].connectionsDetachable&&(l=!1);var a=t.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||o.Defaults.ReattachConnections;this.appendToDefaultType({detachable:l,rettach:a,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||o.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||o.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle});var c=o.getSuspendedAt();if(!o.isSuspendDrawing()){var u=o.getCachedData(this.sourceId),h=u.o,d=u.s,p=o.getCachedData(this.targetId),f=p.o,m=p.s,g=c||o.timestamp(),b=this.endpoints[0].anchor.compute({xy:[h.left,h.top],wh:d,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[f.left,f.top],twh:m,tElement:this.endpoints[1],timestamp:g});this.endpoints[0].paint({anchorLoc:b,timestamp:g}),b=this.endpoints[1].anchor.compute({xy:[f.left,f.top],wh:m,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[h.left,h.top],twh:d,tElement:this.endpoints[0],timestamp:g}),this.endpoints[1].paint({anchorLoc:b,timestamp:g})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(){return!0===this._jsPlumb.detachable},this.setDetachable=function(t){this._jsPlumb.detachable=!0===t},this.isReattach=function(){return!0===this._jsPlumb.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections},this.setReattach=function(t){this._jsPlumb.reattach=!0===t},this._jsPlumb.cost=t.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=t.directed,null==t.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var v=jsPlumb.extend({},this.endpoints[1].getParameters());e.extend(v,this.endpoints[0].getParameters()),e.extend(v,this.getParameters()),this.setParameters(v),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||o.Defaults.Connector||e.Defaults.Connector,!0);var y=null!=t.data&&jsPlumbUtil.isObject(t.data)?t.data:{};this.getData=function(){return y},this.setData=function(t){y=t||{}},this.mergeData=function(t){y=jsPlumb.extend(y,t)};var w=["default",t.type,this.endpoints[0].connectionType,this.endpoints[1].connectionType].join(" ");/[^\s]/.test(w)&&this.addType(w,t.data,!0),this.updateConnectedClass()},n.extend(e.Connection,e.OverlayCapableJsPlumbUIComponent,{applyType:function(t,n,i){null!=t.detachable&&this.setDetachable(t.detachable),null!=t.reattach&&this.setReattach(t.reattach),t.scope&&(this.scope=t.scope),null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);var o=null;t.anchor?null==(o=this.getCachedTypeItem("anchors",i.anchor))&&(o=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)],this.cacheTypeItem("anchors",o,i.anchor)):t.anchors&&null==(o=this.getCachedTypeItem("anchors",i.anchors))&&(o=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])],this.cacheTypeItem("anchors",o,i.anchors)),null!=o&&(this.endpoints[0].anchor=o[0],this.endpoints[1].anchor=o[1]),e.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(t,e){e&&(this.endpoints[0].addClass(t),this.endpoints[1].addClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(t)),this.connector&&this.connector.addClass(t)},removeClass:function(t,e){e&&(this.endpoints[0].removeClass(t),this.endpoints[1].removeClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(t)),this.connector&&this.connector.removeClass(t)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t){this._jsPlumb.visible=t,this.connector&&this.connector.setVisible(t),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(t){s(this,this.source,this._jsPlumb.instance,t),s(this,this.target,this._jsPlumb.instance,t)},setHover:function(e){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(e),t.jsPlumb[e?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),t.jsPlumb[e?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb.cost},setCost:function(t){this._jsPlumb.cost=t},isDirected:function(){return!0===this._jsPlumb.directed},getConnector:function(){return this.connector},prepareConnector:function(t,e){var o,s={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},r=this._jsPlumb.instance.getRenderMode();return n.isString(t)?o=i(this._jsPlumb.instance,r,t,s,this):n.isArray(t)&&(o=1==t.length?i(this._jsPlumb.instance,r,t[0],s,this):i(this._jsPlumb.instance,r,t[0],n.merge(t[1],s),this)),null!=e&&(o.typeId=e),o},setPreparedConnector:function(t,e,n,i){var o,s="";if(null!=this.connector&&(s=(o=this.connector).getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=t,i&&this.cacheTypeItem("connector",t,i),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.addClass(s),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),null!=o)for(var r=this.getOverlays(),l=0;l<r.length;l++)r[l].transfer&&r[l].transfer(this.connector);n||this.setListenerComponent(this.connector),e||this.repaint()},setConnector:function(t,e,n,i){var o=this.prepareConnector(t,i);this.setPreparedConnector(o,e,n,i)},paint:function(t){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){var e=(t=t||{}).timestamp,n=this.targetId,i=this.sourceId;if(null==e||e!=this._jsPlumb.lastPaintedAt){var o=this._jsPlumb.instance.updateOffset({elId:i}).o,s=this._jsPlumb.instance.updateOffset({elId:n}).o,r=this.endpoints[0],l=this.endpoints[1],a=r.anchor.getCurrentLocation({xy:[o.left,o.top],wh:[o.width,o.height],element:r,timestamp:e}),c=l.anchor.getCurrentLocation({xy:[s.left,s.top],wh:[s.width,s.height],element:l,timestamp:e});this.connector.resetBounds(),this.connector.compute({sourcePos:a,targetPos:c,sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:o,targetInfo:s});var u={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var h in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(h)){var d=this._jsPlumb.overlays[h];d.isVisible()&&(this._jsPlumb.overlayPlacements[h]=d.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(d)),u.minX=Math.min(u.minX,this._jsPlumb.overlayPlacements[h].minX),u.maxX=Math.max(u.maxX,this._jsPlumb.overlayPlacements[h].maxX),u.minY=Math.min(u.minY,this._jsPlumb.overlayPlacements[h].minY),u.maxY=Math.max(u.maxY,this._jsPlumb.overlayPlacements[h].maxY))}var p=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,f=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),m={xmin:Math.min(this.connector.bounds.minX-(p+f),u.minX),ymin:Math.min(this.connector.bounds.minY-(p+f),u.minY),xmax:Math.max(this.connector.bounds.maxX+(p+f),u.maxX),ymax:Math.max(this.connector.bounds.maxY+(p+f),u.maxY)};for(var g in this.connector.paint(this._jsPlumb.paintStyleInUse,null,m),this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(g)){var b=this._jsPlumb.overlays[g];b.isVisible()&&b.paint(this._jsPlumb.overlayPlacements[g],m)}}this._jsPlumb.lastPaintedAt=e}},repaint:function(t){t=t||{},this.paint({elId:this.sourceId,recalc:!(!1===t.recalc),timestamp:t.timestamp})},prepareEndpoint:function(t,n,i,s,r,l,a,c){var u;if(s)i.endpoints[r]=s,s.addConnection(i);else{l.endpoints||(l.endpoints=[null,null]);var h=l.endpoints[r]||l.endpoint||t.Defaults.Endpoints[r]||jsPlumb.Defaults.Endpoints[r]||t.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;l.endpointStyles||(l.endpointStyles=[null,null]),l.endpointHoverStyles||(l.endpointHoverStyles=[null,null]);var d=l.endpointStyles[r]||l.endpointStyle||t.Defaults.EndpointStyles[r]||jsPlumb.Defaults.EndpointStyles[r]||t.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==d.fillStyle&&null!=l.paintStyle&&(d.fillStyle=l.paintStyle.strokeStyle),null==d.outlineColor&&null!=l.paintStyle&&(d.outlineColor=l.paintStyle.outlineColor),null==d.outlineWidth&&null!=l.paintStyle&&(d.outlineWidth=l.paintStyle.outlineWidth);var p=l.endpointHoverStyles[r]||l.endpointHoverStyle||t.Defaults.EndpointHoverStyles[r]||jsPlumb.Defaults.EndpointHoverStyles[r]||t.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=l.hoverPaintStyle&&(null==p&&(p={}),null==p.fillStyle&&(p.fillStyle=l.hoverPaintStyle.strokeStyle));var f=l.anchors?l.anchors[r]:l.anchor?l.anchor:o(t.Defaults.Anchors[r],c,t)||o(e.Defaults.Anchors[r],c,t)||o(t.Defaults.Anchor,c,t)||o(e.Defaults.Anchor,c,t);u=n({paintStyle:d,hoverPaintStyle:p,endpoint:h,connections:[i],uuid:l.uuids?l.uuids[r]:null,anchor:f,source:a,scope:l.scope,reattach:l.reattach||t.Defaults.ReattachConnections,detachable:l.detachable||t.Defaults.ConnectionsDetachable}),i.endpoints[r]=u,!1===l.drawEndpoints&&u.setVisible(!1,!0,!0)}return u}})}.call(this),function(){"use strict";var t=this.jsPlumbUtil,e=this.jsPlumb;e.AnchorManager=function(n){var i={},o={},s={},r={},l=["left","top","right","bottom"],a={},c=this,u={},h=n.jsPlumbInstance,d={},p=function(t,e,n,i,o,s){if(t===e)return{orientation:"identity",a:["top","top"]};var r=Math.atan2(i.centery-n.centery,i.centerx-n.centerx),a=Math.atan2(n.centery-i.centery,n.centerx-i.centerx),c=[],u={};!function(t,e){for(var n=0;n<t.length;n++)u[t[n]]={left:[e[n].left,e[n].centery],right:[e[n].right,e[n].centery],top:[e[n].centerx,e[n].top],bottom:[e[n].centerx,e[n].bottom]}}(["source","target"],[n,i]);for(var h=0;h<l.length;h++)for(var d=0;d<l.length;d++)h!=d&&c.push({source:l[h],target:l[d],dist:Biltong.lineLength(u.source[l[h]],u.target[l[d]])});c.sort((function(t,e){return t.dist<e.dist?-1:t.dist>e.dist?1:0}));for(var p=c[0].source,f=c[0].target,m=0;m<c.length&&(p=!o.isContinuous||o.isEdgeSupported(c[m].source)?c[m].source:null,f=!s.isContinuous||s.isEdgeSupported(c[m].target)?c[m].target:null,null==p||null==f);m++);return{a:[p,f],theta:r,theta2:a}},f=function(t){return function(e,n){return!1==(t?e[0][0]<n[0][0]:e[0][0]>n[0][0])?-1:1}},m={top:function(t,e){return t[0]>e[0]?1:-1},right:f(!0),bottom:f(!0),left:function(t,e){return(t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0])>(e[0][0]<0?-Math.PI-e[0][0]:Math.PI-e[0][0])||t[0][1]>e[0][1]?1:-1}},g=function(t,e){var n=h.getCachedData(t),i=n.s,s=n.o,l=function(e,n,i,s,l,a,c){if(s.length>0)for(var u=function(t,e,n,i,o,s,r){for(var l=[],a=e[o?0:1]/(i.length+1),c=0;c<i.length;c++){var u=(c+1)*a,h=s*e[o?1:0];r&&(u=e[o?0:1]-u);var d=o?u:h,p=n[0]+d,f=d/e[0],m=o?h:u,g=n[1]+m,b=m/e[1];l.push([p,g,f,b,i[c][1],i[c][2]])}return l}(0,n,i,(b=m[e],s.sort(b)),l,a,"right"===e||"top"===e),h=function(t,e){o[t.id]=[e[0],e[1],e[2],e[3]],r[t.id]=c},d=0;d<u.length;d++){var p=u[d][4],f=p.endpoints[0].elementId===t,g=p.endpoints[1].elementId===t;f?h(p.endpoints[0],u[d]):g&&h(p.endpoints[1],u[d])}var b};l("bottom",i,[s.left,s.top],e.bottom,!0,1,[0,1]),l("top",i,[s.left,s.top],e.top,!0,0,[0,-1]),l("left",i,[s.left,s.top],e.left,!1,0,[-1,0]),l("right",i,[s.left,s.top],e.right,!1,1,[1,0])};this.reset=function(){i={},a={},u={}},this.addFloatingConnection=function(t,e){d[t]=e},this.removeFloatingConnection=function(t){delete d[t]},this.newConnection=function(n){var i=n.sourceId,o=n.targetId,s=n.endpoints,r=!0,l=function(l,c,u,h,d){i==o&&u.isContinuous&&(n._jsPlumb.instance.removeElement(s[1].canvas),r=!1),t.addToList(a,h,[d,c,u.constructor==e.DynamicAnchor])};l(0,s[0],s[0].anchor,o,n),r&&l(0,s[1],s[1].anchor,i,n)};var b=function(e){!function(e,n){if(e){var i=function(t){return t[4]==n};t.removeWithFunction(e.top,i),t.removeWithFunction(e.left,i),t.removeWithFunction(e.bottom,i),t.removeWithFunction(e.right,i)}}(u[e.elementId],e.id)};this.connectionDetached=function(n){var i=n.connection||n,o=n.sourceId,s=n.targetId,r=i.endpoints,l=function(n,i,o,s,r){null!=o&&o.constructor==e.FloatingAnchor||t.removeWithFunction(a[s],(function(t){return t[0].id==r.id}))};l(0,r[1],r[1].anchor,o,i),l(0,r[0],r[0].anchor,s,i),b(i.endpoints[0]),b(i.endpoints[1]),c.redraw(i.sourceId),c.redraw(i.targetId)},this.add=function(e,n){t.addToList(i,n,e)},this.changeId=function(t,e){a[e]=a[t],i[e]=i[t],delete a[t],delete i[t]},this.getConnectionsFor=function(t){return a[t]||[]},this.getEndpointsFor=function(t){return i[t]||[]},this.deleteEndpoint=function(e){t.removeWithFunction(i[e.elementId],(function(t){return t.id==e.id})),b(e)},this.clearFor=function(t){delete i[t],i[t]=[]};var v=function(e,i,o,s,r,l,a,c,u,h,d,p){var f,m,g=-1,b=s.endpoints[a],v=b.id,y=[1,0][a],w=[[i,o],s,r,l,v],_=e[u],j=b._continuousAnchorEdge?e[b._continuousAnchorEdge]:null;if(j){var x=t.findWithFunction(j,(function(t){return t[4]==v}));if(-1!=x)for(j.splice(x,1),f=0;f<j.length;f++)m=j[f][1],t.addWithFunction(d,m,(function(t){return t.id==m.id})),t.addWithFunction(p,j[f][1].endpoints[a],(function(t){return t.id==m.endpoints[a].id})),t.addWithFunction(p,j[f][1].endpoints[y],(function(t){return t.id==m.endpoints[y].id}))}for(f=0;f<_.length;f++)m=_[f][1],1==n.idx&&_[f][3]===l&&-1==g&&(g=f),t.addWithFunction(d,m,(function(t){return t.id==m.id})),t.addWithFunction(p,_[f][1].endpoints[a],(function(t){return t.id==m.endpoints[a].id})),t.addWithFunction(p,_[f][1].endpoints[y],(function(t){return t.id==m.endpoints[y].id}));var P=c?-1!=g?g:0:_.length;_.splice(P,0,w),b._continuousAnchorEdge=u};this.updateOtherEndpoint=function(n,i,o,s){var r=t.findWithFunction(a[n],(function(t){return t[0].id===s.id})),l=t.findWithFunction(a[i],(function(t){return t[0].id===s.id}));-1!=r&&(a[n][r][0]=s,a[n][r][1]=s.endpoints[1],a[n][r][2]=s.endpoints[1].anchor.constructor==e.DynamicAnchor),l>-1&&(a[i].splice(l,1),t.addToList(a,o,[s,s.endpoints[0],s.endpoints[0].anchor.constructor==e.DynamicAnchor])),s.updateConnectedClass()},this.sourceChanged=function(n,i,o){if(n!==i){t.removeWithFunction(a[n],(function(t){return t[0].id===o.id}));var s=t.findWithFunction(a[o.targetId],(function(t){return t[0].id===o.id}));s>-1&&(a[o.targetId][s][0]=o,a[o.targetId][s][1]=o.endpoints[0],a[o.targetId][s][2]=o.endpoints[0].anchor.constructor==e.DynamicAnchor),t.addToList(a,i,[o,o.endpoints[1],o.endpoints[1].anchor.constructor==e.DynamicAnchor]),o.endpoints[1].anchor.isContinuous&&(o.source===o.target?o._jsPlumb.instance.removeElement(o.endpoints[1].canvas):null==o.endpoints[1].canvas.parentNode&&o._jsPlumb.instance.appendElement(o.endpoints[1].canvas)),o.updateConnectedClass()}},this.rehomeEndpoint=function(e,n,o){var s=i[n]||[],r=h.getId(o);if(r!==n){var l=t.indexOf(s,e);if(l>-1){var a=s.splice(l,1)[0];c.add(a,r)}}for(var u=0;u<e.connections.length;u++)e.connections[u].sourceId==n?(e.connections[u].sourceId=e.elementId,e.connections[u].source=e.element,c.sourceChanged(n,e.elementId,e.connections[u])):e.connections[u].targetId==n&&(e.connections[u].targetId=e.elementId,e.connections[u].target=e.element,c.updateOtherEndpoint(e.connections[u].sourceId,n,e.elementId,e.connections[u]))},this.redraw=function(n,o,s,r,l,c){if(!h.isSuspendDrawing()){var f=i[n]||[],m=a[n]||[],b=[],y=[],w=[];s=s||h.timestamp(),r=r||{left:0,top:0},o&&(o={left:o.left+r.left,top:o.top+r.top});for(var _=h.updateOffset({elId:n,offset:o,recalc:!1,timestamp:s}),j={},x=0;x<m.length;x++){var P=m[x][0],C=P.sourceId,S=P.targetId,E=P.endpoints[0].anchor.isContinuous,k=P.endpoints[1].anchor.isContinuous;if(E||k){var A=C+"_"+S,D=j[A],T=P.sourceId==n?1:0;E&&!u[C]&&(u[C]={top:[],right:[],bottom:[],left:[]}),k&&!u[S]&&(u[S]={top:[],right:[],bottom:[],left:[]}),n!=S&&h.updateOffset({elId:S,timestamp:s}),n!=C&&h.updateOffset({elId:C,timestamp:s});var O=h.getCachedData(S),I=h.getCachedData(C);S==C&&(E||k)?v(u[C],-Math.PI/2,0,P,!1,S,0,!1,"top",0,b,y):(D||(D=p(C,S,I.o,O.o,P.endpoints[0].anchor,P.endpoints[1].anchor),j[A]=D),E&&v(u[C],D.theta,0,P,!1,S,0,!1,D.a[0],0,b,y),k&&v(u[S],D.theta2,-1,P,!0,C,1,!0,D.a[1],0,b,y)),E&&t.addWithFunction(w,C,(function(t){return t===C})),k&&t.addWithFunction(w,S,(function(t){return t===S})),t.addWithFunction(b,P,(function(t){return t.id==P.id})),(E&&0===T||k&&1===T)&&t.addWithFunction(y,P.endpoints[T],(function(t){return t.id==P.endpoints[T].id}))}}for(x=0;x<f.length;x++)0===f[x].connections.length&&f[x].anchor.isContinuous&&(u[n]||(u[n]={top:[],right:[],bottom:[],left:[]}),v(u[n],-Math.PI/2,0,{endpoints:[f[x],f[x]],paint:function(){}},!1,n,0,!1,f[x].anchor.getDefaultFace(),0,b,y),t.addWithFunction(w,n,(function(t){return t===n})));for(x=0;x<w.length;x++)g(w[x],u[w[x]]);for(x=0;x<f.length;x++)f[x].paint({timestamp:s,offset:_,dimensions:_.s,recalc:!0!==c});for(x=0;x<y.length;x++){var M=h.getCachedData(y[x].elementId);y[x].paint({timestamp:s,offset:M,dimensions:M.s})}for(x=0;x<m.length;x++){var L=m[x][1];if(L.anchor.constructor==e.DynamicAnchor){L.paint({elementWithPrecedence:n,timestamp:s}),t.addWithFunction(b,m[x][0],(function(t){return t.id==m[x][0].id}));for(var F=0;F<L.connections.length;F++)L.connections[F]!==m[x][0]&&t.addWithFunction(b,L.connections[F],(function(t){return t.id==L.connections[F].id}))}else L.anchor.constructor==e.Anchor&&t.addWithFunction(b,m[x][0],(function(t){return t.id==m[x][0].id}))}var N=d[n];for(N&&N.paint({timestamp:s,recalc:!1,elId:n}),x=0;x<b.length;x++)b[x].paint({elId:n,timestamp:s,recalc:!1,clearEdits:l})}};var y=function(e){t.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var n=e.faces||["top","right","bottom","left"],i=!(!1===e.clockwise),l={},a={top:"bottom",right:"left",left:"right",bottom:"top"},c={top:"right",right:"bottom",left:"top",bottom:"left"},u={top:"left",right:"top",left:"bottom",bottom:"right"},h=i?c:u,d=i?u:c,p=e.cssClass||"",f=0;f<n.length;f++)l[n[f]]=!0;this.getDefaultFace=function(){return 0===n.length?"top":n[0]},this.verifyEdge=function(t){return l[t]?t:l[a[t]]?a[t]:l[h[t]]?h[t]:l[d[t]]?d[t]:t},this.isEdgeSupported=function(t){return!0===l[t]},this.compute=function(t){return s[t.element.id]||o[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return s[t.element.id]||o[t.element.id]||[0,0]},this.getOrientation=function(t){return r[t.id]||[0,0]},this.clearUserDefinedLocation=function(){delete s[e.elementId]},this.setUserDefinedLocation=function(t){s[e.elementId]=t},this.getCssClass=function(){return p}};h.continuousAnchorFactory={get:function(t){return new y(t)},clear:function(t){delete s[t],delete o[t]}}},e.Anchor=function(e){this.x=e.x||0,this.y=e.y||0,this.elementId=e.elementId,this.cssClass=e.cssClass||"",this.userDefinedLocation=null,this.orientation=e.orientation||[0,0],this.lastReturnValue=null,this.offsets=e.offsets||[0,0],this.timestamp=null,t.EventGenerator.apply(this),this.compute=function(t){var e=t.xy,n=t.wh,i=t.timestamp;return t.clearUserDefinedLocation&&(this.userDefinedLocation=null),i&&i===self.timestamp||(null!=this.userDefinedLocation?this.lastReturnValue=this.userDefinedLocation:this.lastReturnValue=[e[0]+this.x*n[0]+this.offsets[0],e[1]+this.y*n[1]+this.offsets[1]],this.timestamp=i),this.lastReturnValue},this.getCurrentLocation=function(t){return null==this.lastReturnValue||null!=t.timestamp&&this.timestamp!=t.timestamp?this.compute(t):this.lastReturnValue}},t.extend(e.Anchor,t.EventGenerator,{equals:function(t){if(!t)return!1;var e=t.getOrientation(),n=this.getOrientation();return this.x==t.x&&this.y==t.y&&this.offsets[0]==t.offsets[0]&&this.offsets[1]==t.offsets[1]&&n[0]==e[0]&&n[1]==e[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(t){this.userDefinedLocation=t},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),e.FloatingAnchor=function(t){e.Anchor.apply(this,arguments);var n=t.reference,i=t.referenceCanvas,o=e.getSize(i),s=null,r=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var e=t.xy,n=[e[0]+o[0]/2,e[1]+o[1]/2];return r=n,n},this.getOrientation=function(t){if(s)return s;var e=n.getOrientation(t);return[0*Math.abs(e[0])*-1,0*Math.abs(e[1])*-1]},this.over=function(t,e){s=t.getOrientation(e)},this.out=function(){s=null},this.getCurrentLocation=function(t){return null==r?this.compute(t):r}},t.extend(e.FloatingAnchor,e.Anchor);var n=function(t,n,i){return t.constructor==e.Anchor?t:n.makeAnchor(t,i,n)};e.DynamicAnchor=function(t){e.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=t.elementId,this.jsPlumbInstance=t.jsPlumbInstance;for(var i=0;i<t.anchors.length;i++)this.anchors[i]=n(t.anchors[i],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors},this.locked=!1;var o=this.anchors.length>0?this.anchors[0]:null,s=o,r=this,l=function(t,e,n,i,o){var s=i[0]+t.x*o[0],r=i[1]+t.y*o[1],l=i[0]+o[0]/2,a=i[1]+o[1]/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(n-r,2))+Math.sqrt(Math.pow(l-s,2)+Math.pow(a-r,2))},a=t.selector||function(t,e,n,i,o){for(var s=n[0]+i[0]/2,r=n[1]+i[1]/2,a=-1,c=1/0,u=0;u<o.length;u++){var h=l(o[u],s,r,t,e);h<c&&(a=u+0,c=h)}return o[a]};this.compute=function(t){var e=t.xy,n=t.wh,i=t.txy,l=t.twh;this.timestamp=t.timestamp;var c=r.getUserDefinedLocation();return null!=c?c:(this.locked||null==i||null==l||(t.timestamp=null,o=a(e,n,i,l,this.anchors),this.x=o.x,this.y=o.y,o!=s&&this.fire("anchorChanged",o),s=o),o.compute(t))},this.getCurrentLocation=function(t){return this.getUserDefinedLocation()||(null!=o?o.getCurrentLocation(t):null)},this.getOrientation=function(t){return null!=o?o.getOrientation(t):[0,0]},this.over=function(t,e){null!=o&&o.over(t,e)},this.out=function(){null!=o&&o.out()},this.getCssClass=function(){return o&&o.getCssClass()||""}},t.extend(e.DynamicAnchor,e.Anchor);var i=function(t,n,i,o,s,r){e.Anchors[s]=function(e){var l=e.jsPlumbInstance.makeAnchor([t,n,i,o,0,0],e.elementId,e.jsPlumbInstance);return l.type=s,r&&r(l,e),l}};i(.5,0,0,-1,"TopCenter"),i(.5,1,0,1,"BottomCenter"),i(0,.5,-1,0,"LeftMiddle"),i(1,.5,1,0,"RightMiddle"),i(.5,0,0,-1,"Top"),i(.5,1,0,1,"Bottom"),i(0,.5,-1,0,"Left"),i(1,.5,1,0,"Right"),i(.5,.5,0,0,"Center"),i(1,0,0,-1,"TopRight"),i(1,1,0,1,"BottomRight"),i(0,0,0,-1,"TopLeft"),i(0,1,0,1,"BottomLeft"),e.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},e.Anchors.AutoDefault=function(t){var n=t.jsPlumbInstance.makeDynamicAnchor(e.Defaults.DynamicAnchors(t));return n.type="AutoDefault",n};var o=function(t,n){e.Anchors[t]=function(e){var i=e.jsPlumbInstance.makeAnchor(["Continuous",{faces:n}],e.elementId,e.jsPlumbInstance);return i.type=t,i}};e.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},o("ContinuousLeft",["left"]),o("ContinuousTop",["top"]),o("ContinuousBottom",["bottom"]),o("ContinuousRight",["right"]),i(0,0,0,0,"Assign",(function(t,e){var n=e.position||"Fixed";t.positionFinder=n.constructor==String?e.jsPlumbInstance.AnchorPositionFinders[n]:n,t.constructorParams=e})),jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(t,e,n){return[(t.left-e.left)/n[0],(t.top-e.top)/n[1]]},Grid:function(t,e,n,i){var o=t.left-e.left,s=t.top-e.top,r=n[0]/i.grid[0],l=n[1]/i.grid[1],a=Math.floor(o/r),c=Math.floor(s/l);return[(a*r+r/2)/n[0],(c*l+l/2)/n[1]]}},e.Anchors.Perimeter=function(t){var e=(t=t||{}).anchorCount||60,n=t.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");var i=function(){for(var t=.5,n=2*Math.PI/e,i=0,o=[],s=0;s<e;s++){var r=t+t*Math.sin(i),l=t+t*Math.cos(i);o.push([r,l,0,0]),i+=n}return o},o=function(t){for(var n=e/t.length,i=[],o=function(t,o,s,r,l){for(var a=(s-t)/(n=e*l),c=(r-o)/n,u=0;u<n;u++)i.push([t+a*u,o+c*u,0,0])},s=0;s<t.length;s++)o.apply(null,t[s]);return i},s=function(t){for(var e=[],n=0;n<t.length;n++)e.push([t[n][0],t[n][1],t[n][2],t[n][3],1/t.length]);return o(e)},r=function(){return s([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},l={Circle:i,Ellipse:i,Diamond:function(){return s([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:r,Square:r,Triangle:function(){return s([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var e=t.points,n=[],i=0,s=0;s<e.length-1;s++){var r=Math.sqrt(Math.pow(e[s][2]-e[s][0])+Math.pow(e[s][3]-e[s][1]));i+=r,n.push([e[s][0],e[s][1],e[s+1][0],e[s+1][1],r])}for(var l=0;l<n.length;l++)n[l][4]=n[l][4]/i;return o(n)}};if(!l[n])throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var a=l[n](t);t.rotation&&(a=function(t,e){for(var n=[],i=e/180*Math.PI,o=0;o<t.length;o++){var s=t[o][0]-.5,r=t[o][1]-.5;n.push([s*Math.cos(i)-r*Math.sin(i)+.5,s*Math.sin(i)+r*Math.cos(i)+.5,t[o][2],t[o][3]])}return n}(a,t.rotation));var c=t.jsPlumbInstance.makeDynamicAnchor(a);return c.type="Perimeter",c}}.call(this),function(){"use strict";var t=this,e=t.jsPlumb,n=t.jsPlumbUtil,i=t.Biltong;e.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,e){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}}},Straight:function(t){var n,o,s,r,l,a,c;e.Segments.AbstractSegment.apply(this,arguments),this.type="Straight",this.getLength=function(){return n},this.getGradient=function(){return o},this.getCoordinates=function(){return{x1:r,y1:a,x2:l,y2:c}},this.setCoordinates=function(t){r=t.x1,a=t.y1,l=t.x2,c=t.y2,n=Math.sqrt(Math.pow(l-r,2)+Math.pow(c-a,2)),o=i.gradient({x:r,y:a},{x:l,y:c}),s=-1/o},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(r,l),minY:Math.min(a,c),maxX:Math.max(r,l),maxY:Math.max(a,c)}},this.pointOnPath=function(t,e){if(0!==t||e){if(1!=t||e){var o=e?t>0?t:n+t:t*n;return i.pointOnLine({x:r,y:a},{x:l,y:c},o)}return{x:l,y:c}}return{x:r,y:a}},this.gradientAtPoint=function(t){return o},this.pointAlongPathFrom=function(t,e,n){var o=this.pointOnPath(t,n),s=e<=0?{x:r,y:a}:{x:l,y:c};return e<=0&&Math.abs(e)>1&&(e*=-1),i.pointOnLine(o,s,e)};var u=function(t,e,n){return n>=Math.min(t,e)&&n<=Math.max(t,e)},h=function(t,e,n){return Math.abs(n-t)<Math.abs(n-e)?t:e};this.findClosestPointOnPath=function(t,e){var d={d:1/0,x:null,y:null,l:null,x1:r,x2:l,y1:a,y2:c};if(0===o)d.y=a,d.x=u(r,l,t)?t:h(r,l,t);else if(o==1/0||o==-1/0)d.x=r,d.y=u(a,c,e)?e:h(a,c,e);else{var p=a-o*r,f=(e-s*t-p)/(o-s),m=o*f+p;d.x=u(r,l,f)?f:h(r,l,f),d.y=u(a,c,m)?m:h(a,c,m)}var g=i.lineLength([d.x,d.y],[r,a]);return d.d=i.lineLength([t,e],[d.x,d.y]),d.l=g/n,d}},Arc:function(t){e.Segments.AbstractSegment.apply(this,arguments);var n=function(e,n){return i.theta([t.cx,t.cy],[e,n])},o=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=n(t.x1,t.y1),this.endAngle=n(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=o),this.startAngle<0&&(this.startAngle+=o),this.segment=i.quadrant([this.x1,this.y1],[this.x2,this.y2]);var s=this.endAngle<this.startAngle?this.endAngle+o:this.endAngle;this.sweep=Math.abs(s-this.startAngle),this.anticlockwise&&(this.sweep=o-this.sweep);var r=2*Math.PI*this.radius,l=this.sweep/o,a=r*l;this.getLength=function(){return a},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var c=function(t){var e=Math.floor(t),n=Math.ceil(t);return t-e<1e-10?e:n-t<1e-10?n:t};this.pointOnPath=function(e,n){if(0===e)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1==e)return{x:this.x2,y:this.y2,theta:this.endAngle};n&&(e/=a);var i=function(t,e){if(t.anticlockwise){var n=t.startAngle<t.endAngle?t.startAngle+o:t.startAngle;return n-Math.abs(n-t.endAngle)*e}var i=t.endAngle<t.startAngle?t.endAngle+o:t.endAngle,s=Math.abs(i-t.startAngle);return t.startAngle+s*e}(this,e),s=t.cx+t.r*Math.cos(i),r=t.cy+t.r*Math.sin(i);return{x:c(s),y:c(r),theta:i}},this.gradientAtPoint=function(e,n){var o=this.pointOnPath(e,n),s=i.normal([t.cx,t.cy],[o.x,o.y]);return this.anticlockwise||s!=1/0&&s!=-1/0||(s*=-1),s},this.pointAlongPathFrom=function(e,n,i){var o=this.pointOnPath(e,i),s=n/r*2*Math.PI,l=this.anticlockwise?-1:1,a=o.theta+l*s;return{x:t.cx+this.radius*Math.cos(a),y:t.cy+this.radius*Math.sin(a)}}},Bezier:function(n){this.curve=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}],e.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),minY:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),maxX:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),maxY:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)},this.type="Bezier";var i=function(e,n,i){return i&&(n=t.jsBezier.locationAlongCurveFrom(e,n>0?0:1,n)),n};this.pointOnPath=function(e,n){return e=i(this.curve,e,n),t.jsBezier.pointOnCurve(this.curve,e)},this.gradientAtPoint=function(e,n){return e=i(this.curve,e,n),t.jsBezier.gradientAtPoint(this.curve,e)},this.pointAlongPathFrom=function(e,n,o){return e=i(this.curve,e,o),t.jsBezier.pointAlongCurveFrom(this.curve,e,n)},this.getLength=function(){return t.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds}}};var o=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};e.Connectors.AbstractConnector=function(t){o.apply(this,arguments);var s=[],r=0,l=[],a=[],c=t.stub||0,u=n.isArray(c)?c[0]:c,h=n.isArray(c)?c[1]:c,d=t.gap||0,p=n.isArray(d)?d[0]:d,f=n.isArray(d)?d[1]:d,m=null,g=null;this.getPath=function(){},this.setPath=function(t){},this.findSegmentForPoint=function(t,e){for(var n={d:1/0,s:null,x:null,y:null,l:null},i=0;i<s.length;i++){var o=s[i].findClosestPointOnPath(t,e);o.d<n.d&&(n.d=o.d,n.l=o.l,n.x=o.x,n.y=o.y,n.s=s[i],n.x1=o.x1,n.x2=o.x2,n.y1=o.y1,n.y2=o.y2,n.index=i)}return n};var b=function(t,e){e&&(t=t>0?t/r:(r+t)/r);for(var n=l.length-1,i=1,o=0;o<l.length;o++)if(l[o][1]>=t){n=o,i=1==t?1:0===t?0:(t-l[o][0])/a[o];break}return{segment:s[n],proportion:i,index:n}};this.setSegments=function(t){m=[],r=0;for(var e=0;e<t.length;e++)m.push(t[e]),r+=t[e].getLength()},this.getLength=function(){return r};var v=function(t){this.lineWidth=t.lineWidth;var e=i.quadrant(t.sourcePos,t.targetPos),n=t.targetPos[0]<t.sourcePos[0],o=t.targetPos[1]<t.sourcePos[1],s=t.lineWidth||1,r=t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),l=t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),a=n?t.targetPos[0]:t.sourcePos[0],c=o?t.targetPos[1]:t.sourcePos[1],d=Math.abs(t.targetPos[0]-t.sourcePos[0]),m=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(0===r[0]&&0===r[1]||0===l[0]&&0===l[1]){var g=d>m?0:1,b=[1,0][g];l=[],(r=[])[g]=t.sourcePos[g]>t.targetPos[g]?-1:1,l[g]=t.sourcePos[g]>t.targetPos[g]?1:-1,r[b]=0,l[b]=0}var v=n?d+p*r[0]:p*r[0],y=o?m+p*r[1]:p*r[1],w=n?f*l[0]:d+f*l[0],_=o?f*l[1]:m+f*l[1],j=r[0]*l[0]+r[1]*l[1],x={sx:v,sy:y,tx:w,ty:_,lw:s,xSpan:Math.abs(w-v),ySpan:Math.abs(_-y),mx:(v+w)/2,my:(y+_)/2,so:r,to:l,x:a,y:c,w:d,h:m,segment:e,startStubX:v+r[0]*u,startStubY:y+r[1]*u,endStubX:w+l[0]*h,endStubY:_+l[1]*h,isXGreaterThanStubTimes2:Math.abs(v-w)>u+h,isYGreaterThanStubTimes2:Math.abs(y-_)>u+h,opposite:-1==j,perpendicular:0===j,orthogonal:1==j,sourceAxis:0===r[0]?"y":"x",points:[a,c,d,m,v,y,w,_]};return x.anchorOrientation=x.opposite?"opposite":x.orthogonal?"orthogonal":"perpendicular",x};return this.getSegments=function(){return s},this.updateBounds=function(t){var e=t.getBounds();this.bounds.minX=Math.min(this.bounds.minX,e.minX),this.bounds.maxX=Math.max(this.bounds.maxX,e.maxX),this.bounds.minY=Math.min(this.bounds.minY,e.minY),this.bounds.maxY=Math.max(this.bounds.maxY,e.maxY)},this.pointOnPath=function(t,e){var n=b(t,e);return n.segment&&n.segment.pointOnPath(n.proportion,!1)||[0,0]},this.gradientAtPoint=function(t,e){var n=b(t,e);return n.segment&&n.segment.gradientAtPoint(n.proportion,!1)||0},this.pointAlongPathFrom=function(t,e,n){var i=b(t,n);return i.segment&&i.segment.pointAlongPathFrom(i.proportion,e,!1)||[0,0]},this.compute=function(t){g=v.call(this,t),r=s.length=l.length=a.length=0,this._compute(g,t),this.x=g.points[0],this.y=g.points[1],this.w=g.points[2],this.h=g.points[3],this.segment=g.segment,function(){for(var t=0,e=0;e<s.length;e++){var n=s[e].getLength();a[e]=n/r,l[e]=[t,t+=n/r]}}()},{addSegment:function(t,n,i){if(i.x1!=i.x2||i.y1!=i.y2){var o=new e.Segments[n](i);s.push(o),r+=o.getLength(),t.updateBounds(o)}},prepareCompute:v,sourceStub:u,targetStub:h,maxStub:Math.max(u,h),sourceGap:p,targetGap:f,maxGap:Math.max(p,f)}},n.extend(e.Connectors.AbstractConnector,o);var s=e.Connectors.Straight=function(){this.type="Straight";var t=e.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(e,n){t.addSegment(this,"Straight",{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY}),t.addSegment(this,"Straight",{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY}),t.addSegment(this,"Straight",{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty})}};n.extend(e.Connectors.Straight,e.Connectors.AbstractConnector),e.registerConnectorType(s,"Straight"),e.Endpoints.AbstractEndpoint=function(t){o.apply(this,arguments);var e=this.compute=function(t,e,n,i){var o=this._compute.apply(this,arguments);return this.x=o[0],this.y=o[1],this.w=o[2],this.h=o[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,o};return{compute:e,cssClass:t.cssClass}},n.extend(e.Endpoints.AbstractEndpoint,o),e.Endpoints.Dot=function(t){this.type="Dot",e.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,e,n,i){this.radius=n.radius||this.radius;var o=t[0]-this.radius,s=t[1]-this.radius,r=2*this.radius,l=2*this.radius;if(n.strokeStyle){var a=n.lineWidth||1;o-=a,s-=a,r+=2*a,l+=2*a}return[o,s,r,l,this.radius]}},n.extend(e.Endpoints.Dot,e.Endpoints.AbstractEndpoint),e.Endpoints.Rectangle=function(t){this.type="Rectangle",e.Endpoints.AbstractEndpoint.apply(this,arguments),t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(t,e,n,i){var o=n.width||this.width,s=n.height||this.height;return[t[0]-o/2,t[1]-s/2,o,s]}},n.extend(e.Endpoints.Rectangle,e.Endpoints.AbstractEndpoint);var r=function(t){e.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};n.extend(r,e.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),e.Endpoints.Image=function(i){this.type="Image",r.apply(this,arguments),e.Endpoints.AbstractEndpoint.apply(this,arguments);var o=i.onload,s=i.src||i.url,l=i.cssClass?" "+i.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=i.width,this._jsPlumb.heightToUse=i.height,this._jsPlumb.endpoint=i.endpoint,this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,o&&o(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(t,e){var n=t.constructor==String?t:t.src;o=e,this._jsPlumb.img.src=n,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(s,o),this._compute=function(t,e,n,i){return this.anchorPoint=t,this._jsPlumb.ready?[t[0]-this._jsPlumb.widthToUse/2,t[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=jsPlumb.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+l),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(t,e,i){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var o=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,s=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;n.sizeElement(this.canvas,o,s,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(e,n){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(e,n):t.setTimeout(function(){this.paint(e,n)}.bind(this),200))}},n.extend(e.Endpoints.Image,[r,e.Endpoints.AbstractEndpoint],{cleanup:function(t){t&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),e.Endpoints.Blank=function(t){e.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",r.apply(this,arguments),this._compute=function(t,e,n,i){return[t[0],t[1],10,0]};var i=t.cssClass?" "+t.cssClass:"";this.canvas=jsPlumb.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+i),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(t,e){n.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},n.extend(e.Endpoints.Blank,[e.Endpoints.AbstractEndpoint,r],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),e.Endpoints.Triangle=function(t){this.type="Triangle",e.Endpoints.AbstractEndpoint.apply(this,arguments),(t=t||{}).width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,e,n,i){var o=n.width||self.width,s=n.height||self.height;return[t[0]-o/2,t[1]-s/2,o,s]}};var l=e.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation};l.prototype={cleanup:function(t){t&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(t){},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},e.Overlays.Arrow=function(t){this.type="Arrow",l.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{},this.length=t.length||20,this.width=t.width||20,this.id=t.id;var e=(t.direction||1)<0?-1:1,o=t.paintStyle||{lineWidth:1},s=t.foldback||.623;this.computeMaxSize=function(){return 1.5*self.width},this.draw=function(t,r){var l,a,c,u;if(t.pointAlongPathFrom){if(n.isString(this.loc)||this.loc>1||this.loc<0){var h=parseInt(this.loc,10),d=this.loc<0?1:0;l=t.pointAlongPathFrom(d,h,!1),a=t.pointAlongPathFrom(d,h-e*this.length/2,!1),c=i.pointOnLine(l,a,this.length)}else if(1==this.loc){if(l=t.pointOnPath(this.loc),a=t.pointAlongPathFrom(this.loc,-this.length),c=i.pointOnLine(l,a,this.length),-1==e){var p=c;c=l,l=p}}else if(0===this.loc){if(c=t.pointOnPath(this.loc),a=t.pointAlongPathFrom(this.loc,this.length),l=i.pointOnLine(c,a,this.length),-1==e){var f=c;c=l,l=f}}else l=t.pointAlongPathFrom(this.loc,e*this.length/2),a=t.pointOnPath(this.loc),c=i.pointOnLine(l,a,this.length);var m={hxy:l,tail:u=i.perpendicularLineTo(l,c,this.width),cxy:i.pointOnLine(l,c,s*this.length)},g=o.strokeStyle||r.strokeStyle,b=o.fillStyle||r.strokeStyle;return{component:t,d:m,lineWidth:o.lineWidth||r.lineWidth,strokeStyle:g,fillStyle:b,minX:Math.min(l.x,u[0].x,u[1].x),maxX:Math.max(l.x,u[0].x,u[1].x),minY:Math.min(l.y,u[0].y,u[1].y),maxY:Math.max(l.y,u[0].y,u[1].y)}}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},n.extend(e.Overlays.Arrow,l,{updateFrom:function(t){this.length=t.length||this.length,this.width=t.width||this.width,this.direction=null!=t.direction?t.direction:this.direction,this.foldback=t.foldback||this.foldback}}),e.Overlays.PlainArrow=function(t){t=t||{};var n=e.extend(t,{foldback:1});e.Overlays.Arrow.call(this,n),this.type="PlainArrow"},n.extend(e.Overlays.PlainArrow,e.Overlays.Arrow),e.Overlays.Diamond=function(t){var n=(t=t||{}).length||40,i=jsPlumb.extend(t,{length:n/2,foldback:2});e.Overlays.Arrow.call(this,i),this.type="Diamond"},n.extend(e.Overlays.Diamond,e.Overlays.Arrow);var a=function(t,e){return(null==t._jsPlumb.cachedDimensions||e)&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},c=function(t){e.jsPlumbUIComponent.apply(this,arguments),l.apply(this,arguments);var i=this.fire;this.fire=function(){i.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this._jsPlumb.initiallyInvisible=!1===t.visible,this.getElement=function(){if(null==this._jsPlumb.div){var e=this._jsPlumb.div=jsPlumb.getElement(this._jsPlumb.create(this._jsPlumb.component));e.style.position="absolute",e.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:""),this._jsPlumb.instance.appendElement(e),this._jsPlumb.instance.getId(e),this.canvas=e;var n="translate(-50%, -50%)";e.style.webkitTransform=n,e.style.mozTransform=n,e.style.msTransform=n,e.style.oTransform=n,e.style.transform=n,e._jsPlumb=this,!1===t.visible&&(e.style.display="none")}return this._jsPlumb.div},this.draw=function(t,e,i){var o=a(this);if(null!=o&&2==o.length){var s={x:0,y:0};if(i)s={x:i[0],y:i[1]};else if(t.pointOnPath){var r=this.loc,l=!1;(n.isString(this.loc)||this.loc<0||this.loc>1)&&(r=parseInt(this.loc,10),l=!0),s=t.pointOnPath(r,l)}else{var c=this.loc.constructor==Array?this.loc:this.endpointLoc;s={x:c[0]*t.w,y:c[1]*t.h}}var u=s.x-o[0]/2,h=s.y-o[1]/2;return{component:t,d:{minx:u,miny:h,td:o,cxy:s},minX:u,maxX:u+o[0],minY:h,maxY:h+o[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};n.extend(c,[e.jsPlumbUIComponent,l],{getDimensions:function(){return n.oldIE?e.getSize(this.getElement()):[1,1]},setVisible:function(t){this._jsPlumb.div&&(this._jsPlumb.div.style.display=t?"block":"none",t&&this._jsPlumb.initiallyInvisible&&(a(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(t){t?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(t){null!=this._jsPlumb.div&&t.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var t=a(this);return Math.max(t[0],t[1])},paint:function(t,e){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),e.Overlays.Custom=function(t){this.type="Custom",c.apply(this,arguments)},n.extend(e.Overlays.Custom,c),e.Overlays.GuideLines=function(){var t=this;t.length=50,t.lineWidth=5,this.type="GuideLines",l.apply(this,arguments),e.jsPlumbUIComponent.apply(this,arguments),this.draw=function(e,n){var o=e.pointAlongPathFrom(t.loc,t.length/2),s=e.pointOnPath(t.loc),r=i.pointOnLine(o,s,t.length),l=i.perpendicularLineTo(o,r,40),a=i.perpendicularLineTo(r,o,20);return{connector:e,head:o,tail:r,headLine:a,tailLine:l,minX:Math.min(o.x,r.x,a[0].x,a[1].x),minY:Math.min(o.y,r.y,a[0].y,a[1].y),maxX:Math.max(o.x,r.x,a[0].x,a[1].x),maxY:Math.max(o.y,r.y,a[0].y,a[1].y)}}},e.Overlays.Label=function(t){this.labelStyle=t.labelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var n=e.extend({create:function(){return jsPlumb.createElement("div")}},t);if(e.Overlays.Custom.call(this,n),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle){var i=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",i.style.font=this.labelStyle.font,i.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(i.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0){var o=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";i.style.border=this.labelStyle.borderWidth+"px solid "+o}this.labelStyle.padding&&(i.style.padding=this.labelStyle.padding)}},n.extend(e.Overlays.Label,e.Overlays.Custom,{cleanup:function(t){t&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),c.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(t){t.label&&this.setLabel(t.label)}})}.call(this),function(){"use strict";var t=this;t.jsPlumb.extend(t.jsPlumbInstance.prototype,{getEventManager:function(){return(e=this._mottle)||(e=this._mottle=new t.Mottle),e;var e},on:function(t,e,n){return this.getEventManager().on.apply(this,arguments),this},off:function(t,e,n){return this.getEventManager().off.apply(this,arguments),this}})}.call(this),function(){"use strict";var t=this.jsPlumb,e=function(e){this.type="Flowchart",(e=e||{}).stub=null==e.stub?30:e.stub;var n,i=t.Connectors.AbstractConnector.apply(this,arguments),o=null==e.midpoint?.5:e.midpoint,s=!0===e.alwaysRespectStubs,r=null,l=null,a=null,c=null!=e.cornerRadius?e.cornerRadius:0,u=function(t){return t<0?-1:0===t?0:1},h=function(t,e,n,i){if(l!=e||a!=n){var o=null==l?i.sx:l,s=null==a?i.sy:a,r=o==e?"v":"h",c=u(e-o),h=u(n-s);l=e,a=n,t.push([o,s,e,n,r,c,h])}},d=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},p=function(t){var e=[];return e.push.apply(e,t),e},f=function(t,e,n){for(var o,s=null,r=0;r<e.length-1;r++){if(s=s||p(e[r]),o=p(e[r+1]),c>0&&s[4]!=o[4]){var l=Math.min(c,d(s),d(o));s[2]-=s[5]*l,s[3]-=s[6]*l,o[0]+=o[5]*l,o[1]+=o[6]*l;var a=s[6]==o[5]&&1==o[5]||s[6]==o[5]&&0===o[5]&&s[5]!=o[6]||s[6]==o[5]&&-1==o[5],u=(o[1]>s[3]?1:-1)==(o[0]>s[2]?1:-1),h=u&&a||!u&&!a?o[0]:s[2],f=u&&a||!u&&!a?s[3]:o[1];i.addSegment(t,"Straight",{x1:s[0],y1:s[1],x2:s[2],y2:s[3]}),i.addSegment(t,"Arc",{r:l,x1:s[2],y1:s[3],x2:o[0],y2:o[1],cx:h,cy:f,ac:a})}else{var m=s[2]==s[0]?0:s[2]>s[0]?n.lw/2:-n.lw/2,g=s[3]==s[1]?0:s[3]>s[1]?n.lw/2:-n.lw/2;i.addSegment(t,"Straight",{x1:s[0]-m,y1:s[1]-g,x2:s[2]+m,y2:s[3]+g})}s=o}null!=o&&i.addSegment(t,"Straight",{x1:o[0],y1:o[1],x2:o[2],y2:o[3]})};this.setSegments=function(t){r=t},this.isEditable=function(){return!0},this.getOriginalSegments=function(){return r||n},this._compute=function(t,e){if(e.clearEdits&&(r=null),null==r){n=[],l=null,a=null;var c=t.startStubX+(t.endStubX-t.startStubX)*o,u=t.startStubY+(t.endStubY-t.startStubY)*o,d={x:[0,1],y:[1,0]},p=function(){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},m={perpendicular:p,orthogonal:p,opposite:function(e){var n=t,i="x"==e?0:1;return!s&&{x:function(){return 1==n.so[i]&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||-1==n.so[i]&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return 1==n.so[i]&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||-1==n.so[i]&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}}[e]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}},g={perpendicular:function(e){var n=t,i={x:[[n.startStubX,n.endStubX],null,[n.endStubX,n.startStubX]],y:[[n.startStubY,n.endStubY],null,[n.endStubY,n.startStubY]]},o={x:[[c,n.startStubY],[c,n.endStubY]],y:[[n.startStubX,u],[n.endStubX,u]]},s={x:[[n.endStubX,n.startStubY]],y:[[n.startStubX,n.endStubY]]},r={x:[[n.startStubX,n.endStubY],[n.endStubX,n.endStubY]],y:[[n.endStubX,n.startStubY],[n.endStubX,n.endStubY]]},l={x:[[n.startStubX,u],[n.endStubX,u],[n.endStubX,n.endStubY]],y:[[c,n.startStubY],[c,n.endStubY],[n.endStubX,n.endStubY]]},a={x:[n.startStubY,n.endStubY],y:[n.startStubX,n.endStubX]},h=d[e][0],p=d[e][1],f=n.so[h]+1,m=n.to[p]+1,g=-1==n.to[p]&&a[e][1]<a[e][0]||1==n.to[p]&&a[e][1]>a[e][0],b=i[e][f][0],v=i[e][f][1],y={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[e][f][m];return n.segment==y[3]||n.segment==y[2]&&g?o[e]:n.segment==y[2]&&v<b?s[e]:n.segment==y[2]&&v>=b||n.segment==y[1]&&!g?l[e]:n.segment==y[0]||n.segment==y[1]&&g?r[e]:void 0},orthogonal:function(e,n,i,o,s){var r=t,l={x:-1==r.so[0]?Math.min(n,o):Math.max(n,o),y:-1==r.so[1]?Math.min(n,o):Math.max(n,o)}[e];return{x:[[l,i],[l,s],[o,s]],y:[[i,l],[s,l],[s,o]]}[e]},opposite:function(n,o,s,r){var l=t,a={x:"y",y:"x"}[n],h={x:"height",y:"width"}[n],d=l["is"+n.toUpperCase()+"GreaterThanStubTimes2"];if(e.sourceEndpoint.elementId==e.targetEndpoint.elementId){var p=s+(1-e.sourceEndpoint.anchor[a])*e.sourceInfo[h]+i.maxStub;return{x:[[o,p],[r,p]],y:[[p,o],[p,r]]}[n]}return!d||1==l.so[v]&&o>r||-1==l.so[v]&&o<r?{x:[[o,u],[r,u]],y:[[c,o],[c,r]]}[n]:1==l.so[v]&&o<r||-1==l.so[v]&&o>r?{x:[[c,l.sy],[c,l.ty]],y:[[l.sx,u],[l.tx,u]]}[n]:void 0}},b=m[t.anchorOrientation](t.sourceAxis),v="x"==t.sourceAxis?0:1,y="x"==t.sourceAxis?1:0,w=b[v],_=b[y],j=b[v+2],x=b[y+2];h(n,b[0],b[1],t);var P=g[t.anchorOrientation](t.sourceAxis,w,_,j,x);if(P)for(var C=0;C<P.length;C++)h(n,P[C][0],P[C][1],t);h(n,b[2],b[3],t),h(n,t.tx,t.ty,t),f(this,n,t)}else f(this,r,t)},this.getPath=function(){for(var t=null,e=null,i=[],o=r||n,s=0;s<o.length;s++){var l=o[s],a=l[4],c="v"==a?3:2;null!=t&&e===a?t[c]=l[c]:l[0]==l[2]&&l[1]==l[3]||(i.push({start:[l[0],l[1]],end:[l[2],l[3]]}),t=l,e=l[4])}return i},this.setPath=function(t){r=[];for(var e=0;e<t.length;e++){var n=t[e].start[0],i=t[e].start[1],o=t[e].end[0],s=t[e].end[1],l=n==o?"v":"h",a=u(o-n),c=u(s-i);r.push([n,i,o,s,l,a,c])}}};this.jsPlumbUtil.extend(e,t.Connectors.AbstractConnector),t.registerConnectorType(e,"Flowchart")}.call(this),function(){"use strict";var t=this.jsPlumb,e=function(e){e=e||{},this.type="StateMachine";var n=t.Connectors.AbstractConnector.apply(this,arguments),i=e.curviness||10,o=e.margin||5,s=e.proximityLimit||80,r=e.orientation&&"clockwise"===e.orientation,l=e.loopbackRadius||25,a=!1!==e.showLoopback;this._compute=function(t,e){var c=Math.abs(e.sourcePos[0]-e.targetPos[0]),u=Math.abs(e.sourcePos[1]-e.targetPos[1]);if(a&&e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var h=e.sourcePos[0],d=e.sourcePos[1]-o,p=h,f=d-l,m=2*l,g=2*l,b=p-l,v=f-l;t.points[0]=b,t.points[1]=v,t.points[2]=m,t.points[3]=g,n.addSegment(this,"Arc",{loopback:!0,x1:h-b+4,y1:d-v,startAngle:0,endAngle:2*Math.PI,r:l,ac:!r,x2:h-b-4,y2:d-v,cx:p-b,cy:f-v})}else{var y=e.sourcePos[0]<e.targetPos[0]?0:c,w=e.sourcePos[1]<e.targetPos[1]?0:u,_=e.sourcePos[0]<e.targetPos[0]?c:0,j=e.sourcePos[1]<e.targetPos[1]?u:0;0===e.sourcePos[2]&&(y-=o),1===e.sourcePos[2]&&(y+=o),0===e.sourcePos[3]&&(w-=o),1===e.sourcePos[3]&&(w+=o),0===e.targetPos[2]&&(_-=o),1===e.targetPos[2]&&(_+=o),0===e.targetPos[3]&&(j-=o),1===e.targetPos[3]&&(j+=o);var x=(y+_)/2,P=(w+j)/2,C=function(t,e,n,i){return t<=n&&i<=e?1:t<=n&&e<=i?2:n<=t&&i>=e?3:4}(y,w,_,j),S=Math.sqrt(Math.pow(_-y,2)+Math.pow(j-w,2)),E=function(t,e,n,i,o,s,r,l,a){return l<=a?[t,e]:1===n?i[3]<=0&&o[3]>=1?[t+(i[2]<.5?-1*s:s),e]:i[2]>=1&&o[2]<=0?[t,e+(i[3]<.5?-1*r:r)]:[t+-1*s,e+-1*r]:2===n?i[3]>=1&&o[3]<=0?[t+(i[2]<.5?-1*s:s),e]:i[2]>=1&&o[2]<=0?[t,e+(i[3]<.5?-1*r:r)]:[t+s,e+-1*r]:3===n?i[3]>=1&&o[3]<=0?[t+(i[2]<.5?-1*s:s),e]:i[2]<=0&&o[2]>=1?[t,e+(i[3]<.5?-1*r:r)]:[t+-1*s,e+-1*r]:4===n?i[3]<=0&&o[3]>=1?[t+(i[2]<.5?-1*s:s),e]:i[2]<=0&&o[2]>=1?[t,e+(i[3]<.5?-1*r:r)]:[t+s,e+-1*r]:void 0}(x,P,C,e.sourcePos,e.targetPos,i,i,S,s);n.addSegment(this,"Bezier",{x1:_,y1:j,x2:y,y2:w,cp1x:E[0],cp1y:E[1],cp2x:E[0],cp2y:E[1]})}}};this.jsPlumbUtil.extend(e,t.Connectors.AbstractConnector),t.registerConnectorType(e,"StateMachine")}.call(this),function(){"use strict";var t=this.jsPlumb,e=function(e){e=e||{};var n=t.Connectors.AbstractConnector.apply(this,arguments),i=e.curviness||150,o=10;this.type="Bezier",this.getCurviness=function(){return i},this._findControlPoint=function(t,e,n,s,r,l,a){var c=[];return l[0]!=a[0]||l[1]==a[1]?(0===a[0]?c.push(n[0]<e[0]?t[0]+o:t[0]-o):c.push(t[0]+i*a[0]),0===a[1]?c.push(n[1]<e[1]?t[1]+o:t[1]-o):c.push(t[1]+i*l[1])):(0===l[0]?c.push(e[0]<n[0]?t[0]+o:t[0]-o):c.push(t[0]-i*l[0]),0===l[1]?c.push(e[1]<n[1]?t[1]+o:t[1]-o):c.push(t[1]+i*a[1])),c},this._compute=function(t,e){var i=e.sourcePos,o=e.targetPos,s=Math.abs(i[0]-o[0]),r=Math.abs(i[1]-o[1]),l=i[0]<o[0]?s:0,a=i[1]<o[1]?r:0,c=i[0]<o[0]?0:s,u=i[1]<o[1]?0:r,h=this._findControlPoint([l,a],i,o,e.sourceEndpoint,e.targetEndpoint,t.so,t.to),d=this._findControlPoint([c,u],o,i,e.targetEndpoint,e.sourceEndpoint,t.to,t.so);n.addSegment(this,"Bezier",{x1:l,y1:a,x2:c,y2:u,cp1x:h[0],cp1y:h[1],cp2x:d[0],cp2y:d[1]})}};this.jsPlumbUtil.extend(e,t.Connectors.AbstractConnector),t.registerConnectorType(e,"Bezier")}.call(this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},i="stroke-dasharray",o="dashstyle",s="fill",r="stroke",l="none",a=function(t,e){for(var n in e)t.setAttribute(n,""+e[n])},c=function(t,e){return(e=e||{}).version="1.1",e.xmlns="http://www.w3.org/1999/xhtml",jsPlumb.createElementNS("http://www.w3.org/2000/svg",t,null,null,e)},u=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},h=function(t){for(var e=t.querySelectorAll(" defs,linearGradient,radialGradient"),n=0;n<e.length;n++)e[n].parentNode.removeChild(e[n])},d=function(t,e,a,u,d){if(e.setAttribute(s,a.fillStyle?a.fillStyle:l),e.setAttribute(r,a.strokeStyle?a.strokeStyle:l),a.gradient?function(t,e,n,i,o){var l,a="jsplumb_gradient_"+o._jsPlumb.instance.idstamp();h(t),l=n.gradient.offset?c("radialGradient",{id:a}):c("linearGradient",{id:a,gradientUnits:"userSpaceOnUse"});var u=c("defs");t.appendChild(u),u.appendChild(l);for(var d=0;d<n.gradient.stops.length;d++){var p=1==o.segment||2==o.segment?d:n.gradient.stops.length-1-d,f=n.gradient.stops[p][1],m=c("stop",{offset:Math.floor(100*n.gradient.stops[d][0])+"%","stop-color":f});l.appendChild(m)}var g=n.strokeStyle?r:s;e.setAttribute(g,"url(#"+a+")")}(t,e,a,0,d):(h(t),e.setAttribute("style","")),a.lineWidth&&e.setAttribute("stroke-width",a.lineWidth),a[o]&&a.lineWidth&&!a[i]){var p=-1==a[o].indexOf(",")?" ":",",f=a[o].split(p),m="";f.forEach((function(t){m+=Math.floor(t*a.lineWidth)+p})),e.setAttribute(i,m)}else a[i]&&e.setAttribute(i,a[i]);for(var g in n)a[g]&&e.setAttribute(n[g],a[g])},p=function(t,e,n){t.childNodes.length>n?t.insertBefore(e,t.childNodes[n]):t.appendChild(e)};e.svg={node:c,attr:a,pos:u};var f=function(n){var i=n.pointerEventsSpec||"all",o={};t.jsPlumbUIComponent.apply(this,n.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var s=n.cssClass+" "+(n.originalArgs[0].cssClass||""),r={style:"",width:0,height:0,"pointer-events":i,position:"absolute"};this.svg=c("svg",r),n.useDivWrapper?(this.canvas=jsPlumb.createElement("div",{position:"absolute"}),e.sizeElement(this.canvas,0,0,1,1),this.canvas.className=s):(a(this.svg,{class:s}),this.canvas=this.svg),n._jsPlumb.appendElement(this.canvas,n.originalArgs[0].parent),n.useDivWrapper&&this.canvas.appendChild(this.svg);var l=[this.canvas];return this.getDisplayElements=function(){return l},this.appendDisplayElement=function(t){l.push(t)},this.paint=function(t,i,s){if(null!=t){var r,l=[this.x,this.y],c=[this.w,this.h];null!=s&&(s.xmin<0&&(l[0]+=s.xmin),s.ymin<0&&(l[1]+=s.ymin),c[0]=s.xmax+(s.xmin<0?-s.xmin:0),c[1]=s.ymax+(s.ymin<0?-s.ymin:0)),n.useDivWrapper?(e.sizeElement(this.canvas,l[0],l[1],c[0],c[1]),l[0]=0,l[1]=0,r=u([0,0])):r=u([l[0],l[1]]),o.paint.apply(this,arguments),a(this.svg,{style:r,width:c[0]||0,height:c[1]||0})}},{renderer:o}};e.extend(f,t.jsPlumbUIComponent,{cleanup:function(t){t||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(t){var e=t.getContainer();this.canvas&&null==this.canvas.parentNode&&e.appendChild(this.canvas),this.bgCanvas&&null==this.bgCanvas.parentNode&&e.appendChild(this.bgCanvas)},setVisible:function(t){this.canvas&&(this.canvas.style.display=t?"block":"none")}}),t.ConnectorRenderers.svg=function(e){var n=this;f.apply(this,[{cssClass:e._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:e._jsPlumb}]).renderer.paint=function(i,o,s){var r=n.getSegments(),l="",u=[0,0];if(s.xmin<0&&(u[0]=-s.xmin),s.ymin<0&&(u[1]=-s.ymin),r.length>0){for(var h=0;h<r.length;h++)l+=t.Segments.svg.SegmentRenderer.getPath(r[h]),l+=" ";var f={d:l,transform:"translate("+u[0]+","+u[1]+")","pointer-events":e["pointer-events"]||"visibleStroke"},m=null;if(n.x,n.y,n.w,n.h,i.outlineColor){var g=i.outlineWidth||1,b=i.lineWidth+2*g;delete(m=t.extend({},i)).gradient,m.strokeStyle=i.outlineColor,m.lineWidth=b,null==n.bgPath?(n.bgPath=c("path",f),t.addClass(n.bgPath,t.connectorOutlineClass),p(n.svg,n.bgPath,0)):a(n.bgPath,f),d(n.svg,n.bgPath,m,0,n)}null==n.path?(n.path=c("path",f),p(n.svg,n.path,i.outlineColor?1:0)):a(n.path,f),d(n.svg,n.path,i,0,n)}}},e.extend(t.ConnectorRenderers.svg,f),t.Segments.svg={SegmentRenderer:{getPath:function(t){return{Straight:function(){var e=t.getCoordinates();return"M "+e.x1+" "+e.y1+" L "+e.x2+" "+e.y2},Bezier:function(){var e=t.params;return"M "+e.x1+" "+e.y1+" C "+e.cp1x+" "+e.cp1y+" "+e.cp2x+" "+e.cp2y+" "+e.x2+" "+e.y2},Arc:function(){var e=t.params,n=t.sweep>Math.PI?1:0,i=t.anticlockwise?0:1;return"M"+t.x1+" "+t.y1+" A "+t.radius+" "+e.r+" 0 "+n+","+i+" "+t.x2+" "+t.y2}}[t.type]()}}};var m=t.SvgEndpoint=function(e){f.apply(this,[{cssClass:e._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:e._jsPlumb}]).renderer.paint=function(e){var n=t.extend({},e);n.outlineColor&&(n.strokeWidth=n.outlineWidth,n.strokeStyle=n.outlineColor),null==this.node?(this.node=this.makeNode(n),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node),d(this.svg,this.node,n,(this.x,this.y,this.w,this.h),this),u(this.node,(this.x,this.y))}.bind(this)};e.extend(m,f),t.Endpoints.svg.Dot=function(){t.Endpoints.Dot.apply(this,arguments),m.apply(this,arguments),this.makeNode=function(t){return c("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){a(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},e.extend(t.Endpoints.svg.Dot,[t.Endpoints.Dot,m]),t.Endpoints.svg.Rectangle=function(){t.Endpoints.Rectangle.apply(this,arguments),m.apply(this,arguments),this.makeNode=function(t){return c("rect",{width:this.w,height:this.h})},this.updateNode=function(t){a(t,{width:this.w,height:this.h})}},e.extend(t.Endpoints.svg.Rectangle,[t.Endpoints.Rectangle,m]),t.Endpoints.svg.Image=t.Endpoints.Image,t.Endpoints.svg.Blank=t.Endpoints.Blank,t.Overlays.svg.Label=t.Overlays.Label,t.Overlays.svg.Custom=t.Overlays.Custom;var g=function(e,n){e.apply(this,n),t.jsPlumbUIComponent.apply(this,n),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(t,e){if(t.component.svg&&e){null==this.path&&(this.path=c("path",{"pointer-events":"all"}),t.component.svg.appendChild(this.path),this.canvas=t.component.svg);var o=n&&1==n.length&&n[0].cssClass||"",s=[0,0];e.xmin<0&&(s[0]=-e.xmin),e.ymin<0&&(s[1]=-e.ymin),a(this.path,{d:i(t.d),class:o,stroke:t.strokeStyle?t.strokeStyle:null,fill:t.fillStyle?t.fillStyle:null,transform:"translate("+s[0]+","+s[1]+")"})}};var i=function(t){return isNaN(t.cxy.x)||isNaN(t.cxy.y)?"":"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.transfer=function(t){t.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),t.canvas.appendChild(this.path))}};e.extend(g,[t.jsPlumbUIComponent,t.Overlays.AbstractOverlay],{cleanup:function(t){null!=this.path&&(t?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(t){this.path&&this.canvas&&null==this.path.parentNode&&this.canvas.appendChild(this.path)},setVisible:function(t){null!=this.path&&(this.path.style.display=t?"block":"none")}}),t.Overlays.svg.Arrow=function(){g.apply(this,[t.Overlays.Arrow,arguments])},e.extend(t.Overlays.svg.Arrow,[t.Overlays.Arrow,g]),t.Overlays.svg.PlainArrow=function(){g.apply(this,[t.Overlays.PlainArrow,arguments])},e.extend(t.Overlays.svg.PlainArrow,[t.Overlays.PlainArrow,g]),t.Overlays.svg.Diamond=function(){g.apply(this,[t.Overlays.Diamond,arguments])},e.extend(t.Overlays.svg.Diamond,[t.Overlays.Diamond,g]),t.Overlays.svg.GuideLines=function(){var e,n,i=null,o=this;t.Overlays.GuideLines.apply(this,arguments),this.paint=function(t,r){null==i&&(i=c("path"),t.connector.svg.appendChild(i),o.attachListeners(i,t.connector),o.attachListeners(i,o),e=c("path"),t.connector.svg.appendChild(e),o.attachListeners(e,t.connector),o.attachListeners(e,o),n=c("path"),t.connector.svg.appendChild(n),o.attachListeners(n,t.connector),o.attachListeners(n,o));var l=[0,0];r.xmin<0&&(l[0]=-r.xmin),r.ymin<0&&(l[1]=-r.ymin),a(i,{d:s(t.head,t.tail),stroke:"red",fill:null,transform:"translate("+l[0]+","+l[1]+")"}),a(e,{d:s(t.tailLine[0],t.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+l[0]+","+l[1]+")"}),a(n,{d:s(t.headLine[0],t.headLine[1]),stroke:"green",fill:null,transform:"translate("+l[0]+","+l[1]+")"})};var s=function(t,e){return"M "+t.x+","+t.y+" L"+e.x+","+e.y}},e.extend(t.Overlays.svg.GuideLines,t.Overlays.GuideLines)}.call(this),function(){"use strict";var t=this.jsPlumb,e=this.jsPlumbUtil,n=function(t,e){if("transparent"===t)return t;var n,i=t,o=function(t){return 1==(e=Number(t).toString(16)).length?"0"+e:e;var e},s=/(rgb[a]?\()(.*)(\))/;if(t.match(s)){var r=t.match(s)[2].split(",");i="#"+o(r[0])+o(r[1])+o(r[2]),e||4!=r.length||(i+=(n=r[3],o(parseInt(255*n,10))))}return i},i={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},o=null;if(document.createStyleSheet&&document.namespaces){var s=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"];o=document.createStyleSheet();for(var r=0;r<s.length;r++)o.addRule(s[r],"behavior:url(#default#VML);position:absolute;");document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}t.vml={};var l=1e3,a=function(t,e){for(var n in e)t[n]=e[n]},c=function(t,e,n,i,o,s){n=n||{};var r=document.createElement("jsplumb:"+t);return s?o.appendElement(r,i):i.appendChild(r),r.className=(n.class?n.class+" ":"")+"jsplumb_vml",u(r,e),a(r,n),r},u=function(t,e,n){t.style.left=e[0]+"px",t.style.top=e[1]+"px",t.style.width=e[2]+"px",t.style.height=e[3]+"px",t.style.position="absolute",n&&(t.style.zIndex=n)},h=t.vml.convertValue=function(t){return Math.floor(t*l)},d=function(t,e,n,i){"transparent"===e?i.setOpacity(n,"0.0"):i.setOpacity(n,"1.0")},p=function(t,e,i,o){var s={};if(e.strokeStyle){s.stroked="true";var r=n(e.strokeStyle,!0);s.strokecolor=r,d(0,r,"stroke",i),s.strokeweight=e.lineWidth+"px"}else s.stroked="false";if(e.fillStyle){s.filled="true";var l=n(e.fillStyle,!0);s.fillcolor=l,d(0,l,"fill",i)}else s.filled="false";if(e.dashstyle)null==i.strokeNode?i.strokeNode=c("stroke",[0,0,0,0],{dashstyle:e.dashstyle},t,o):i.strokeNode.dashstyle=e.dashstyle;else if(e["stroke-dasharray"]&&e.lineWidth){for(var u=-1==e["stroke-dasharray"].indexOf(",")?" ":",",h=e["stroke-dasharray"].split(u),p="",f=0;f<h.length;f++)p+=Math.floor(h[f]/e.lineWidth)+u;null==i.strokeNode?i.strokeNode=c("stroke",[0,0,0,0],{dashstyle:p},t,o):i.strokeNode.dashstyle=p}a(t,s)},f=function(){var e=this;t.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(t){e.opacityNodes.stroke=c("stroke",[0,0,1,1],{opacity:"0.0"},t,e._jsPlumb.instance),e.opacityNodes.fill=c("fill",[0,0,1,1],{opacity:"0.0"},t,e._jsPlumb.instance)},this.setOpacity=function(t,n){var i=e.opacityNodes[t];i&&(i.opacity=""+n)};var n=[];this.getDisplayElements=function(){return n},this.appendDisplayElement=function(t,i){i||e.canvas.parentNode.appendChild(t),n.push(t)}};e.extend(f,t.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&this.bgCanvas.parentNode.removeChild(this.bgCanvas),this.canvas&&this.canvas.parentNode.removeChild(this.canvas)}});var m=t.ConnectorRenderers.vml=function(n,o){this.strokeNode=null,this.canvas=null,f.apply(this,arguments);var s=this._jsPlumb.instance.connectorClass+(n.cssClass?" "+n.cssClass:"");this.paint=function(r){if(null!==r){this.w=Math.max(this.w,1),this.h=Math.max(this.h,1);for(var h=this.getSegments(),d={path:""},f=[this.x,this.y,this.w,this.h],m=0;m<h.length;m++)d.path+=t.Segments.vml.SegmentRenderer.getPath(h[m]),d.path+=" ";if(r.outlineColor){var g=r.outlineWidth||1,b=r.lineWidth+2*g,v={strokeStyle:e.convertStyle(r.outlineColor),lineWidth:b};for(var y in i)v[y]=r[y];null==this.bgCanvas?(d.class=s,d.coordsize=f[2]*l+","+f[3]*l,this.bgCanvas=c("shape",f,d,n.parent,this._jsPlumb.instance,!0),u(this.bgCanvas,f),this.appendDisplayElement(this.bgCanvas,!0),this.initOpacityNodes(this.bgCanvas,["stroke"]),this.bgCanvas._jsPlumb=o):(d.coordsize=f[2]*l+","+f[3]*l,u(this.bgCanvas,f),a(this.bgCanvas,d)),p(this.bgCanvas,v,this)}null==this.canvas?(d.class=s,d.coordsize=f[2]*l+","+f[3]*l,this.canvas=c("shape",f,d,n.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(this.canvas,["stroke"]),this.canvas._jsPlumb=o):(d.coordsize=f[2]*l+","+f[3]*l,u(this.canvas,f),a(this.canvas,d)),p(this.canvas,r,this,this._jsPlumb.instance)}}};e.extend(m,f,{setVisible:function(t){this.canvas&&(this.canvas.style.display=t?"block":"none"),this.bgCanvas&&(this.bgCanvas.style.display=t?"block":"none")}});var g=t.VmlEndpoint=function(t){f.apply(this,arguments),this._jsPlumb.vml=null,this.canvas=document.createElement("div"),this.canvas.style.position="absolute",this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(t.cssClass?" "+t.cssClass:""),t._jsPlumb.appendElement(this.canvas,t.parent),this.paint=function(t,n){var i={},o=this._jsPlumb.vml;e.sizeElement(this.canvas,this.x,this.y,this.w,this.h),null==this._jsPlumb.vml?(i.class=this._jsPlumb.clazz,o=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],i,n,this.canvas,this._jsPlumb.instance),this.appendDisplayElement(o,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(o,["fill"])):(u(o,[0,0,this.w,this.h]),a(o,i)),p(o,t,this)}};e.extend(g,f),t.Segments.vml={SegmentRenderer:{getPath:function(t){return{Straight:function(t){var e=t.params;return"m"+h(e.x1)+","+h(e.y1)+" l"+h(e.x2)+","+h(e.y2)+" e"},Bezier:function(t){var e=t.params;return"m"+h(e.x1)+","+h(e.y1)+" c"+h(e.cp1x)+","+h(e.cp1y)+","+h(e.cp2x)+","+h(e.cp2y)+","+h(e.x2)+","+h(e.y2)+" e"},Arc:function(t){var e=t.params,n=Math.min(e.x1,e.x2),i=(Math.max(e.x1,e.x2),Math.min(e.y1,e.y2)),o=(Math.max(e.y1,e.y2),t.anticlockwise?1:0);return(t.anticlockwise?"at ":"wa ")+" "+function(){if(e.loopback)return"0,0,"+h(2*e.r)+","+h(2*e.r);var s=[null,[function(){return[n,i]},function(){return[n-e.r,i-e.r]}],[function(){return[n-e.r,i]},function(){return[n,i-e.r]}],[function(){return[n-e.r,i-e.r]},function(){return[n,i]}],[function(){return[n,i-e.r]},function(){return[n-e.r,i]}]][t.segment][o]();return h(s[0])+","+h(s[1])+","+h(s[0]+2*e.r)+","+h(s[1]+2*e.r)}()+","+h(e.x1)+","+h(e.y1)+","+h(e.x2)+","+h(e.y2)+" e"}}[t.type](t)}}},t.Endpoints.vml.Dot=function(){t.Endpoints.Dot.apply(this,arguments),g.apply(this,arguments),this.getVml=function(t,e,n,i,o){return c("oval",t,e,i,o)}},e.extend(t.Endpoints.vml.Dot,g),t.Endpoints.vml.Rectangle=function(){t.Endpoints.Rectangle.apply(this,arguments),g.apply(this,arguments),this.getVml=function(t,e,n,i,o){return c("rect",t,e,i,o)}},e.extend(t.Endpoints.vml.Rectangle,g),t.Endpoints.vml.Image=t.Endpoints.Image,t.Endpoints.vml.Blank=t.Endpoints.Blank,t.Overlays.vml.Label=t.Overlays.Label,t.Overlays.vml.Custom=t.Overlays.Custom;var b=function(t,n){t.apply(this,n),f.apply(this,n);var i=this;this.canvas=null,this.isAppendedAtTopLevel=!0,this.paint=function(t,o){if(t.component.canvas&&o){var s={},r=t.d,d=t.component;t.strokeStyle&&(s.stroked="true",s.strokecolor=e.convertStyle(t.strokeStyle,!0)),t.lineWidth&&(s.strokeweight=t.lineWidth+"px"),t.fillStyle&&(s.filled="true",s.fillcolor=t.fillStyle);var p=Math.min(r.hxy.x,r.tail[0].x,r.tail[1].x,r.cxy.x),f=Math.min(r.hxy.y,r.tail[0].y,r.tail[1].y,r.cxy.y),m=Math.max(r.hxy.x,r.tail[0].x,r.tail[1].x,r.cxy.x),g=Math.max(r.hxy.y,r.tail[0].y,r.tail[1].y,r.cxy.y),b=[p,f,Math.abs(m-p),Math.abs(g-f)];if(s.path=function(t){return"m "+h(t.hxy.x)+","+h(t.hxy.y)+" l "+h(t.tail[0].x)+","+h(t.tail[0].y)+" "+h(t.cxy.x)+","+h(t.cxy.y)+" "+h(t.tail[1].x)+","+h(t.tail[1].y)+" x e"}(r),s.coordsize=d.w*l+","+d.h*l,b[0]=d.x,b[1]=d.y,b[2]=d.w,b[3]=d.h,null==i.canvas){var v=d._jsPlumb.overlayClass||"",y=n&&1==n.length&&n[0].cssClass||"";s.class=y+" "+v,i.canvas=c("shape",b,s,d.canvas.parentNode,d._jsPlumb.instance,!0),d.appendDisplayElement(i.canvas,!0)}else u(i.canvas,b),a(i.canvas,s)}},this.cleanup=function(){null!=this.canvas&&this._jsPlumb.instance.removeElement(this.canvas)}};e.extend(b,[f,t.Overlays.AbstractOverlay],{setVisible:function(t){this.canvas.style.display=t?"block":"none"}}),t.Overlays.vml.Arrow=function(){b.apply(this,[t.Overlays.Arrow,arguments])},e.extend(t.Overlays.vml.Arrow,[t.Overlays.Arrow,b]),t.Overlays.vml.PlainArrow=function(){b.apply(this,[t.Overlays.PlainArrow,arguments])},e.extend(t.Overlays.vml.PlainArrow,[t.Overlays.PlainArrow,b]),t.Overlays.vml.Diamond=function(){b.apply(this,[t.Overlays.Diamond,arguments])},e.extend(t.Overlays.vml.Diamond,[t.Overlays.Diamond,b])}.call(this),function(){"use strict";var t,e,n=this,i=n.jsPlumb,o=n.jsPlumbUtil,s=n.Katavorio,r=n.Biltong,l=function(t,e){var n="_katavorio_"+(e=e||"main"),i=t[n],l=t.getEventManager();return i||(i=new s({bind:l.on,unbind:l.off,getSize:jsPlumb.getSize,getPosition:function(e){var n=t.getOffset(e);return[n.left,n.top]},setPosition:function(t,e){t.style.left=e[0]+"px",t.style.top=e[1]+"px"},addClass:jsPlumb.addClass,removeClass:jsPlumb.removeClass,intersects:r.intersects,indexOf:o.indexOf,css:{noSelect:t.dragSelectClass,droppable:"jsplumb-droppable",draggable:"jsplumb-draggable",drag:"jsplumb-drag",selected:"jsplumb-drag-selected",active:"jsplumb-drag-active",hover:"jsplumb-drag-hover"}}),t[n]=i,t.bind("zoom",i.setZoom)),i};i.extend(n.jsPlumbInstance.prototype,{animationSupported:!0,scopeChange:function(t,e,n,i,o){},getElement:function(t){return null==t?null:"string"==typeof(t="string"==typeof t?t:null!=t.length&&null==t.enctype?t[0]:t)?document.getElementById(t):t},removeElement:function(t){l(this).elementRemoved(t),this.getEventManager().remove(t)},doAnimate:function(t,e,n){n=n||{};var i=this.getOffset(t),s=function(t,e){var n=function(n){if(null!=e[n]){if(o.isString(e[n])){var i=e[n].match(/-=/)?-1:1,s=e[n].substring(2);return t[n]+i*s}return e[n]}return t[n]};return[n("left"),n("top")]}(i,e),r=s[0]-i.left,l=s[1]-i.top,a=n.duration||250,c=a/15,u=15/a*r,h=15/a*l,d=0,p=setInterval((function(){jsPlumb.setPosition(t,{left:i.left+u*(d+1),top:i.top+h*(d+1)}),null!=n.step&&n.step(),++d>=c&&(window.clearInterval(p),null!=n.complete&&n.complete())}),15)},destroyDraggable:function(t,e){l(this,e).destroyDraggable(t)},destroyDroppable:function(t,e){l(this,e).destroyDroppable(t)},initDraggable:function(t,e,n){l(this,n).draggable(t,e)},initDroppable:function(t,e,n){l(this,n).droppable(t,e)},isAlreadyDraggable:function(t){return null!=t._katavorioDrag},isDragSupported:function(t,e){return!0},isDropSupported:function(t,e){return!0},isElementDraggable:function(t){return(t=jsPlumb.getElement(t))._katavorioDrag&&t._katavorioDrag.isEnabled()},getDragObject:function(t){return t[0].drag.getDragElement()},getDragScope:function(t){return t._katavorioDrag&&t._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(t){return t[0].e},getDropScope:function(t){return t._katavorioDrop&&t._katavorioDrop.scopes.join(" ")||""},getUIPosition:function(t,e){return{left:t[0].pos[0],top:t[0].pos[1]}},setDragFilter:function(t,e,n){t._katavorioDrag&&t._katavorioDrag.setFilter(e,n)},setElementDraggable:function(t,e){(t=jsPlumb.getElement(t))._katavorioDrag&&t._katavorioDrag.setEnabled(e)},setDragScope:function(t,e){t._katavorioDrag&&t._katavorioDrag.k.setDragScope(t,e)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},animEvents:{step:"step",complete:"complete"},stopDrag:function(t){t._katavorioDrag&&t._katavorioDrag.abort()},addToDragSelection:function(t){l(this).select(t)},removeFromDragSelection:function(t){l(this).deselect(t)},clearDragSelection:function(){l(this).deselectAll()},getOriginalEvent:function(t){return t},trigger:function(t,e,n){this.getEventManager().trigger(t,e,n)},doReset:function(){for(var t in this)0===t.indexOf("_katavorio_")&&this[t].reset()}}),t=i.init,(e=function(){/complete|loaded|interactive/.test(document.readyState)&&void 0!==document.body&&null!=document.body?t():setTimeout(e,9)})()}.call(this)}).call(window)},"../node_modules/jquery-mousewheel/jquery.mousewheel.js":(t,e,n)=>{var i,o,s;o=[n("./bundles/oroui/js/extend/jquery.js")],void 0===(s="function"==typeof(i=function(t){var e,n,i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],s=Array.prototype.slice;if(t.event.fixHooks)for(var r=i.length;r;)t.event.fixHooks[i[--r]]=t.event.mouseHooks;var l=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=o.length;e;)this.addEventListener(o[--e],a,!1);else this.onmousewheel=a;t.data(this,"mousewheel-line-height",l.getLineHeight(this)),t.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=o.length;e;)this.removeEventListener(o[--e],a,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),i=n["offsetParent"in t.fn?"offsetParent":"parent"]();return i.length||(i=t("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function a(i){var o=i||window.event,r=s.call(arguments,1),a=0,h=0,d=0,p=0,f=0,m=0;if((i=t.event.fix(o)).type="mousewheel","detail"in o&&(d=-1*o.detail),"wheelDelta"in o&&(d=o.wheelDelta),"wheelDeltaY"in o&&(d=o.wheelDeltaY),"wheelDeltaX"in o&&(h=-1*o.wheelDeltaX),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(h=-1*d,d=0),a=0===d?h:d,"deltaY"in o&&(a=d=-1*o.deltaY),"deltaX"in o&&(h=o.deltaX,0===d&&(a=-1*h)),0!==d||0!==h){if(1===o.deltaMode){var g=t.data(this,"mousewheel-line-height");a*=g,d*=g,h*=g}else if(2===o.deltaMode){var b=t.data(this,"mousewheel-page-height");a*=b,d*=b,h*=b}if(p=Math.max(Math.abs(d),Math.abs(h)),(!n||p<n)&&(n=p,u(o,p)&&(n/=40)),u(o,p)&&(a/=40,h/=40,d/=40),a=Math[a>=1?"floor":"ceil"](a/n),h=Math[h>=1?"floor":"ceil"](h/n),d=Math[d>=1?"floor":"ceil"](d/n),l.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();f=i.clientX-v.left,m=i.clientY-v.top}return i.deltaX=h,i.deltaY=d,i.deltaFactor=n,i.offsetX=f,i.offsetY=m,i.deltaMode=0,r.unshift(i,a,h,d),e&&clearTimeout(e),e=setTimeout(c,200),(t.event.dispatch||t.event.handle).apply(this,r)}}function c(){n=null}function u(t,e){return l.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})?i.apply(e,o):i)||(t.exports=s)},"./bundles/oroui/js/app/components/history-navigation-component.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/components/base/component.js"),i=n("./bundles/oroui/js/app/models/base/stateful-model.js"),o=n("./bundles/oroui/js/app/views/history-navigation-view.js");return e.extend({history:null,observedModel:null,constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){if(t.observedModel instanceof i==0)throw new Error("Observed object should be instance of StatefulModel");this.observedModel=t.observedModel,this.historyView=new o({model:this.observedModel.history,el:t._sourceElement}),this.historyView.on("navigate",this.onHistoryNavigate,this)},onHistoryNavigate:function(t){const e=this.observedModel.history;if(e.setIndex(t)){const t=e.getCurrentState();this.observedModel.setState(t.get("data"))}}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/models/base/stateful-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/backbone.js"),o=n("./bundles/oroui/js/app/models/base/model.js"),s=n("./bundles/oroui/js/app/models/history-model.js"),r=n("./bundles/oroui/js/app/models/history-state-model.js"),l=o.extend({constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},initialize:function(t,n){const i={};l.__super__.initialize.call(this,t,n),"MAX_HISTORY_LENGTH"in this&&(i.maxLength=this.MAX_HISTORY_LENGTH),this.history=new s({},i),this.boundEvents=[],this.debouncedOnStateChange=e.debounce(this.onStateChange.bind(this),50),this.bindEvents()},destroy:function(){l.__super__.destroy.call(this),this.unbindEvents()},bindEvents:function(){"observedAttributes"in this?e.each(this.observedAttributes,(function(t){const e=this.get(t);if(e instanceof i.Collection){const n="change add remove";e.on(n,this.debouncedOnStateChange,this),this.on("change:"+t,(function(t,i){e.off(n,this.debouncedOnStateChange,this),i.on(n,this.debouncedOnStateChange,this)}),this)}else this.on("change:"+t,this.debouncedOnStateChange,this)}),this):this.on("change",this.debouncedOnStateChange,this)},unbindEvents:function(){"observedAttributes"in this?e.each(this.observedAttributes,(function(t){const e=this.get(t);e instanceof i.Collection?(e.off("change add remove",this.debouncedOnStateChange,this),this.off("change:"+t,null,this)):this.off("change:"+t,this.debouncedOnStateChange,this)}),this):this.off("change",this.debouncedOnStateChange,this)},onStateChange:function(){const t=new r({data:this.getState()});this.history.pushState(t)},getState:function(){throw new Error("Method getState should be defined in a inherited class.")},setState:function(){throw new Error("Method getState should be defined in a inherited class.")}});return l}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/models/history-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/app/models/base/model.js"),o=n("./bundles/oroui/js/app/models/history-state-collection.js");return i.extend({defaults:{states:null,index:-1},constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},initialize:function(t,n){this.options=e.defaults({},n,{maxLength:64}),this.set("states",new o),this.set("index",-1)},pushState:function(t){const e=this.get("states"),n=this.get("index");e.length>n+1&&e.reset(e.first(n+1)),e.length>=this.options.maxLength&&e.reset(e.last(this.options.maxLength-1)),e.add(t),this.set("index",e.length-1)},getCurrentState:function(){return this.get("states").at(this.get("index"))},setIndex:function(t){if(t>=0&&t<this.get("states").length)return this.set("index",t),!0}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/models/history-state-collection.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/models/history-state-model.js");return n("./bundles/oroui/js/app/models/base/collection.js").extend({model:e,constructor:function t(...e){t.__super__.constructor.apply(this,e)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/models/history-state-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";return n("./bundles/oroui/js/app/models/base/model.js").extend({constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},defaults:function(){return{data:{}}}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/models/zoom-state-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";function e(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}const i=n("./bundles/oroui/js/app/models/base/model.js").extend({defaults:function(){return{zoom:1,zoomSpeed:1.1,minZoom:.01,maxZoom:100,dx:0,dy:0,autoZoomPadding:50}},constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},initialize:function(t,e){if(i.__super__.initialize.call(this,t,e),!e.wrapper||!e.inner)throw new Error("ZoomStateModel requires wrapper and inner options to be passed");this.wrapper=e.wrapper,this.inner=e.inner},getCenter:function(){return{x:this.wrapper.clientWidth/2+this.get("dx"),y:this.wrapper.clientHeight/2+this.get("dy")}},zoomIn:function(t,e){this.setZoom(this.get("zoom")*this.get("zoomSpeed"),t,e)},zoomOut:function(t,e){this.setZoom(this.get("zoom")/this.get("zoomSpeed"),t,e)},getPosition:function(t){let n={left:t.offsetLeft,top:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight};const i=getComputedStyle(t);try{if(i.transform&&"none"!==i.transform){const t=i.transform.replace("matrix(","").replace(")","").split(" ").map((function(t){return t.trim()})).map(parseFloat),o=i.transformOrigin.split(" ").map(parseFloat),s=[n.left+o[0],n.top+o[1]],r=e([s[0]-n.left,s[1]-n.top],t),l=e([s[0]-n.left,s[1]-n.top-n.height],t),a=e([s[0]-n.left-n.width,s[1]-n.top],t),c=e([s[0]-n.left-n.width,s[1]-n.top-n.height],t),u=Math.min(r[0],l[0],a[0],c[0]),h=Math.max(r[0],l[0],a[0],c[0]),d=Math.min(r[1],l[1],a[1],c[1]),p=Math.max(r[1],l[1],a[1],c[1]);n={left:u+s[0],top:d+s[1],width:h-u,height:p-d}}}catch(t){}return n},autoZoom:function(){const t=this.inner;let e=1/0,n=-1/0,i=1/0,o=-1/0;for(let s=0;s<t.children.length;s++){const r=t.children[s];if(0===r.offsetHeight||0===r.offsetWidth)continue;const l=this.getPosition(r);e>l.left&&(e=l.left),n<l.left+l.width&&(n=l.left+l.width),i>l.top&&(i=l.top),o<l.top+l.height&&(o=l.top+l.height)}const s=Math.min(1,(this.wrapper.clientWidth-2*this.get("autoZoomPadding"))/(n-e),(this.wrapper.clientHeight-2*this.get("autoZoomPadding"))/(o-i)),r=this.wrapper.clientWidth/2,l=this.wrapper.clientHeight/2;e=s*(e-r),n=s*(n-r),i=s*(i-l),o=s*(o-l);const a=(e+n)/2,c=(i+o)/2;this.set({zoom:s,dx:-a,dy:-c+this.get("autoZoomPadding")*(1-s)})},setZoom:function(t,e,n){void 0===e&&(e=this.getCenter().x),void 0===n&&(n=this.getCenter().y);const i=t/this.get("zoom"),o=this.getCenter();t=Math.min(t,this.get("maxZoom")),t=Math.max(t,this.get("minZoom")),this.set({dx:this.get("dx")-(o.x-e)*(1-i),dy:this.get("dy")-(o.y-n)*(1-i),zoom:t})},move:function(t,e){this.set({dx:this.get("dx")+t,dy:this.get("dy")+e})}});return i}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/views/history-navigation-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";return n("./bundles/oroui/js/app/views/base/view.js").extend({autoRender:!0,template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroui/templates/history.html"),events:{"click .undo-btn":"onUndo","click .redo-btn":"onRedo"},listen:{"change:index model":"render"},constructor:function t(e){t.__super__.constructor.call(this,e)},onUndo:function(){const t=this.model.get("index");this.trigger("navigate",t-1)},onRedo:function(){const t=this.model.get("index");this.trigger("navigate",t+1)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/views/zoom-controls-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroui/js/extend/jquery.js");return e.extend({autoRender:!0,template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroui/templates/zoom-controls.html"),events:{"click .btn-zoom-in":"onZoomInClick","click .btn-zoom-out":"onZoomOutClick","click .btn-auto-zoom":"onAutoZoomClick","click .btn-set-zoom":"onSetZoomClick"},listen:{"change model":"render"},constructor:function t(e){t.__super__.constructor.call(this,e)},onZoomInClick:function(t){t.preventDefault(),this.model.zoomIn()},onZoomOutClick:function(t){t.preventDefault(),this.model.zoomOut()},onAutoZoomClick:function(t){t.preventDefault(),this.model.autoZoom()},onSetZoomClick:function(t){t.preventDefault(),this.model.setZoom(parseFloat(i(t.currentTarget).attr("data-size"))/100)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroui/js/app/views/zoomable-area-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/extend/underscore.js"),s=n("./bundles/orotranslation/js/translator.js"),r=n("./bundles/oroui/js/app/models/zoom-state-model.js"),l=n("./bundles/oroui/js/app/views/zoom-controls-view.js");n("../node_modules/jquery-mousewheel/jquery.mousewheel.js");const a=e.extend({autoRender:!0,listen:{"change model":"render","change:zoom model":"notifyChangeZoom"},events:{mousewheel:"onMouseWheel",mousedown:"onMouseDown",zoomin:"onZoomIn",zoomout:"onZoomOut",autozoom:"onZoomAuto"},scrollHintContainerClass:"zoom-scroll-hint",scrollHintLabel:"oro.ui.zoom.scroll_hint",scrollHintTemplate:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroui/templates/zoom-scroll-hint.html"),scrollHintDelay:1e3,constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){if(o.extend(this,o.pick(t,"scrollHintContainerClass","scrollHintLabel","scrollHintDelay")),a.__super__.initialize.call(this,t),this.$zoomedElement=this.$el.find(">*:first"),!this.model){const e={zoomLevel:1,dx:0,dy:0};o.extend(e,o.pick(t,"minZoom","maxZoom")),this.model=new r(e,{wrapper:this.el,inner:this.$zoomedElement[0]})}this.$el.addClass("zoomable-area"),t.autozoom&&this.model.autoZoom()},dispose:function(){this.disposed||(this.hideScrollHint(),a.__super__.dispose.call(this))},showScrollHint:function(){this.scrollHintTimeoutId?clearTimeout(this.scrollHintTimeoutId):this.$el.append(this.scrollHintTemplate({containerClass:this.scrollHintContainerClass,label:s(this.scrollHintLabel)})),this.scrollHintTimeoutId=setTimeout(this.hideScrollHint.bind(this),this.scrollHintDelay)},hideScrollHint:function(){this.scrollHintTimeoutId&&(clearTimeout(this.scrollHintTimeoutId),delete this.scrollHintTimeoutId,this.$el.find("."+this.scrollHintContainerClass).remove())},onMouseWheel:function(t,e,n,i){if(t.ctrlKey||t.altKey||t.metaKey){t.preventDefault(),this.hideScrollHint();const e=this.el.getBoundingClientRect(),n=t.clientX-e.left,o=t.clientY-e.top;i>0?this.model.zoomIn(n,o):this.model.zoomOut(n,o)}else this.showScrollHint()},onMouseDown:function(t){let e={x:t.originalEvent.screenX,y:t.originalEvent.screenY};const n=t=>(this.model.move(t.screenX-e.x,t.screenY-e.y),e={x:t.screenX,y:t.screenY},!1),o=()=>(i(document.body).removeClass("force-grabbed-cursor"),removeEventListener("mousemove",n,!0),removeEventListener("mouseup",o,!0),!1);i(document.body).addClass("force-grabbed-cursor"),addEventListener("mousemove",n,!0),addEventListener("mouseup",o,!0)},notifyChangeZoom:function(){i(document).trigger("zoomchange",{el:this.el,zoom:this.model.get("zoom")})},onZoomIn:function(){this.model.zoomIn()},onZoomOut:function(){this.model.zoomOut()},onZoomAuto:function(){this.model.autoZoom()},render:function(){if(!1!==this.controls&&!this.subview("controls")){const t=i('<div class="zoom-controls"></div>');this.subview("controls",new l({el:t,model:this.model})),this.$el.prepend(t)}this.$zoomedElement.css({transform:"translate("+this.model.get("dx")+"px, "+this.model.get("dy")+"px) scale("+this.model.get("zoom")+", "+this.model.get("zoom")+")"})}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/activation-handler.js":(t,e,n)=>{var i,o;i=[n("./bundles/orotranslation/js/translator.js"),n("./bundles/fosjsrouting/js/router.js"),n("./bundles/orowindows/js/widget/dialog-widget.js")],void 0===(o=function(t,e,n){"use strict";return function(i,o,s){const r=this,l=new n({title:t("oro.workflow.workflowdefinition.activate",{label:s}),url:e.generate("oro_workflow_definition_activate_from_widget",{name:o}),stateEnabled:!1,incrementalPosition:!1,loadingMaskEnabled:!0,dialogOptions:{modal:!0,resizable:!0,width:500,autoResize:!0}});l.on("formSave",(function(t){r.trigger("activation_success",t)})),l.render()}}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/app/components/activate-form-widget-component.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/orotranslation/js/translator.js"),o=n("./bundles/oroui/js/app/components/base/component.js"),s=n("./bundles/oroui/js/mediator.js"),r=n("./bundles/oroui/js/widget/widget-manager.js");return o.extend({options:{_wid:"",success:!1,deactivated:null,selectors:{form:null},buttonName:"activate",error:null},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options),r.getWidgetInstance(this.options._wid,(t=>{if(this.options.success){s.trigger("widget_success:"+t.getAlias()),s.trigger("widget_success:"+t.getWid());let n={message:i("oro.workflow.activated")};e.isEmpty(this.options.deactivated)||(n=e.extend(n,{deactivatedMessage:i("oro.workflow.deactivated_list")+e.escape(this.options.deactivated)})),t.trigger("formSave",n),t.remove()}else this.options.error&&s.execute("showMessage","error",this.options.error),t.getAction(this.options.buttonName,"adopted",(t=>{t.on("click",this.onClick.bind(this))}))}))},onClick:function(){this.options._sourceElement.find(this.options.selectors.form).trigger("submit")}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/components/button-component.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/components/base/component.js"),i=n("./bundles/oroworkflow/js/transition-handler.js"),o=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/orotranslation/js/translator.js"),r=n("./bundles/oroui/js/mediator.js"),l=e.extend({options:{displayType:""},$button:null,constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){l.__super__.initialize.call(this,t),this.options=t||{},this.$button=o(this.options._sourceElement),this._processButton()},_processButton:function(){const t=this;this.$button.data("enabled")?"dialog"===this.options.displayType?(this.$button.data("executor",(function(){i.call(t.$button)})),this.$button.on("click",(function(e){e.preventDefault(),t._onClickButtonExecutor(this)}))):this.$button.on("click",(function(e){e.preventDefault(),t._onClickButtonRedirect(this)})):(this.$button.on("click",(function(t){t.preventDefault()})),this.$button.data("transition-condition-messages")&&this.$button.popover({html:!0,placement:"bottom",container:"body",trigger:"hover",title:'<i class="fa-exclamation-circle"></i>'+s("Unmet conditions"),content:this.$button.data("transition-condition-messages")}))},_onClickButtonExecutor:function(t){o(t).data("executor").call()},_onClickButtonRedirect:function(t){r.execute("redirectTo",{url:this.$button.data("transition-url")},{redirect:!0})},dispose:function(){this.disposed||(this.$button.off(),this.$button.data("disposed",!0),l.__super__.dispose.call(this))}});return l}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/components/workflow-editor-component.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/app/components/workflow-viewer-component.js"),i=n("./bundles/oroui/js/app/components/history-navigation-component.js"),o=n("./bundles/oroworkflow/js/app/views/flowchart/editor/workflow-view.js"),s=n("./bundles/oroui/js/mediator.js"),r=n("./bundles/oroui/js/extend/jquery.js"),l=n("./bundles/oroui/js/extend/underscore.js"),a=n("./bundles/orotranslation/js/translator.js"),c=n("./bundles/oroui/js/messenger.js"),u=n("./bundles/fosjsrouting/js/router.js"),h=n("./bundles/oroworkflow/js/tools/workflow-helper.js"),d=n("./bundles/oroworkflow/js/app/views/workflow-management-view.js"),p=n("./bundles/oroworkflow/js/app/models/transition-model.js"),f=n("./bundles/oroworkflow/js/app/views/transition/transition-edit-view.js"),m=n("./bundles/oroworkflow/js/app/views/step/step-edit-view.js"),g=n("./bundles/oroworkflow/js/app/models/step-model.js"),b=n("./bundles/oroworkflow/js/tools/workflow-model-factory.js"),v=n("./bundles/oroentity/js/app/services/entity-structure-data-provider.js"),y=n("./bundles/oroui/js/delete-confirmation.js"),w=e.extend({FlowchartWorkflowView:o,listen:{"requestAddTransition model":"addNewStepTransition","requestAddStep model":"addNewStep","requestRefreshChart model":"refreshChart","requestEditStep model":"openManageStepForm","requestCloneStep model":"cloneStep","requestRemoveStep model":"removeStep","requestRemoveTransition model":"removeTransition","requestCloneTransition model":"cloneTransition","requestEditTransition model":"openManageTransitionForm","change:entity model":"onEntityChange","saveWorkflow model":"saveConfiguration"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){const e={filterPreset:"workflow"},n=l.result(t,"entity");n&&(e.rootEntity=l.result(n,"entity"));const o=v.createDataProvider(e,this).then(function(e){this.entityFieldsProvider=e,this.initManagementView(t._sourceElement)}.bind(this));this._initPromises.push(o),w.__super__.initialize.call(this,t),this.historyManager=new i({observedModel:this.model,_sourceElement:t._sourceElement.find(".workflow-history-container")})},initManagementView:function(t){this.workflowManagementView=new d({autoRender:!0,el:t,stepsEl:".workflow-definition-steps-list-container",model:this.model,entityFieldsProvider:this.entityFieldsProvider})},refreshChart:function(){this.flowchartContainerView&&this.flowchartContainerView.refresh()},addNewStepTransition:function(t,e){const n=new p;this.openManageTransitionForm(n,t,e)},openManageTransitionForm:function(t,e,n){1!==this.model.get("steps").length?this.workflowManagementView.isEntitySelected()?new f({autoRender:!0,model:t,workflow:this.model,entityFieldsProvider:this.entityFieldsProvider,step_from:e,step_to:n,entity:this.workflowManagementView.getEntitySelectValue(),workflowContainer:this.workflowManagementView.$el}).on("transitionAdd",this.addTransition,this):this._showModalMessage(a("Related entity must be selected to add transition."),a("Warning")):this._showModalMessage(a("At least one step should be added to add transition."),a("Warning"))},openManageStepForm:function(t){if(!this.workflowManagementView.isEntitySelected())return void this._showModalMessage(a("Related entity must be selected to add step."),a("Warning"));const e=new m({model:t,workflow:this.model,workflowContainer:this.workflowManagementView.$el});e.on("stepAdd",this.addStep,this),e.render()},addStep:function(t){this.model.get("steps").get(t.cid)||this.model.get("steps").add(t)},cloneStep:function(t){const e=this.model.cloneStep(t,!0);this.openManageStepForm(e)},removeStep:function(t){this._removeHandler(t,a("Are you sure you want to delete this step?"))},_showModalMessage:function(t,e,n){new y({title:e||"",content:t,okText:n||a("OK"),allowCancel:!1}).open()},_removeHandler:function(t,e){const n=new y({content:e});n.on("ok",(function(){t.destroy()})),n.open()},onEntityChange:function(t,e){this.entityFieldsProvider.setRootEntityClassName(e),this.resetWorkflow()},resetWorkflow:function(){const t=function(t){if(t.length)for(let e=t.length-1;e>-1;e--)t.at(e).destroy()};this.model.set("start_step",null),t(this.model.get("attributes")),t(this.model.get("steps")),t(this.model.get("transition_definitions")),t(this.model.get("transitions")),b.addStartingStep(this.model)},_getStartingStep:function(){return this.model.getStepByName("step:starting_point")},saveConfiguration:function(t){if(t.preventDefault(),!this.workflowManagementView.valid())return;const e=h.getFormData(this.workflowManagementView.$el);e.steps_display_ordered=e.hasOwnProperty("steps_display_ordered"),this.model.get("name")||this.model.set("name",h.getNameByString(e.label,"workflow_")),this.model.set("label",e.label),this.model.set("steps_display_ordered",e.steps_display_ordered),this.model.set("entity",e.related_entity),this.model.set("start_step",e.start_step),this.model.set("exclusive_active_groups",e.exclusive_active_groups),this.model.set("exclusive_record_groups",e.exclusive_record_groups),this.validateWorkflow()&&(s.execute("showLoading"),this.model.save(null,{success:()=>{s.execute("hideLoading");let t="";const e=this.model.get("name");t=this.workflowManagementView.submitActor&&!r(this.workflowManagementView.submitActor).is('[data-action="save_and_stay"]')?u.generate("oro_workflow_definition_view",{name:e}):u.generate("oro_workflow_definition_update",{name:e}),s.once("page:afterChange",(function(){c.notificationFlashMessage("success",a("Workflow saved."))})),s.execute("redirectTo",{url:t},{redirect:!0})},errorHandlerMessage:(t,e)=>{let n=a("Could not save workflow.");return e.responseJSON&&e.responseJSON.error&&(n=e.responseJSON.error),n},error:(t,e)=>{s.execute("hideLoading")}}))},validateWorkflow:function(){return this.model.get("label")?this.model.get("entity")?this.model.get("steps").length<=1||0===this.model.get("transitions").length?(c.notificationFlashMessage("error",a("Could not save workflow. Please add at least one step and one transition.")),!1):!(!this.model.get("start_step")&&l.isEmpty(this._getStartingStep().get("allowed_transitions"))&&(c.notificationFlashMessage("error",a("Could not save workflow. Please either set default step or add transitions to starting point.")),1)):(c.notificationFlashMessage("error",a("Could not save workflow. Please set related entity.")),!1):(c.notificationFlashMessage("error",a("Could not save workflow. Please set workflow name.")),!1)},cloneTransition:function(t,e){const n=this.model.cloneTransition(t,!0);this.openManageTransitionForm(n,e)},addTransition:function(t,e){this.model.get("transitions").get(t.cid)||(l.isString(e)&&(e=this.model.getStepByName(e)),t.set("is_start",e.get("_is_start")),this.model.get("transitions").add(t),e.getAllowedTransitions(this.model).add(t),e.trigger("change",e,{}))},addNewStep:function(){const t=new g;this.openManageStepForm(t)},removeTransition:function(t){this._removeHandler(t,a("Are you sure you want to delete this transition?"))}});return w}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/components/workflow-viewer-component.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/app/components/base/component.js"),s=n("./bundles/oroworkflow/js/tools/workflow-model-factory.js"),r=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/workflow-view.js"),l=n("./bundles/oroworkflow/js/app/models/flowchart-state-model.js"),a=o.extend({FlowchartWorkflowView:r,_initPromises:null,constructor:function t(e){this._initPromises=[],t.__super__.constructor.call(this,e)},initialize:function(t){a.__super__.initialize.call(this,t),this.model=s.createWorkflowModel(t);const n=t._subPromises["flowchart-container"];if(n){this._initPromises.push(n),this.flowchartState=new l;const i=e.extend({model:this.model,flowchartState:this.flowchartState,chartOptions:{},connectionOptions:{}},e.pick(t,"connectionOptions","chartOptions"));n.then(function(t){this.flowchartContainerView=t.view,this.flowchartContainerView.createFlowchartView(this.FlowchartWorkflowView,i)}.bind(this))}this._initPromises.length&&(this._deferredInit(),i.when(...this._initPromises).then(function(){delete this._initPromises,this._resolveDeferredInit()}.bind(this)))},dispose:function(){this.disposed||(delete this.flowchartContainerView,a.__super__.dispose.call(this))}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/attribute-collection.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/models/base/collection.js"),i=n("./bundles/oroworkflow/js/app/models/attribute-model.js");return e.extend({model:i,constructor:function t(...e){t.__super__.constructor.apply(this,e)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/attribute-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";return n("./bundles/oroui/js/app/models/base/model.js").extend({defaults:{name:null,label:null,translated_label:null,type:null,property_path:null,options:null,translateLinks:[]},constructor:function t(...e){t.__super__.constructor.apply(this,e)},initialize:function(){null===this.get("options")&&this.set("options",{})}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/flowchart-state-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";return n("./bundles/oroui/js/app/models/base/model.js").extend({defaults:{transitionLabelsVisible:!0},constructor:function t(...e){t.__super__.constructor.apply(this,e)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/step-collection.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/models/base/collection.js"),i=n("./bundles/oroworkflow/js/app/models/step-model.js");return e.extend({model:i,comparator:"order",constructor:function t(...e){t.__super__.constructor.apply(this,e)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/step-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroworkflow/js/app/models/transition-collection.js"),o=n("./bundles/oroui/js/app/models/base/model.js").extend({defaults:{name:null,label:null,is_final:!1,order:0,allowed_transitions:null,_is_start:!1,_is_clone:!1,translateLinks:[]},constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},initialize:function(){this.workflow=null,this.allowedTransitions=null,null===this.get("allowed_transitions")&&this.set("allowed_transitions",[])},setWorkflow:function(t){this.workflow=t},getAllowedTransitions:function(t){if(t||(t=this.workflow),null===this.allowedTransitions){const n=this.get("allowed_transitions");this.allowedTransitions=new i,e.isArray(n)&&e.each(n,(function(e){this.allowedTransitions.add(t.getTransitionByName(e))}),this);const o=t=>{const i=t.get("name");-1===e.indexOf(n,i)&&this.get("allowed_transitions").push(i)};this.listenTo(this.allowedTransitions,"add",o),this.listenTo(this.allowedTransitions,"reset",(t=>{this.set("allowed_transitions",[]),e.each(t.models,o)})),this.listenTo(this.allowedTransitions,"remove",(t=>{const n=t.get("name");this.set("allowed_transitions",e.without(this.get("allowed_transitions"),n))}))}return this.allowedTransitions},destroy:function(t){if(this.workflow){const t=function(t){if(t.length)for(let e=t.length-1;e>-1;e--)t[e].destroy()};t(this.getAllowedTransitions(this.workflow).models),t(this.workflow.get("transitions").where({step_to:this.get("name")}))}o.__super__.destroy.call(this,t)}});return o}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/transition-collection.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/models/base/collection.js"),i=n("./bundles/oroworkflow/js/app/models/transition-model.js");return e.extend({model:i,constructor:function t(...e){t.__super__.constructor.apply(this,e)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/transition-definition-collection.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/models/base/collection.js"),i=n("./bundles/oroworkflow/js/app/models/transition-definition-model.js");return e.extend({model:i,constructor:function t(...e){t.__super__.constructor.apply(this,e)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/transition-definition-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";return n("./bundles/oroui/js/app/models/base/model.js").extend({defaults:{name:null,preactions:null,preconditions:null,conditions:null,actions:null},constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},initialize:function(){null===this.get("preactions")&&this.set("preactions",{}),null===this.get("preconditions")&&this.set("preconditions",{}),null===this.get("conditions")&&this.set("conditions",{}),null===this.get("actions")&&this.set("actions",[])}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/transition-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/app/models/base/model.js").extend({defaults:{name:null,label:null,button_label:null,button_title:null,display_type:"dialog",destination_page:"",step_to:null,is_start:!1,form_options:null,message:null,is_unavailable_hidden:!0,transition_definition:null,_is_clone:!1,translateLinks:[]},constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},initialize:function(){this.workflow=null,e.isEmpty(this.get("form_options"))&&this.set("form_options",{attribute_fields:{}}),e.isEmpty(this.get("form_options").attribute_fields)&&(this.get("form_options").attribute_fields={})},setWorkflow:function(t){this.workflow=t},getTransitionDefinition:function(){return this.workflow?this.workflow.getTransitionDefinitionByName(this.get("transition_definition")):null},destroy:function(t){const e=this.getTransitionDefinition();e&&e.destroy(),i.__super__.destroy.call(this,t)}});return i}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/models/workflow-model.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/orotranslation/js/translator.js"),o=n("./bundles/oroui/js/app/models/base/stateful-model.js"),s=n("./bundles/oroworkflow/js/tools/workflow-helper.js"),r=n("./bundles/oroworkflow/js/app/models/step-collection.js"),l=n("./bundles/oroworkflow/js/app/models/transition-collection.js"),a=n("./bundles/oroworkflow/js/app/models/transition-definition-collection.js"),c=n("./bundles/oroworkflow/js/app/models/attribute-collection.js"),u=n("./bundles/oroworkflow/js/app/models/step-model.js"),h=n("./bundles/oroworkflow/js/app/models/transition-model.js"),d=n("./bundles/oroworkflow/js/app/models/transition-definition-model.js"),p=n("./bundles/oroworkflow/js/app/models/attribute-model.js"),f=o.extend({defaults:{name:"",label:"",entity:"",entity_attribute:"entity",start_step:null,steps_display_ordered:!1,steps:null,transitions:null,transition_definitions:null,attributes:null,translateLinkLabel:null,priority:0,exclusive_active_groups:[],exclusive_record_groups:[],applications:[]},MAX_HISTORY_LENGTH:50,observedAttributes:["steps","transitions"],availableDestinations:{},positionIncrementPx:35,constructor:function t(e,n){t.__super__.constructor.call(this,e,n)},initialize:function(t,e){null===this.get("steps")&&this.set("steps",new r),null===this.get("transitions")&&this.set("transitions",new l),null===this.get("transition_definitions")&&this.set("transition_definitions",new a),null===this.get("attributes")&&this.set("attributes",new c);const n=this.get("steps"),i=this.get("transitions");this.setWorkflowToCollection(n),this.setWorkflowToCollection(i),this.listenTo(n,"add",this.setWorkflow),this.listenTo(i,"add",this.setWorkflow),this.listenTo(n,"reset",this.setWorkflowToCollection),this.listenTo(i,"reset",this.setWorkflowToCollection),f.__super__.initialize.call(this,t,e),this.getStartStep().length&&this.onStateChange()},setWorkflow:function(t){t.setWorkflow(this)},setWorkflowToCollection:function(t){t.each((function(t){t.setWorkflow(this)}),this)},cloneTransitionDefinition:function(t){e.isString(t)&&(t=this.getTransitionDefinitionByName(t));const n=this._getClonedItem(t),i=new d(n);return this.get("transition_definitions").add(i),i},cloneTransition:function(t,n){e.isString(t)&&(t=this.getTransitionByName(t));const o=this._getClonedItem(t);if(t.get("transition_definition")){const e=this.cloneTransitionDefinition(t.get("transition_definition"));o.transition_definition=e.get("name")}o.frontend_options=s.deepClone(o.frontend_options),o.form_options=s.deepClone(o.form_options),o.label=i("Copy of")+" "+o.label,n&&(o._is_clone=!0);const r=new h(o);return r.setWorkflow(this),n||this.get("transitions").add(r),r},cloneStep:function(t,n){e.isString(t)&&(t=this.getStepByName(t));const o=this._getClonedItem(t),s=[];e.each(t.getAllowedTransitions(this).models,(function(t){const e=this.cloneTransition(t);s.push(e.get("name"))}),this),o.allowed_transitions=s,o.label=i("Copy of")+" "+o.label,n&&(o._is_clone=!0),o.position&&(o.position=[o.position[0]+this.positionIncrementPx,o.position[1]+this.positionIncrementPx]);const r=new u(o);return r.setWorkflow(this),n||this.get("steps").add(r),r},_getClonedItem:function(t){const n=e.clone(t.toJSON());return n.name+="_clone_"+s.getRandomId(),n},getAvailableDestinations:function(){return this.availableDestinations},setAvailableDestinations:function(t){this.availableDestinations=t},getAttributeByPropertyPath:function(t){const e=this.get("entity_attribute")+"."+t;return this.get("attributes").findWhere({property_path:e})},ensureAttributeByPropertyPath:function(t){const e=this.get("entity_attribute")+"."+t;let n=this.get("attributes").findWhere({property_path:e});n||(n=new p({name:this.generateAttributeName(t),property_path:e}),this.get("attributes").add(n))},generateAttributeName:function(t){return(this.get("entity_attribute")+"."+t).replace(/\./g,"_")},getAttributeByName:function(t){return this._getByName("attributes",t)},getStepByName:function(t){return this._getByName("steps",t)},getStartStep:function(){return this.get("steps").where({_is_start:!0})},getTransitionByName:function(t){return this._getByName("transitions",t)},getTransitionDefinitionByName:function(t){return this._getByName("transition_definitions",t)},getStartTransitions:function(){return this.get("transitions").where({is_start:!0})},_getByName:function(t,e){return this.get(t).findWhere({name:e})},getState:function(){return{steps:this.get("steps").toJSON(),transitions:this.get("transitions").toJSON()}},setState:function(t){t.steps&&t.transitions&&(this.get("steps").reset(t.steps),this.get("transitions").reset(t.transitions))}});return f}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/attribute/attribute-form-option-edit-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/orotranslation/js/translator.js"),o=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/app/views/base/view.js"),r=n("./bundles/oroentity/js/app/views/field-choice-view.js"),l=n("./bundles/oroworkflow/js/tools/workflow-helper.js");return n("./bundles/oroform/js/extend/validate.js"),s.extend({attributes:{class:"widget-content"},options:{template:null,data:{label:"",property_path:"",property_path_text:"",required:!1},entity_field_template:null,entity:null,filterPreset:null,workflow:null,entityFieldsProvider:null},requiredOptions:["workflow","entityFieldsProvider"],constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){t=t||{};const n=this.requiredOptions.filter((function(n){return e.isUndefined(t[n])}));if(n.length)throw new TypeError("Missing required option(s): "+n.join(", "));this.options=e.defaults(t,this.options);const i=this.options.template||o("#attribute-form-option-edit-template").html();this.template=e.template(i),this.entity_field_template=this.options.entity_field_template||o("#entity-column-chain-template").html()},getFieldChoiceView:function(){return this.subview("field-choice")},onAdd:function(){const t=l.getFormData(this.form);t.property_path=this.options.entityFieldsProvider.getPropertyPathByPath(t.property_path),t.required=t.hasOwnProperty("required"),this.resetForm(),this.trigger("formOptionAdd",t)},resetForm:function(){this.subview("field-choice").setValue(""),this.form.find("[name=itemId]").val(""),this.form.get(0).reset(),this.submitBtn.html('<i class="fa-plus"></i> '+i("Add")),this.resetBtn.addClass("hide")},initFieldChoiceView:function(t){this.subview("field-choice",new r({autoRender:!0,el:t.find('[name="property_path"]'),entity:this.options.entity,filterPreset:this.options.filterPreset,allowSelectRelation:!0,select2:{placeholder:i("Choose field...")}}))},editRow:function(t){this.fieldSelectorEl.inputWidget("val",this.options.entityFieldsProvider.getPathByPropertyPathSafely(t.property_path)),this.form.find("[name=itemId]").val(t.itemId||""),this.labelEl.val(t.isSystemLabel?"":t.label),this.requiredEl.get(0).checked=t.required,this.submitBtn.html('<i class="fa-pencil-square-o"></i> '+i("Update")),this.resetBtn.removeClass("hide")},render:function(){return this._deferredRender(),this.form=o(this.template(this.options.data)).filter("form"),this.form.validate({submitHandler:this.onAdd.bind(this)}),this.form.on("submit",(function(t){t.preventDefault()})),this.initFieldChoiceView(this.form),this.submitBtn=this.form.find("[type=submit]"),this.resetBtn=this.form.find("[type=reset]"),this.fieldSelectorEl=this.form.find("[name=property_path]"),this.labelEl=this.form.find("[name=label]"),this.requiredEl=this.form.find("[name=required]"),this.resetBtn.click(this.resetForm.bind(this)),this.$el.append(this.form),this._resolveDeferredRender(),this}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/attribute/attribute-form-option-list-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroworkflow/js/app/views/attribute/attribute-form-option-row-view.js"),r=o.extend({options:{listElBodyEl:"tbody",template:null,fieldsChoiceView:null,workflow:null,entityFieldsProvider:null,items:[],entity_field_template:null},requiredOptions:["fieldsChoiceView","workflow","entityFieldsProvider"],constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){t=t||{};const n=this.requiredOptions.filter((function(n){return e.isUndefined(t[n])}));if(n.length)throw new TypeError("Missing required option(s): "+n.join(", "));this.options=e.defaults(t,this.options);const o=this.options.template||i("#attribute-form-option-list-template").html();this.template=e.template(o),this.rowViews={},this.$listElBody=null,this.entityFieldTemplate=e.template(this.options.entity_field_template||i("#entity-column-chain-template").html())},addAllItems:function(t){e.each(t,this.addItem,this)},initList:function(){if(!this.$listElBody){const t=i(this.template());this.$listElBody=t.find(this.options.listElBodyEl),this.$el.html(t)}},addItem:function(t){const n=this.getCollection(),i=this.options.entityFieldsProvider.getPathByPropertyPathSafely(t.property_path),o=this.options.fieldsChoiceView,r=this.options.entityFieldsProvider.validatePath(i);if(t.isSystemLabel=!t.label,i&&r)t.label||(t.label=e.result(e.last(o.splitFieldId(i)).field,"label")),t.entityField=o.formatChoice(i,this.entityFieldTemplate);else{if(!t.label&&t.attribute_name){const e=this.options.workflow.getAttributeByName(t.attribute_name);t.label=e.get("label")}r?t.entityField=t.property_path||t.attribute_name:(t.entityField=t.attribute_name,t.is_entity_attribute=null)}const l=t.itemId?e.findWhere(n,{itemId:t.itemId}):null;l?e.extend(l,t):(t.itemId=e.uniqueId(),n.push(t));let a=this.subview("row:"+t.itemId);a?a.update(t):(a=new s({data:t}),a.on("editFormOption",(function(t){this.trigger("editFormOption",t)}),this),a.on("removeFormOption",(function(t){const n=this.getCollection(),i=e.findWhere(n,{itemId:t.itemId});n.splice(n.indexOf(i),1),this.removeSubview("row:"+t.itemId)}),this),this.subview("row:"+t.itemId,a),this.initList(),this.$listElBody.append(a.render().$el))},getCollection:function(){return this.options.items},remove:function(){this.resetView(),r.__super__.remove.call(this)},resetView:function(){e.each(this.rowViews,(function(t){t.remove()})),this.rowViews={}},render:function(){return this.resetView(),this.getCollection().length?(this.initList(),this.addAllItems(this.getCollection())):(this.$el.empty(),this.$listElBody=null),this}});return r}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/attribute/attribute-form-option-row-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/orotranslation/js/translator.js"),s=n("./bundles/oroui/js/app/views/base/view.js"),r=n("./bundles/oroui/js/delete-confirmation.js");return s.extend({tagName:"tr",events:{"click .delete-form-option":"triggerRemove","click .edit-form-option":"triggerEdit"},options:{template:null,data:{label:null,property_path:null,required:!1}},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options);const n=this.options.template||i("#attribute-form-option-row-template").html();this.template=e.template(n)},update:function(t){this.options.data=t,this.render()},triggerEdit:function(t){t.preventDefault(),this.trigger("editFormOption",this.options.data)},triggerRemove:function(t){t.preventDefault();const e=new r({content:o("Are you sure you want to delete this field?")});e.on("ok",(()=>{this.trigger("removeFormOption",this.options.data)})),e.open()},getTemplateData:function(){return this.options.data}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/editor/step-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/step-view.js").extend({template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/editor/step.html"),className:function(){const t=[e.__super__.className.call(this)];return this.model.get("_is_start")||t.push("dropdown"),t.join(" ")},events:{dblclick:"triggerEditStep","click .jsplumb-source":"triggerAddStep","click .workflow-step-edit":"triggerEditStep","click .workflow-step-clone":"triggerCloneStep","click .workflow-step-delete":"triggerRemoveStep"},constructor:function t(e){t.__super__.constructor.call(this,e)},connect:function(){const t=this.areaView.jsPlumbInstance;!1!==this.model.get("draggable")&&t.draggable(this.$el,{start:function(e){t.eventBus.trigger("step:drag-start",e,this.model)}.bind(this),stop:function(e){this.model.set({position:e.pos}),t.eventBus.trigger("step:drag-stop",e,this.model)}.bind(this)}),e.__super__.connect.call(this)},triggerEditStep:function(t){t.preventDefault(),this.areaView.model.trigger("requestEditStep",this.model)},triggerRemoveStep:function(t){t.preventDefault(),this.areaView.model.trigger("requestRemoveStep",this.model)},triggerCloneStep:function(t){t.preventDefault(),this.areaView.model.trigger("requestCloneStep",this.model)},triggerAddStep:function(){this.areaView.model.trigger("requestAddTransition",this.model)},render:function(){e.__super__.render.call(this),this.$el.toggleClass("final-step",Boolean(this.model.get("is_final")))}});return e}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/editor/transition-overlay-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/transition-overlay-view.js").extend({template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/editor/transition.html"),className:function(){const t=[e.__super__.className.call(this)];return t.push("dropdown"),t.join(" ")},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.stepFrom=t.stepFrom,e.__super__.initialize.call(this,t)},events:{dblclick:"triggerEditTransition","click .workflow-step-edit":"triggerEditTransition","click .workflow-step-clone":"triggerCloneTransition","click .workflow-step-delete":"triggerDeleteTransition"},triggerDeleteTransition:function(t){t.preventDefault(),this.areaView.model.trigger("requestRemoveTransition",this.model)},triggerEditTransition:function(t){t.preventDefault(),this.areaView.model.trigger("requestEditTransition",this.model,this.stepFrom)},triggerCloneTransition:function(t){t.preventDefault(),this.areaView.model.trigger("requestCloneTransition",this.model,this.stepFrom)}});return e}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/editor/workflow-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/jquery.js"),i=n("./bundles/orotranslation/js/translator.js"),o=n("./bundles/oroui/js/mediator.js"),s=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/workflow-view.js"),r=n("./bundles/oroworkflow/js/app/views/flowchart/editor/transition-overlay-view.js"),l=n("./bundles/oroworkflow/js/app/views/flowchart/editor/step-view.js"),a=s.extend({isConnected:!1,transitionOverlayView:r,stepView:l,className:"workflow-flowchart-editor",constructor:function t(e){t.__super__.constructor.call(this,e)},defaultConnectionOptions:function(){return{detachable:!0}},connect:function(){a.__super__.connect.call(this),this.jsPlumbInstance.bind("connectionDrag",this.onConnectionDragStart.bind(this)),this.jsPlumbInstance.bind("connectionDragStop",this.onConnectionDragStop.bind(this)),this.jsPlumbInstance.bind("beforeDrop",this.onBeforeConnectionDrop.bind(this)),this.jsPlumbInstance.bind("beforeDetach",this.onBeforeConnectionDetach.bind(this))},onConnectionDragStart:function(t){e("#"+t.sourceId).addClass("connection-source"),this.$el.addClass("workflow-drag-connection")},onConnectionDragStop:function(t){e("#"+t.sourceId).removeClass("connection-source"),this.$el.removeClass("workflow-drag-connection")},onBeforeConnectionDrop:function(t){let e,n,s,r;const l=this.findStepModelByElement(t.connection.source),a=this.findStepModelByElement(t.connection.target);return t.connection.suspendedElement&&!a.get("_is_start")?(e=t.connection.overlayView.model,n=e.get("name"),s=this.model.get("steps").filter((function(t){return-1!==t.get("allowed_transitions").indexOf(n)})),a.get("name")!==e.get("step_to")&&e.set({step_to:a.get("name")}),-1===s.indexOf(l)&&(r=this.findStepModelByElement(t.connection.suspendedElement),l.getAllowedTransitions().add(e),r.getAllowedTransitions().remove(e),l.trigger("change",l,{}),r.trigger("change",r,{}))):a.get("_is_start")?o.execute("showFlashMessage","error",i("oro.workflow.error.cannot.set.step")):this.model.trigger("requestAddTransition",l,a),!1},isConnectionInDrag:function(t){return!t.endpoints[0].connections.length||!t.endpoints[1].connections.length},willConnectionChange:function(t){return t[t.suspendedElementType]!==t.suspendedElement},onBeforeConnectionDetach:function(t){return!this.isConnectionInDrag(t)||!!this.willConnectionChange(t)}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/flowchart-container-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/orotranslation/js/translator.js"),o=n("./bundles/oroui/js/error.js"),s=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/flowchart-control-view.js"),r=n("./bundles/oroui/js/app/views/zoomable-area-view.js"),l=n("./bundles/oroui/js/app/views/loading-mask-view.js"),a=n("./bundles/oroui/js/app/views/base/view.js"),c=n("./bundles/oroworkflow/js/tools/path-finder/complexity-error.js"),u=n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/flowchart-error-message.html"),h=a.extend({autoRender:!0,template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/flowchart-container.html"),zoomableDefaults:{autozoom:!0,minZoom:.05,maxZoom:5},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.zoomableOptions=e.defaults(e.result(t,"zoomableOptions",{}),this.zoomableDefaults),h.__super__.initialize.call(this,t)},createFlowchartView:function(t,n){this.subview("chart",new t(e.extend({autoRender:!0,el:this.$('[data-role="flowchart"]'),chartHandlers:{"smartline:compute-error":this.handleFlowchartComputeError.bind(this),"smartline:compute-success":this.handleFlowchartComputeSuccess.bind(this),"step:drag-start":function(){this._isUnderDragAction=!0}.bind(this),"step:drag-stop":function(){delete this._isUnderDragAction,this.trigger("step:drag-stop")}.bind(this)}},n))),this.subview("controls",new s({model:n.flowchartState,el:this.$('[data-role="flowchart-controls"]')})),this.subview("zoom",new r(e.extend({el:this.$('[data-role="flowchart-wrapper"]')},this.zoomableOptions)))},refresh:function(){const t=this.subview("chart");t&&t.jsPlumbManager.organizeBlocks();const e=this.subview("zoom");e&&e.model.autoZoom()},handleFlowchartComputeError:function(t){let e;this._isUnderComputeError||(this._isUnderComputeError=!0,t instanceof c?e={type:"info",message:i("oro.workflow.error.complexity")}:(e={type:"error",message:i("oro.workflow.error.unknown")},o.showErrorInConsole(t)),this._isUnderDragAction?this.listenToOnce(this,"step:drag-stop",this._showFlowchartError.bind(this,e)):this._showFlowchartError(e))},_showFlowchartError:function(t){this._isUnderComputeError&&(this.subview("loading",new l({container:this.$('[data-role="flowchart-container"]')})),this.subview("loading").show(),e.delay(function(){this.$('[data-role="flowchart-container"]').removeClass("fixed").addClass("failed"),this.$('[data-role="flowchart-error"]').html(u(t)),this.subview("loading").hide()}.bind(this),1e3))},handleFlowchartComputeSuccess:function(){this._isUnderComputeError&&(delete this._isUnderComputeError,this.$('[data-role="flowchart-container"]').is(".failed")&&(this.$('[data-role="flowchart-container"]').removeClass("failed").addClass("fixed"),this.$('[data-role="flowchart-error"]').html("")))}});return h}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/jsplumb/area-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/backbone.js"),o=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroworkflow/js/extend/jsplumb.js"),r=n("./bundles/oroworkflow/js/tools/jsplumb-manager.js"),l=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/base-view.js");n("./bundles/oroworkflow/js/tools/jsplumb-smartline.js");const a=l.extend({jsPlumbManager:null,jsPlumbInstance:null,connectionWidth:12,defaultsChartOptions:function(){return{detachable:!1,Endpoint:["Dot",{radius:3,cssClass:"workflow-transition-endpoint",hoverClass:"workflow-transition-endpoint-hover"}],PaintStyle:{strokeStyle:"#bababb",lineWidth:2,outlineColor:"transparent",outlineWidth:7},HoverPaintStyle:{strokeStyle:"#dba91e"},EndpointStyle:{fillStyle:"#bababb"},EndpointHoverStyle:{fillStyle:"#dba91e"},ConnectionOverlays:[["Arrow",{location:1,id:"arrow",length:10,width:12,foldback:1}]]}},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.defaultsChartOptions=e.extend(e.result(this,"defaultsChartOptions"),t.chartOptions||{}),this.flowchartState=t.flowchartState,e.extend(this,e.pick(t,"chartHandlers")),a.__super__.initialize.call(this,t)},dispose:function(){this.disposed||(delete this.chartHandlers,a.__super__.dispose.call(this))},delegateEvents:function(t){return a.__super__.delegateEvents.call(this,t),o(document).on("zoomchange"+this.eventNamespace(),this.onZoomChange.bind(this)),this},undelegateEvents:function(){return a.__super__.undelegateEvents.call(this),o(document).off(this.eventNamespace()),this},render:function(){return this.isConnected||this.isConnecting||(this.isConnecting=!0,this.connect(),this.isConnected=!0,delete this.isConnecting),this},connect:function(){const t=e.defaults({container:this.id()},this.defaultsChartOptions);this.jsPlumbInstance=s.getInstance(t),this.jsPlumbInstance.eventBus=Object.create(i.Events),this.chartHandlers&&this.listenTo(this.jsPlumbInstance.eventBus,this.chartHandlers),this.debouncedRepaintEverything=e.debounce(this.repaintEverything.bind(this),0),this.jsPlumbManager=new r(this.jsPlumbInstance,this.model);const n=this.model.get("steps").find((function(t){const n=t.get("position");return e.isArray(n)&&2===n.length}));e.isUndefined(n)&&this.jsPlumbManager.organizeBlocks()},repaintEverything:function(){this.isConnected&&this.jsPlumbInstance.repaintEverything()},onZoomChange:function(t,e){this.jsPlumbInstance.setZoom(e.zoom)}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/jsplumb/base-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js").extend({constructor:function t(e){t.__super__.constructor.call(this,e)},id:function(){return"jsplumb-"+this.cid},render:function(){return e.__super__.render.call(this),this.isConnected||this.isConnecting||(this.isConnecting=!0,this.connect(),this.isConnected=!0,delete this.isConnecting),this},connect:function(){},cleanup:function(){},dispose:function(){this.disposed||(this.cleanup(),e.__super__.dispose.call(this))}});return e}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/jsplumb/box-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/base-view.js"),i=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/area-view.js"),o=e.extend({areaView:null,className:function(){return"jsplumb-box"},isConnected:!1,listen:{"change model":"render","change:position model":"refreshPosition"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){if(!(t.areaView instanceof i))throw new Error("areaView options is required and must be a JsplumbAreaView");this.areaView=t.areaView,o.__super__.initialize.call(this,t),this.areaView.$el.append(this.$el)},connect:function(){this.model.get("position")?this.refreshPosition():this.model.set("position",this.areaView.jsPlumbManager.getPositionForNew())},refreshPosition:function(){this.$el.css({top:this.model.get("position")[1],left:this.model.get("position")[0]}),this.areaView.debouncedRepaintEverything()},cleanup:function(){this.areaView.jsPlumbInstance.detach(this.$el)}});return o}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/jsplumb/overlay-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/area-view.js"),o=e.extend({listen:{"change model":"render"},className:function(){return"jsplumb-overlay"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){if(!(t.areaView instanceof i))throw new Error("areaView options is required and must be a JsplumbAreaView");this.areaView=t.areaView,this.overlay=t.overlay,this.listenTo(this.areaView.flowchartState,"change:transitionLabelsVisible",this.onLabelsToggle),o.__super__.initialize.call(this,t)},onLabelsToggle:function(t){this.overlay.setVisible(t.get("transitionLabelsVisible"))}});return o}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/viewer/flowchart-control-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroui/js/extend/underscore.js");return e.extend({autoRender:!0,template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/controls.html"),events:{'change [name="toggle-transition-labels"]':function(t){this.model.set("transitionLabelsVisible",Boolean(i.result(t.currentTarget,"checked")))}},constructor:function t(e){t.__super__.constructor.call(this,e)}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/viewer/step-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/box-view.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/extend/underscore.js"),s=n("./bundles/oroui/js/mediator.js"),r=n("./bundles/orotranslation/js/translator.js"),l=e.extend({template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/viewer/step.html"),jsPlumbSource:null,jsPlumbTarget:null,className:function(){const t=[l.__super__.className.call(this)];return t.push("workflow-step"),this.model.get("_is_start")&&t.push("start-step"),this.model.get("is_final")&&t.push("final-step"),t.join(" ")},targetDefaults:{dropOptions:{hoverClass:"dragHover"},allowLoopback:!0},sourceDefaults:{filter:".jsplumb-source",connector:["Smartline",{cornerRadius:3,midpoint:.5}],maxConnections:100},constructor:function t(e){t.__super__.constructor.call(this,e)},updateStepMinWidth:function(){const t=this.el.id,e=this.jsPlumbSource.getConnections(),n=o.countBy(e,(function(e){return e.sourceId===t?"out":e.targetId===t?"in":"other"})),i=(Math.max(n.in?n.in:0,n.out?n.out:0)+1)*this.areaView.connectionWidth;this.$el.css({minWidth:i}),i>180?this.$el.css({maxWidth:i}):this.$el.css({maxWidth:""})},connect:function(){l.__super__.connect.call(this),this.makeTarget(),this.makeSource(),this.areaView.jsPlumbInstance.updateOffset({elId:this.id(),recalc:!0})},makeTarget:function(){const t=this.areaView.jsPlumbInstance;this.jsPlumbTarget=t.makeTarget(this.$el,i.extend(!0,{},o.result(this,"targetDefaults")))},makeSource:function(){const t=this.areaView.jsPlumbInstance;this.jsPlumbSource=t.makeSource(this.$el,i.extend(!0,{},o.result(this,"sourceDefaults"),{onMaxConnections:function(t,e){s.execute("showErrorMessage",r("oro.workflow.error.maxconnections",t),e)}}))}});return l}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/viewer/transition-overlay-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/overlay-view.js").extend({template:n("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroworkflow/templates/flowchart/viewer/transition.html"),constructor:function t(e){t.__super__.constructor.call(this,e)},className:function(){const t=[e.__super__.className.call(this)];return t.push("workflow-transition-overlay"),t.join(" ")}});return e}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/viewer/transition-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/base-view.js").extend({areaView:null,connections:null,defaultConnectionOptions:function(){return{paintStyle:{strokeStyle:"#bababb",lineWidth:2,outlineColor:"#ffffff",outlineWidth:2},EndpointStyle:{lineWidth:10}}},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.connections=[];const n=["areaView","stepCollection","stepCollectionView","transitionOverlayView"];if(n.length!==e.intersection(n,e.keys(t)).length)throw new Error(n.join(", ")+" options are required");e.extend(this,e.pick(t,n)),this.defaultConnectionOptions=e.extend(e.result(this,"defaultConnectionOptions"),t.connectionOptions||{}),i.__super__.initialize.call(this,t)},render:function(){return this.updateStepTransitions(),this.isConnected||this.isConnecting||(this.isConnecting=!0,this.connect(),this.isConnected=!0,delete this.isConnecting),this},connect:function(){const t=e.debounce((()=>{this.disposed||this.updateStepTransitions()}),50);this.listenTo(this.model,"change",t),this.listenTo(this.stepCollection,"add",t),this.listenTo(this.stepCollection,"change",t),this.listenTo(this.stepCollection,"remove",t)},findElByStep:function(t){return this.stepCollectionView.getItemView(t).el},findConnectionByStartStep:function(t){let e;for(let n=0;n<this.connections.length;n++)if(e=this.connections[n],e.startStep===t)return e},updateStepTransitions:function(){let t,e,n;const i=this.model.get("name"),o=this.stepCollection.filter((function(t){return-1!==t.get("allowed_transitions").indexOf(i)})),s=this.stepCollection.findWhere({name:this.model.get("step_to")});for(this.addStaleMark(),t=0;t<o.length;t++)e=o[t],n=this.findConnectionByStartStep(e),n&&n.endStep===s?delete n.stale:this.createConnection(e,s);for(this.removeStaleConnections(),this.stepCollectionView.getItemView(s).updateStepMinWidth(),t=0;t<o.length;t++)e=o[t],this.stepCollectionView.getItemView(e).updateStepMinWidth()},addStaleMark:function(){let t;for(let e=0;e<this.connections.length;e++)t=this.connections[e],t.stale=!0},removeStaleConnections:function(){let t;for(let e=0;e<this.connections.length;e++)t=this.connections[e],t.stale&&t.jsplumbConnection._jsPlumb&&(this.areaView.jsPlumbInstance.detach(t.jsplumbConnection),t.jsplumbConnection.overlayView&&t.jsplumbConnection.overlayView.dispose()),t.jsplumbConnection._jsPlumb||(this.connections.splice(e,1),e--)},createConnection:function(t,n){let i;const o=this.model,s=this.areaView,r=s.flowchartState.get("transitionLabelsVisible"),l=this.findElByStep(n),a=this.findElByStep(t),c=this.areaView.jsPlumbManager.getAnchors(a,l),u=e.defaults({source:a,target:l,connector:["Smartline",{cornerRadius:3,midpoint:.5}],paintStyle:e.result(this,"connectorStyle"),hoverPaintStyle:e.result(this,"connectorHoverStyle"),anchors:c,overlays:[["Custom",{id:"overlay",create:n=>{const r=n.getOverlay("overlay");return n.overlayView=i=new this.transitionOverlayView({model:o,overlay:r,areaView:s,stepFrom:t}),i.render(),r.cssClass=e.result(i,"className"),i.$el},visible:r,location:.5}]]},this.defaultConnectionOptions),h=this.areaView.jsPlumbInstance.connect(u);h.overlayView=i,this.connections.push({startStep:t,endStep:n,jsplumbConnection:h})},cleanup:function(){this.addStaleMark(),this.removeStaleConnections()}});return i}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/flowchart/viewer/workflow-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroworkflow/js/app/views/flowchart/jsplumb/area-view.js"),o=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/step-view.js"),s=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/transition-view.js"),r=n("./bundles/oroworkflow/js/app/views/flowchart/viewer/transition-overlay-view.js"),l=n("./bundles/oroui/js/app/views/base/collection-view.js"),a=i.extend({transitionOverlayView:r,stepView:o,transitionView:s,className:"workflow-flowchart-viewer",defaultConnectionOptions:function(){return{detachable:!1}},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){a.__super__.initialize.call(this,t),this.defaultConnectionOptions=e.extend(e.result(this,"defaultConnectionOptions"),t.connectionOptions||{})},findStepModelByElement:function(t){const e=this.subview("stepCollectionView");return this.model.get("steps").find((function(n){return e.getItemView(n).el===t}))},connect:function(){a.__super__.connect.call(this),this.jsPlumbInstance.batch((()=>{this.$el.addClass(this.className);const t=this.transitionOverlayView,n=e.extend({},this.defaultConnectionOptions),i=this.stepView,o=this.transitionView,s=this,r=this.model.get("steps"),a=new l({el:this.$el,collection:r,animationDuration:0,itemView:function(t){return t=e.extend({areaView:s},t),new i(t)},autoRender:!0}),c=new l({el:this.$el,collection:this.model.get("transitions"),animationDuration:0,itemView:function(i){return i=e.extend({areaView:s,stepCollection:r,stepCollectionView:a,transitionOverlayView:t,connectionOptions:n},i),new o(i)},autoRender:!0});this.subview("stepCollectionView",a),this.subview("transitionCollectionView",c)})),this.$el.trigger("autozoom")}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/process-status-toggle-btn-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroui/js/mediator.js"),o=n("./bundles/oroui/js/extend/jquery.js");return e.extend({events:{'click [data-role="status-toggle"]':"onStatusToggle"},constructor:function t(e){t.__super__.constructor.call(this,e)},onStatusToggle:function(t){t.preventDefault(),o.ajax({url:t.currentTarget.pathname,method:"POST",success:function(t){t.message&&i.execute("showFlashMessage","success",t.message,{afterReload:!0}),i.execute("refreshPage")}})}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/step/step-edit-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/orotranslation/js/translator.js"),s=n("./bundles/oroui/js/app/views/base/view.js"),r=n("./bundles/orowindows/js/widget/dialog-widget.js"),l=n("./bundles/oroworkflow/js/tools/workflow-helper.js"),a=n("./bundles/oroworkflow/js/app/views/transition/transition-list-view.js"),c=s.extend({attributes:{class:"widget-content"},options:{template:null,transitionListContainerEl:".transitions-list-container",workflow:null},listen:{"destroy model":"remove"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options);const n=this.options.template||i("#step-form-template").html();this.template=e.template(n),this.widget=null},onStepAdd:function(){const t=l.getFormData(this.widget.form),e=parseInt(t.order);this.model.get("name")||this.model.set("name",l.getNameByString(t.label,"step_")),this.model.set("order",e>0?e:0),this.model.set("is_final",t.hasOwnProperty("is_final")),this.model.set("label",t.label),this.model.set("_is_clone",!1),this.trigger("stepAdd",this.model),this.widget.remove()},onCancel:function(){this.model.get("_is_clone")?this.model.destroy():this.remove()},remove:function(){this.transitionsListView&&this.transitionsListView.remove(),c.__super__.remove.call(this)},renderTransitions:function(){this.transitionsListView=new a({el:this.$el.find(this.options.transitionListContainerEl),workflow:this.options.workflow,collection:this.model.getAllowedTransitions(this.options.workflow),stepFrom:this.model}),this.transitionsListView.render()},renderWidget:function(){if(this.widget)this.widget._adoptWidgetActions();else{let t=this.model.get("name")?o("Edit step"):o("Add new step");this.model.get("_is_clone")&&(t=o("Clone step")),this.widget=new r({title:t,el:this.$el,stateEnabled:!1,incrementalPosition:!1,dialogOptions:{close:this.onCancel.bind(this),width:800,modal:!0}}),this.widget.render()}this.widget.form.off("submit"),this.widget.form.validate({submitHandler:this.onStepAdd.bind(this),ignore:'[type="hidden"]',highlight:function(t){const e=i(t).closest(".tab-pane");e.is(":hidden")&&e.closest(".oro-tabs").find('[href="#'+e.prop("id")+'"]').click()}})},render:function(){const t=this.model.toJSON();return t.transitionsAllowed=this.options.workflow.get("steps").length>1&&this.model.get("name"),this.$el.html(this.template(t)),t.transitionsAllowed&&this.renderTransitions(),this.renderWidget(),this}});return c}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/step/step-list-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroworkflow/js/app/views/step/step-row-view.js"),r=o.extend({options:{listElBodyEl:"tbody",template:null,workflow:null},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options);const n=this.options.template||i("#step-list-template").html();this.template=e.template(n),this.rowViews=[],this.$listEl=i(this.template()),this.$listElBody=this.$listEl.find(this.options.listElBodyEl),this.$el.html(this.$listEl),this.listenTo(this.getCollection(),"change",this.render),this.listenTo(this.getCollection(),"add",this.render),this.listenTo(this.getCollection(),"reset",this.addAllItems),this.listenTo(this.getTransitionCollection(),"change",this.updateDataFields),this.listenTo(this.getTransitionCollection(),"add",this.updateDataFields),this.listenTo(this.getTransitionCollection(),"reset",this.updateDataFields)},addItem:function(t){const e=new s({model:t,workflow:this.options.workflow});this.rowViews.push(e),this.$listElBody.append(e.render().$el)},addAllItems:function(t){this.resetView(),t.each(this.addItem.bind(this))},getCollection:function(){return this.options.workflow.get("steps")},getTransitionCollection:function(){return this.options.workflow.get("transitions")},remove:function(){this.resetView(),r.__super__.remove.call(this)},resetView:function(){e.each(this.rowViews,(function(t){t.remove()})),this.rowViews=[]},updateDataFields:function(){this.$listEl.find('[name="oro_workflow_definition_form[steps]"]').val(JSON.stringify(this.getCollection())),this.$listEl.find('[name="oro_workflow_definition_form[transitions]"]').val(JSON.stringify(this.getTransitionCollection()))},render:function(){return this.getCollection().sort(),this.addAllItems(this.getCollection()),this.updateDataFields(),this}});return r}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/step/step-row-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroworkflow/js/app/views/transition/transition-list-short-view.js"),r=n("./bundles/oroworkflow/js/app/models/step-model.js"),l=o.extend({tagName:"tr",events:{"click .edit-step":"triggerEditStep","click .delete-step":"triggerRemoveStep","click .clone-step":"triggerCloneStep","click .add-step-transition":"triggerAddStepTransition"},options:{workflow:null,template:null},listen:{"destroy model":"remove"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options);const n=this.options.template||i("#step-row-template").html();this.template=e.template(n),this.transitionsListView=null},triggerEditStep:function(t){t.preventDefault(),this.options.workflow.trigger("requestEditStep",this.model)},triggerRemoveStep:function(t){t.preventDefault(),this.options.workflow.trigger("requestRemoveStep",this.model)},triggerCloneStep:function(t){t.preventDefault(),this.options.workflow.trigger("requestCloneStep",this.model)},triggerAddStepTransition:function(t){t.preventDefault(),this.options.workflow.trigger("requestAddTransition",this.model)},remove:function(){this.transitionsListView&&this.transitionsListView.remove(),l.__super__.remove.call(this)},render:function(){if(!(this.model instanceof r))throw new Error("Model must be an instance of StepModel");this.transitionsListView=new s({collection:this.model.getAllowedTransitions(this.options.workflow),workflow:this.options.workflow,stepFrom:this.model});const t=i(this.template(this.model.toJSON())),e=this.transitionsListView.render().$el;return t.filter(".step-transitions").append(e),this.$el.append(t),this}});return l}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/transition/transition-edit-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/orotranslation/js/translator.js"),s=n("./bundles/oroui/js/app/views/base/view.js"),r=n("./bundles/orowindows/js/widget/dialog-widget.js"),l=n("./bundles/oroworkflow/js/tools/workflow-helper.js"),a=n("./bundles/oroworkflow/js/app/views/attribute/attribute-form-option-edit-view.js"),c=n("./bundles/oroworkflow/js/app/views/attribute/attribute-form-option-list-view.js");n("./bundles/oroform/js/extend/validate.js");const u=s.extend({attributes:{class:"widget-content"},events:{"change [name=label]":"updateExampleView","change [name=button_label]":"updateExampleView","change [name=button_title]":"updateExampleView",'change [name$="[transition_prototype_icon]"]':"updateExampleView","change [name=button_color]":"updateExampleView","change [name=display_type]":"updateDestinationPageView"},options:{template:null,workflow:null,step_from:null,button_example_template:'<button type="button" class="btn <%- button_color %>" title="<%- button_title %>"><% if (transition_prototype_icon) { %><i class="<%- transition_prototype_icon %>"></i> <% } %><%- button_label %></button>',allowed_button_styles:[{label:o("Gray button"),name:""},{label:o("Navy blue button"),name:"btn-primary"},{label:o("Blue button"),name:"btn-info"},{label:o("Green button"),name:"btn-success"},{label:o("Yellow button"),name:"btn-warning"},{label:o("Red button"),name:"btn-danger"},{label:o("Black button"),name:"btn-inverse"},{label:o("Link"),name:"btn-link"}]},requiredOptions:["workflow","entityFieldsProvider"],listen:{"destroy model":"remove"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){t=t||{};const n=this.requiredOptions.filter((function(n){return e.isUndefined(t[n])}));if(n.length)throw new TypeError("Missing required option(s): "+n.join(", "));this.options=e.defaults(t,this.options);const o=this.options.template||i("#transition-form-template").html();this.template=e.template(o),this.button_example_template=e.template(this.options.button_example_template),this.widget=null},initDestinationPageView:function(t){const n=this.options.workflow.getAvailableDestinations(),o=e.keys(this.options.entityFieldsProvider.getEntityRoutes());o.push("");const s=e.intersection(n,o),r=i(t).find("[name=destination_page] option");e.each(r,(function(t){i(t).toggle(e.indexOf(s,i(t).val())>=0)}))},updateDestinationPageView:function(){const t=i(this.widget.form).find("[name=display_type]");i(this.widget.form).find(".destination-page-controls").toggle("page"===t.val())},updateExampleView:function(){const t=l.getFormData(this.widget.form);t.transition_prototype_icon=t.transition_prototype_icon||this._getFrontendOption("icon"),t.button_label=t.button_label||t.label,t.button_title=t.button_title||t.button_label,(t.transition_prototype_icon||t.button_label||t.button_title)&&this.$exampleBtnContainer.html(this.button_example_template(t))},onTransitionAdd:function(){const t=l.getFormData(this.widget.form),n=e.pick(t,"label","button_label","button_title","step_to","display_type","destination_page","message");this.model.get("name")||(n.name=l.getNameByString(t.label,"transition_"));const i=this.model.get("frontend_options");n.frontend_options=e.extend({},i,{icon:t.transition_prototype_icon,class:t.button_color}),n._is_clone=!1;const o={};e.each(this.subview("attributes-list-view").getCollection(),(function(t){this.options.workflow.ensureAttributeByPropertyPath(t.property_path);const n=this.options.workflow.getAttributeByPropertyPath(t.property_path).get("name"),i=e.pick(t,"options");t.required?i.options=e.extend({},i.options,{required:!0}):i.options&&(delete i.options.required,delete i.options.constraints),t.label&&t.isLabelUpdated&&(i.label=t.label,i.options&&delete i.options.label),o[n]=i}),this),n.form_options={attribute_fields:o},this.model.set(n);const s=t.step_from?t.step_from:this.options.step_from;this.trigger("transitionAdd",this.model,s),this.widget.remove()},_getFrontendOption:function(t){let e="";const n=this.model.get("frontend_options");return n&&n.hasOwnProperty(t)&&(e=n[t]),e},renderAddAttributeForm:function(t){const e=new a({autoRender:!0,el:t.find(".transition-attributes-form-container"),workflow:this.options.workflow,entityFieldsProvider:this.options.entityFieldsProvider,entity:this.options.entity,filterPreset:"workflow"});return this.listenTo(e,"formOptionAdd",this.addFormOption),this.subview("attributes-form-view",e),e},addFormOption:function(t){let e;const n=this.options.workflow.getAttributeByPropertyPath(t.property_path);e=n?n.get("name"):this.options.workflow.generateAttributeName(t.property_path),t.label&&(t.isLabelUpdated=!0),t.attribute_name=e,t.is_entity_attribute=!0,this.subview("attributes-list-view").addItem(t)},renderAttributesList:function(t){const e=new c({autoRender:!0,el:t.find(".transition-attributes-list-container"),items:this.getFormOptions(),fieldsChoiceView:this.subview("attributes-form-view").getFieldChoiceView(),workflow:this.options.workflow,entityFieldsProvider:this.options.entityFieldsProvider});this.listenTo(e,"editFormOption",this.editFormOption),this.subview("attributes-list-view",e)},editFormOption:function(t){this.subview("attributes-form-view").editRow(t)},getFormOptions:function(){const t=[],n=this.options.workflow.get("entity_attribute")+".";return e.each(this.model.get("form_options").attribute_fields,(function(i,o){i=i||{};const s=this.options.workflow.getAttributeByName(o);let r=s.get("property_path");const l=Boolean(r);l&&0===r.indexOf(n)&&(r=r.substr(n.length));const a=i.hasOwnProperty("options")?i.options:{},c=!!a.hasOwnProperty("required")&&a.required;let u=i.hasOwnProperty("label")?i.label:null;!u&&a.hasOwnProperty("label")&&(u=a.label);const h={itemId:e.uniqueId(),is_entity_attribute:l,attribute_name:o,property_path:r||o,required:c,label:u,isLabelUpdated:!1,translateLinks:s.attributes.translateLinks[this.model.get("name")]};"options"in i&&(h.options=e.clone(i.options)),t.push(h)}),this),t},onCancel:function(){this.model.get("_is_clone")?this.model.destroy():this.remove()},remove:function(){this.removeSubview("attributes-form-view"),this.removeSubview("attributes-list-view"),u.__super__.remove.call(this)},renderWidget:function(){if(this.widget)this.widget._adoptWidgetActions();else{let t=this.model.get("name")?o("Edit transition"):o("Add new transition");this.model.get("_is_clone")&&(t=o("Clone transition")),this.widget=new r({title:t,el:this.$el,stateEnabled:!1,incrementalPosition:!1,dialogOptions:{close:this.onCancel.bind(this),width:800,modal:!0}}),this.widget.render()}this.widget.form.off("submit"),this.widget.form.validate({submitHandler:this.onTransitionAdd.bind(this),ignore:'[type="hidden"]',highlight:function(t){const e=i(t).closest(".tab-pane");e.is(":hidden")&&e.closest(".oro-tabs").find('[href="#'+e.prop("id")+'"]').click()}})},render:function(){this._deferredRender();const t=this.model.toJSON(),n=this.options.workflow.get("steps").models;t.stepFrom=this.options.step_from,t.step_to||(t.step_to=this.options.step_to?this.options.step_to.get("name"):void 0),t.allowedButtonStyles=e.sortBy(this.options.allowed_button_styles,"label"),t.buttonIcon=this._getFrontendOption("icon"),t.buttonStyle=this._getFrontendOption("class"),t.allowedStepsFrom=n,t.allowedStepsTo=n.slice(1);const o=i(this.template(t));this.initDestinationPageView(o);const s=this.renderAddAttributeForm(o);return i.when(s.getDeferredRenderPromise()).then(function(){this.renderAttributesList(o),this.$el.append(o),this.renderWidget(),this.$exampleContainer=this.$(".transition-example-container"),this.$exampleBtnContainer=this.$exampleContainer.find(".transition-btn-example"),this.updateExampleView(),this.updateDestinationPageView(),this._resolveDeferredRender()}.bind(this)),this}});return u}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/transition/transition-error-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/widget/widget-manager.js"),i=n("./bundles/oroui/js/app/views/base/view.js"),o=i.extend({optionNames:i.prototype.optionNames.concat(["wid"]),constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){e.getWidgetInstance(this.wid,(function(t){t.trigger("formSaveError")})),o.__super__.initialize.call(this,t)}});return o}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/transition/transition-list-short-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/app/views/base/view.js"),o=n("./bundles/oroworkflow/js/app/views/transition/transition-row-short-view.js"),s=i.extend({tagName:"ul",attributes:{class:"transitions-list-short"},options:{collection:null,workflow:null,stepFrom:null},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options),this.rowViews=[],this.listenTo(this.getCollection(),"add",this.addItem),this.listenTo(this.getCollection(),"reset",this.addAllItems)},addItem:function(t){const e=new o({model:t,workflow:this.options.workflow,stepFrom:this.options.stepFrom});this.rowViews.push(e),this.$el.append(e.render().$el)},addAllItems:function(t){e.each(t,this.addItem,this)},getCollection:function(){return this.options.collection},remove:function(){this.resetView(),s.__super__.remove.call(this)},resetView:function(){e.each(this.rowViews,(function(t){t.remove()}))},render:function(){return this.addAllItems(this.getCollection().models),this}});return s}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/transition/transition-list-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroworkflow/js/app/views/transition/transition-row-view.js"),r=o.extend({options:{listElBodyEl:"tbody",template:null,workflow:null,collection:null,stepFrom:null},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options);const n=this.options.template||i("#transition-list-template").html();this.template=e.template(n),this.rowViews=[],this.$listEl=i(this.template()),this.$listElBody=this.$listEl.find(this.options.listElBodyEl),this.$emptyMessage=this.$listElBody.find(".no-rows-message"),this.$el.html(this.$listEl),this.listenTo(this.getCollection(),"change",this.render),this.listenTo(this.getCollection(),"add",this.render),this.listenTo(this.getCollection(),"remove",this.render),this.listenTo(this.getCollection(),"reset",this.addAllItems)},addItem:function(t){const e=new s({model:t,workflow:this.options.workflow,stepFrom:this.options.stepFrom});this.rowViews.push(e),this.$listElBody.append(e.render().$el)},addAllItems:function(t){e.each(t,this.addItem,this)},getCollection:function(){return this.options.collection},remove:function(){this.resetView(),r.__super__.remove.call(this)},resetView:function(){e.each(this.rowViews,(function(t){t.remove()})),this.rowViews=[]},render:function(){return this.getCollection().models.length?(this.$emptyMessage.hide(),this.resetView(),this.addAllItems(this.getCollection().models)):this.$emptyMessage.show(),this}});return r}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/transition/transition-row-short-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js");return n("./bundles/oroui/js/app/views/base/view.js").extend({tagName:"li",events:{"click .edit-transition":"triggerEditTransition","click .clone-transition":"triggerCloneTransition","click .delete-transition":"deleteTransition"},options:{workflow:null,template:null,stepFrom:null},listen:{"destroy model":"remove","change model":"render"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options);const n=this.options.template||i("#transition-row-short-template").html();this.template=e.template(n)},deleteTransition:function(t){t.preventDefault(),this.options.workflow.trigger("requestRemoveTransition",this.model)},triggerEditTransition:function(t){t.preventDefault(),this.options.workflow.trigger("requestEditTransition",this.model,this.options.stepFrom)},triggerCloneTransition:function(t){t.preventDefault(),this.options.workflow.trigger("requestCloneTransition",this.model,this.options.stepFrom)},render:function(){const t=this.model.toJSON(),e=this.options.workflow.getStepByName(t.step_to);return t.stepToLabel=e?e.get("label"):"",this.$el.html(this.template(t)),this}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/transition/transition-row-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js");return n("./bundles/oroui/js/app/views/base/view.js").extend({tagName:"tr",events:{"click .delete-transition":"triggerRemoveTransition"},options:{workflow:null,template:null,stepFrom:null},listen:{"destroy model":"remove","change model":"render"},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options);const n=this.options.template||i("#transition-row-template").html();this.template=e.template(n)},triggerRemoveTransition:function(t){t.preventDefault(),this.options.workflow.trigger("requestRemoveTransition",this.model)},render:function(){const t=this.model.toJSON(),e=this.options.workflow.getStepByName(t.step_to);return t.stepToLabel=e?e.get("label"):"",this.$el.html(this.template(t)),this}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/workflow-activate-btn-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroui/js/mediator.js"),o=n("./bundles/oroui/js/messenger.js"),s=n("./bundles/oroui/js/extend/jquery.js"),r=n("./bundles/oroui/js/extend/underscore.js"),l=n("./bundles/oroworkflow/js/activation-handler.js"),a=e.extend({options:{selectors:{button:null}},$el:null,constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){a.__super__.initialize.call(this,t),this.options=s.extend(!0,{},this.options,r.pick(t,r.keys(this.options)))},delegateEvents:function(t){a.__super__.delegateEvents.call(this,t),this.$el.on("click"+this.eventNamespace(),this.options.selectors.button,this.onClick.bind(this)),this.$el.on({activation_success:this.onActivationSuccess},this.options.selectors.button)},onActivationSuccess:function(t,e){i.once("page:afterChange",(function(){o.notificationFlashMessage("success",e.message),e.deactivatedMessage&&o.notificationFlashMessage("info",e.deactivatedMessage)})),i.execute("refreshPage")},onClick:function(t){t.preventDefault();const e=this.$el.find(this.options.selectors.button);l.call(e,e.attr("href"),e.data("name"),e.data("label"))},dispose:function(){this.disposed||(this.$el.off("click"+this.eventNamespace()),this.$el.off("activation_success"),a.__super__.dispose.call(this))}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/workflow-deactivate-btn-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroui/js/mediator.js"),o=n("./bundles/oroui/js/messenger.js"),s=n("./bundles/oroui/js/extend/jquery.js"),r=n("./bundles/oroui/js/extend/underscore.js"),l=n("./bundles/oroworkflow/js/deactivation-handler.js"),a=e.extend({options:{selectors:{button:null}},$el:null,constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){a.__super__.initialize.call(this,t),this.options=s.extend(!0,{},this.options,r.pick(t,r.keys(this.options)))},delegateEvents:function(t){a.__super__.delegateEvents.call(this,t),this.$el.on("click"+this.eventNamespace(),this.options.selectors.button,this.onClick.bind(this)),this.$el.on({deactivation_success:this.onDeactivationSuccess},this.options.selectors.button)},onDeactivationSuccess:function(t,e){i.once("page:afterChange",(function(){o.notificationFlashMessage("success",e.message)})),i.execute("refreshPage")},onClick:function(t){t.preventDefault();const e=this.$el.find(this.options.selectors.button);l.call(e,e.attr("href"),e.data("label"))},dispose:function(){this.disposed||(this.$el.off("click"+this.eventNamespace()),this.$el.off("deactivation_success"),a.__super__.dispose.call(this))}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/workflow-form-widget-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/app/views/base/view.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/widget/widget-manager.js"),s=n("./bundles/oroui/js/mediator.js"),r=n("./bundles/oroworkflow/js/transition-executor.js"),l=n("./bundles/oroworkflow/js/transition-event-handlers.js"),a=e.extend({optionNames:e.prototype.optionNames.concat(["widgetAlias","saveAndTransitButtonSelector"]),constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this._bindEvents(),o.getWidgetInstanceByAlias(this.widgetAlias,this._bindWidgetEvents.bind(this)),a.__super__.initialize.call(this,t)},onSaveAndTransit:function(t){t.preventDefault(),o.getWidgetInstanceByAlias(this.widgetAlias,(function(t){t.form.submit()}))},_bindEvents:function(){i(this.saveAndTransitButtonSelector).on("click"+this.eventNamespace(),this.onSaveAndTransit.bind(this))},_unbindEvents:function(){i(this.saveAndTransitButtonSelector).off(this.eventNamespace())},_bindWidgetEvents:function(t){t.on({beforeContentLoad:function(){s.execute("showLoading")},formSave:function(t){r(i(this.saveAndTransitButtonSelector),t)},formSaveError:function(){s.execute("hideLoading")},transitionSuccess:function(t){l.getOnSuccess(i("<div>"))(t)},transitionFailure:function(t){l.getOnFailure(i("<div>"))({status:t},"","")}})},dispose:function(){this._unbindEvents(),a.__super__.dispose.call(this)}});return a}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/views/workflow-management-view.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/orotranslation/js/translator.js"),s=n("./bundles/oroui/js/delete-confirmation.js"),r=n("./bundles/oroui/js/app/views/base/view.js"),l=n("./bundles/oroworkflow/js/app/views/step/step-list-view.js");return r.extend({events:{"click .add-step-btn":"addNewStep","click .add-transition-btn":"addNewTransition","click .refresh-btn":"refreshChart",submit:"onSubmit","click [type=submit]":"setSubmitActor",'change [name$="[related_entity]"]':"onEntityChange"},options:{stepsEl:null,model:null,entities:[],templateTranslateLink:null,selectorTranslateLinkContainer:"#workflow_translate_link_label",entitySelectSelector:'[name$="[related_entity]"]'},constructor:function t(e){t.__super__.constructor.call(this,e)},initialize:function(t){this.options=e.defaults(t||{},this.options),this.initStartStepSelector(),this.stepListView=new l({el:this.$(this.options.stepsEl),collection:this.model.get("steps"),workflow:this.model});const n=this.options.templateTranslateLink||i("#workflow-translate-link-template").html();this.templateTranslateLink=e.template(n),this.listenTo(this.model.get("steps"),"destroy",this.onStepRemove)},render:function(){return this.renderSteps(),this.model.translateLinkLabel&&i(this.options.selectorTranslateLinkContainer).html(this.templateTranslateLink({translateLink:this.model.translateLinkLabel})),this},renderSteps:function(){this.stepListView.render()},onSubmit:function(t){this.model.trigger("saveWorkflow",t)},setSubmitActor:function(t){this.submitActor=t.target},initStartStepSelector:function(){this.$startStepEl=this.$('[name="start_step"]');const t={allowClear:!0,query:t=>{const n=[];e.each(this.model.get("steps").models,(function(i){const o=i.get("label");i.get("_is_start")||t.term&&t.term!==o&&-1===e.indexOf(o,t.term)||n.push({id:i.get("name"),text:i.get("label")})}),this),t.callback({results:n})},placeholder:o("Choose step..."),initSelection:(t,e)=>{const n=this.model.getStepByName(t.val());e({id:n.get("name"),text:n.get("label")})}};this.$startStepEl.inputWidget("create","select2",{initializeOptions:t})},onEntityChange:function(t){null!==(e.result(t.removed,"id")||null)&&this._hasData()?this._confirm(this.applyEntitySelectValue.bind(this),function(){this.setEntitySelectValue(this.model.get("entity"))}.bind(this)):this.applyEntitySelectValue()},applyEntitySelectValue:function(){this.model.set("entity",this.getEntitySelectValue())},_confirm:function(t,e){const n=new s({title:o("Change Entity Confirmation"),okText:o("Yes"),content:o("oro.workflow.change_entity_confirmation")});n.on("ok",t),n.on("cancel",e),n.once("hidden",(function(){n.off("ok cancel")})),n.open()},_hasData:function(){return this.model.get("steps").length>0||!this.model.get("transitions").isEmpty()||!this.model.get("transition_definitions").isEmpty()||this.model.get("attributes").isEmpty()},addNewTransition:function(){this.model.trigger("requestAddTransition")},addNewStep:function(){this.model.trigger("requestAddStep")},refreshChart:function(){this.model.trigger("requestRefreshChart")},onStepRemove:function(t){this.$startStepEl.val()===t.get("name")&&this.$startStepEl.inputWidget("val","")},isEntitySelected:function(){return Boolean(this.getEntitySelectValue())},getEntitySelectValue:function(){return this.$(this.options.entitySelectSelector).val()},setEntitySelectValue:function(t){this.$(this.options.entitySelectSelector).inputWidget("val",t)},valid:function(){return this.$el.valid()}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/app/widget/transition-dialog-widget.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/orowindows/js/widget/dialog-widget.js"),i=n("./bundles/oroui/js/mediator.js"),o=n("./bundles/oroworkflow/js/transition-event-handlers.js"),s=n("./bundles/oroui/js/extend/jquery.js"),r=n("./bundles/oroui/js/extend/underscore.js"),l=e.extend({listen:{transitionSuccess:"onTransitionSuccess",transitionFailure:"onTransitionFailure"},constructor:function t(e){t.__super__.constructor.call(this,e)},onTransitionSuccess:function(t){const e=s("<div>");this.hide(),o.getOnSuccess(e)(t)},onTransitionFailure:function(t){const e=s("<div>");this.hide(),o.getOnFailure(e)(t)},_onContentLoad:function(t){if(r.has(t,"workflowItem")){const e=s("<div>");this.hide(),i.execute("showLoading"),o.getOnSuccess(e)(t)}return l.__super__._onContentLoad.call(this,t)}});return l}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/deactivation-handler.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroui/js/extend/jquery.js"),n("./bundles/orotranslation/js/translator.js"),n("./bundles/oroui/js/modal.js"),n("./bundles/oroui/js/messenger.js")],void 0===(o=function(t,e,n,i){"use strict";return function(o,s,r){const l=this,a=new n({title:e("oro.workflow.workflowdefinition.deactivate",{label:s}),content:e("oro.workflow.workflowdefinition.reset_workflow_data_message"),okText:e("oro.workflow.workflowdefinition.deactivate_button_text")});a.on("ok",(function(){l.trigger("deactivation_start"),t.ajax({url:o,type:"POST",success:function(t){t.message&&!r&&i.notificationFlashMessage("success",t.message),l.trigger("deactivation_success",[t])},error:function(t,e,n){l.trigger("deactivation_error",[t,e,n])}})})),a.open()}}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/extend/jsplumb.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("../node_modules/@oroinc/jsplumb/dist/js/jsPlumb-1.7.10.js").W,o=i.constructor;let s,r;s=function(t,e){if(null!=t){t="string"!=typeof t&&null==t.tagName&&null!=t.length?t:[t];for(var n=0;n<t.length;n++)e.apply(t[n],[t[n]])}},r=function(t){return null==t||null==(t="string"==typeof t?document.getElementById(t):t)?null:(t._katavorio=t._katavorio||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})),t)};const l=e.isFunction(window.requestAnimationFrame)?function(t,n,i){let o,s,r,l=null,a=0,c=!1;i||(i={});const u=function(){c?l=setTimeout(u,0):(a=!1===i.leading?0:e.now(),l=null,r=t.apply(o,s),l||(o=s=null))},h=function(){c=!1};return function(...t){const d=e.now();a||!1!==i.leading||(a=d);const p=n-(d-a);if(o=this,s=t,p<=0||p>n){if(c)return;clearTimeout(l),a=d,l=setTimeout(u,0),c=!0,requestAnimationFrame(h)}else l||!1===i.trailing||(l=setTimeout(u,p),c=!0,requestAnimationFrame(h));return r}}:e.throttle;return o.prototype.initDraggable=e.wrap(o.prototype.initDraggable,(function(t,e,...n){t.call(this,e,...n),s(e,(function(t){(t=r(t))&&(t._katavorioDrag.moveListener=l(t._katavorioDrag.moveListener,10))}))})),i}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-matrix.js"),o=n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-hide-start-rule.js"),s=n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-cascade-rule.js"),r=n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-pyramid-rule.js"),l=n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-triada-rule.js"),a=n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-cherry-rule.js"),c=[.5,0,0,-1],u=[.5,1,0,1],h=[0,.5,-1,0],d=[1,.5,1,0],p=function(t,e){this.jsPlumbInstance=t,this.workflow=e,this.loopback={},this.loopbackAnchorPreset=[[[1,.3,1,0],[.8,0,0,-1]],[[.2,1,0,1],[0,.7,-1,0]],[[1,.5,1,0],[.5,0,0,-1]],[[.5,1,0,1],[0,.5,-1,0]]],this.xPadding=80,this.yPadding=15,this.xIncrement=240,this.yIncrement=140,this.stepForNew=10};return e.extend(p.prototype,{organizeBlocks:function(){const t=new i({workflow:this.workflow}),n=[o,s,r,l,a],c=[];t.forEachCell((function(i){e.find(n,(function(e){const n=new e(t);if(n.match(i))return c.push(n),!0}))})),c.sort((function(t,e){return t.root.y>e.root.y})),e.each(c,(function(t){t.apply()})),t.align().forEachCell((t=>{const e=t.step.get("_is_start")?-15:35;t.step.set("position",[this.xIncrement*t.x+this.xPadding,this.yIncrement*t.y+this.yPadding+e])}))},getPositionForNew:function(){const t=this.stepForNew;let n=0;const i=[];for(this.workflow.get("steps").each((function(e){const n=e.get("position");n&&n[0]===n[1]&&n[0]%t==0&&i.push(n[0])}));e.indexOf(i,n)>=0;)n+=t;return[n,n]},getLoopbackAnchors:function(t){const e=this.loopbackAnchorPreset;t in this.loopback||(this.loopback[t]=[]);const n=e[this.loopback[t].length%e.length];return this.loopback[t].push(n),n},getAnchors:function(t,e){if(t===e)return this.getLoopbackAnchors(t.id);const n=t.getBoundingClientRect(),i=e.getBoundingClientRect();let o,s;return n.right<(i.left+i.right)/2?(o=d,s=n.bottom>i.top?h:c):(o=u,s=c),[o,s]}}),p}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-base-rule.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/backbone.js");function o(t){this.context=t||this,this.root=null,this.items=[]}return e.extend(o.prototype,{priority:10,match:function(){return!1},apply:function(){}}),o.extend=i.Model.extend,o}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-cascade-rule.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js");return n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-base-rule.js").extend({name:"Cascade",match:function(t){const n=e.find(t.children,(function(e){return e.y===t.y+1})),i=e.find(t.children,(function(e){return e.y===t.y+2})),o=e.find(t.children,(function(e){return e.y===t.y+3})),s=e.find(t.children,(function(e){return e.y===t.y+4}));return n&&i&&o?(this.root=t,this.items=[n,i,o],!0):i&&o&&s?(this.root=t,this.items=[i,o,s],!0):(this.root=null,this.items=[],!1)},apply:function(){const t=this.context;let e=!1;return null!==this.root&&(e=t.move(this.items[0],this.root.x+2)||e,e=t.move(this.items[1],this.root.x+1)||e,e=t.move(this.items[2],this.root.x)||e,this.root=null,this.items=[]),e}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-cell.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js");function i(t,n){let o=1;return n.push(t),e.each(t.children,(function(e){n.indexOf(e)<0&&e.y>=t.y&&(n.push(e),o+=i(e,n))})),o}const o=function(t){e.extend(this,t),e.defaults(this,{children:[]}),this.name=this.step.get("name")};return e.extend(o.prototype,{setChildren:function(t){this.children=t},hasChild:function(t){return this.children.indexOf(t)>=0},isRelativeWith:function(t){return this.hasChild(t)||t.hasChild(this)},getAllChildrenCount:function(){return i(this,[])}}),o}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-cherry-rule.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js");return n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-base-rule.js").extend({name:"Cherry",match:function(t){const n=e.filter(t.children,(function(e){return e.y>t.y}));return t.step.get("order")>=0&&2===n.length?(this.root=t,this.items=n,!0):(this.root=null,this.items=[],!1)},apply:function(){const t=this.context;let e=!1;return null!==this.root&&(this.items[0].x>this.items[1].x&&this.items.reverse(),this.items[0].getAllChildrenCount()<this.items[1].getAllChildrenCount()&&(e=!0,t.swap(this.items[0],this.items[1]),this.items.reverse()),this.items[1].x-this.items[0].x<2&&(e=t.move(this.items[1],this.items[0].x+2)||e),t.move(this.root,this.items[0].x+1),this.root=null,this.items=[]),e}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-hide-start-rule.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";return n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-base-rule.js").extend({name:"HideStart",match:function(t){return t.step.get("order")<0&&t.children.length<1?(this.root=t,this.items=[],!0):(this.root=null,this.items=[],!1)},apply:function(){const t=this.context;let e=!1;return null!==this.root&&(e=!0,t.remove(this.root),this.root=null,this.items=[]),e}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-matrix.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-cell.js");function o(t){const n=t.workflow.get("steps"),i=e.uniq(n.pluck("order"));this.workflow=t.workflow,this.width=8,this.cells=e.range(i.length).map((()=>e.range(this.width).map((()=>[])))),this.cellMap={},this.transitions={},this.workflow.get("transitions").each((t=>{this.transitions[t.get("name")]=t})),this.connections=[],n.each((t=>{e.each(t.get("allowed_transitions"),(e=>{const i=this.transitions[e];let o;i&&(o=n.find((t=>t.get("name")===i.get("step_to"))),o&&this.connections.push({from:t.get("name"),to:o.get("name")}))}))})),this._fill(n)}return e.extend(o.prototype,{move:function(t,n,i){if(void 0!==i&&!1!==i||(i=t.y),!e.isArray(this.cells[i][n])||t.x===n&&t.y===i)return!1;const o=this.cells[t.y][t.x];return this.cells[i][n].push(t),o.splice(o.indexOf(t),1),t.x=n,t.y=i,!0},remove:function(t){const e=this.cells[t.y][t.x];e.splice(e.indexOf(t),1),t.step.set("position",[0,-1e3])},swap:function(t,e){const n=t.x;this.move(t,e.x),this.move(e,n)},align:function(){let t=this.width,e=this.cells.length;return this.forEachCell((function(n){t=Math.min(t,n.x),e=Math.min(e,n.y)})),(e>0||t>0)&&this.forEachCell((n=>{this.move(n,n.x-t,n.y-e)})),this},findCell:function(t){const e="string"==typeof t?t:t.get("name");return e in this.cellMap?this.cellMap[e]:null},forEachCell:function(t){return e.each(this.cellMap,t),this},_fill:function(t){let n,o,s,r,l;const a=t.groupBy((function(t){return t.get("order")})),c=e.each(e.keys(a),parseInt).sort();for(n=0;n<c.length;n++)for(s=c[n],o=0;o<a[s].length;o++)l=a[s][o].get("name"),r=new i({x:o+2,y:n,step:a[s][o]}),this.cells[n][o+2]=[r],this.cellMap[l]=r;for(n=0;n<this.cells.length;n++)for(o=0;o<this.cells[n].length;o++)this.cells[n][o].length&&e.each(this.cells[n][o],(t=>{t.setChildren(this.findChildren(t))}))},findChildren:function(t){const e=[];return t.step.getAllowedTransitions(this.workflow).each((t=>{const n=this.findCell(t.get("step_to"));n&&e.indexOf(n)<0&&e.push(n)})),e}}),o}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-pyramid-rule.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js");return n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-base-rule.js").extend({name:"Pyramid",priority:20,match:function(t){let n,i,o,s;const r=e.filter(t.children,(function(e){return e.y===t.y+1||e.y===t.y+2}));if(r.sort((function(t,e){return t.x-e.x})),3===r.length){for(this.items=[],n=0;n<3;n++)i=(n+1)%3,o=(n+2)%3,r[n].isRelativeWith(r[i])&&r[n].isRelativeWith(r[o])&&(this.items=[r[i],r[n],r[o]]);if(0===this.items.length)for(n=0;n<3;n++)if(i=(n+1)%3,o=(n+2)%3,r[n].isRelativeWith(r[i])){r[n].y<r[i].y&&n<i&&(s=r[n],r[n]=r[i],r[i]=s),this.items=r;break}if(this.items.length>0)return this.root=t,!0}return this.root=null,this.items=[],!1},apply:function(){const t=this.context;let e=!1;return this.root&&(e=t.move(this.items[0],this.root.x-1)||e,e=t.move(this.items[1],this.root.x)||e,e=t.move(this.items[2],this.root.x+1)||e,this.root=null,this.items=[]),e}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-triada-rule.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js");return n("./bundles/oroworkflow/js/tools/jsplumb-manager/jpm-base-rule.js").extend({name:"Triada",match:function(t){const n=e.filter(t.children,(function(e){return e.y===t.y+1||e.y===t.y+2}));return n.sort((function(t,e){return t.y>e.y})),3===n.length?(this.root=t,this.items=n,!0):(this.root=null,this.items=[],!1)},apply:function(){const t=this.context;let e,n=!1;return this.root&&(e=Math.floor((this.items[0].x+this.items[1].x+this.items[2].x)/3),n=t.move(this.root,e)||n,n=t.move(this.items[0],e-1)||n,n=t.move(this.items[1],e)||n,n=t.move(this.items[2],e+1)||n,this.root=null,this.items=[]),n}})}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-overlay-manager.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/oroui/js/extend/jquery.js");function o(t){this.name=i(t).find(".step-label").text(),this.el=t,this.x=t.offsetLeft+t.offsetWidth/2,this.y=t.offsetTop+t.offsetHeight/2,this.w=t.offsetWidth,this.h=t.offsetHeight}function s(t,e,n){s.__super__.call(this,t),this.jsPlumbOverlayInstance=e,this.location=e.getLocation(),this._originalLocation=this.location,this.name=i(t).find(".transition-label").text(),this.moveX=0,this.moveY=0,this.segments=[],this.pathLength=0,this._fillSegments(n)}e.extend(o.prototype,{isOverlapped:function(t){if(this===t)throw new Error("Incorrect overlap checking with itself.");return!(t.y-t.h/2>this.y+this.h/2||t.y+t.h/2<this.y-this.h/2||t.x+t.w/2<this.x-this.w/2||t.x-t.w/2>this.x+this.w/2)}}),s.prototype=Object.create(o.prototype),s.__super__=o,e.extend(s.prototype,{_fillSegments:function(t){let e,n,i,o,s=0;for(e=1;e<t.length;e++)n={},i=t[e-1],o=t[e],Math.abs(i.x-o.x)<.1?(n.orientation="v",n.x=i.x,n.y1=i.y,n.y2=o.y,s+=Math.abs(i.y-o.y),this.segments.push(n)):Math.abs(i.y-o.y)<.1&&(n.orientation="h",n.y=i.y,n.x1=i.x,n.x2=o.x,s+=Math.abs(i.x-o.x),this.segments.push(n));this.pathLength=s},setNearestLocation:function(t,n){const i=this.x+t,o=this.y+n,s=[];let r=0;e.each(this.segments,(function(t){let e,n;"v"===t.orientation?(e=Math.min(t.y1,t.y2),n=Math.max(t.y1,t.y2),o-e>=0&&n-o>=0&&s.push({distance:Math.abs(t.x-i),passed:t.y1<t.y2?r+o-e:r+n-o,x:t.x,y:o,segment:t}),r+=n-e):(e=Math.min(t.x1,t.x2),n=Math.max(t.x1,t.x2),i-e>=0&&n-i>=0&&s.push({distance:Math.abs(t.y-o),passed:t.x1<t.x2?r+i-e:r+n-i,x:i,y:t.y,segment:t}),r+=n-e)}),this);const l=e.min(s,(function(t){return t.distance}));return this.moveX=0,this.moveY=0,!!e.isObject(l)&&((Math.abs(t)>0||Math.abs(n)>0)&&(this.x===l.x&&"h"===l.segment.orientation&&(Math.min(l.segment.x1,l.segment.x1)<=l.x-1?(l.x-=1,l.passed-=1):Math.max(l.segment.x1,l.segment.x1)>=l.x+1&&(l.x+=1,l.passed+=1)),this.y===l.y&&"v"===l.segment.orientation&&(Math.min(l.segment.y1,l.segment.y1)<=l.y-1?(l.y-=1,l.passed-=1):Math.max(l.segment.y1,l.segment.y1)>=l.y+1&&(l.y+=1,l.passed+=1))),this.x=l.x,this.y=l.y,this.location=l.passed/this.pathLength,!0)},setLocation:function(t){let n=0;return void 0!==e.find(this.segments,(function(e){let i,o,s;if("v"===e.orientation){if(i=Math.min(e.y1,e.y2),o=Math.max(e.y1,e.y2),s=this.pathLength*t-n,s>=0&&s<n+o-i)return this.x=e.x,this.y=e.y1<e.y2?i+s:o-s,this.location=t,!0;n+=o-i}else{if(i=Math.min(e.x1,e.x2),o=Math.max(e.x1,e.x2),s=this.pathLength*t-n,s>=0&&s<n+o-i)return this.x=e.x1<e.x2?i+s:o-s,this.y=e.y,this.location=t,!0;n+=o-i}}),this)},resetOriginalLocation:function(){return this.setLocation(this._originalLocation)},isChanged:function(){return Math.abs(this._originalLocation-this.location)>.01},clone:function(){const t=new s(this.el,this.jsPlumbOverlayInstance,[]);return t.setLocation(this.location),e.extend(t,this),t}});const r=function(t){this.smartlineManager=t};return e.extend(r.prototype,{calculate:function(){let t;const n=[],i=[];this.smartlineManager.isCacheValid()||this.smartlineManager.refreshCache(),e.each(this.smartlineManager.cache.connections,(function(t){const n=t.points;e.each(t.connection.getOverlays(),(function(t){let o;"Custom"===t.type&&(o=new s(t.canvas,t,e.clone(n)),o.setLocation(.5),i.push(o))}),this)})),e.each(e.keys(this.smartlineManager.jsPlumbInstance.sourceEndpointDefinitions),(function(t){const e=document.getElementById(t);e&&n.push(new o(e))}));const r=n.concat(i);for(t=0;t<16&&this._moveBlocks(r,i);t++);e.each(i,(function(t){let n;t.isChanged()&&(n=e.find(r,(function(e){return e!==t&&t.isOverlapped(e)})),void 0===n?t.jsPlumbOverlayInstance.setLocation(t.location):t.resetOriginalLocation())}))},_moveBlocks:function(t,n){let i=!1;return e.each(t,(function(t){e.each(n,(function(e){let n,i,o;t!==e&&t.isOverlapped(e)&&(n=e.x-t.x,i=e.y-t.y,o=5/Math.sqrt(n*n+i*i),n*=o,i*=o,e.moveX+=n,e.moveY+=i)}))})),e.each(n,(function(t){(Math.abs(t.moveX)>=1||Math.abs(t.moveY)>=1)&&(i=!0,t.setNearestLocation(t.moveX,t.moveY))})),i}}),r}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-smartline-manager.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/tools/jsplumb-overlay-manager.js"),i=n("./bundles/oroui/js/extend/underscore.js"),o=n("./bundles/oroworkflow/js/tools/path-finder/graph.js"),s=n("./bundles/oroworkflow/js/tools/path-finder/rectangle.js"),r=n("./bundles/oroworkflow/js/tools/path-finder/settings.js"),l=n("./bundles/oroworkflow/js/tools/path-finder/finder.js"),a=n("./bundles/oroworkflow/js/tools/path-finder/directions.js");function c(t,n){this.settings=i.extend({},this.settings,n),this.jsPlumbInstance=t,this.jsPlumbOverlayManager=new e(this),this.cache={state:{},connections:{}},this.debouncedCalculateOverlays=i.debounce(this.jsPlumbOverlayManager.calculate.bind(this.jsPlumbOverlayManager),50)}return window.getLastRequest=function(){return JSON.stringify(c.lastRequest)},c.prototype={settings:{connectionWidth:12,blockVMargin:8,blockHMargin:4},isCacheValid:function(){return i.isEqual(this.getState(),this.cache.state)},getConnectionPath:function(t){this.isCacheValid()||this.refreshCache();const e=this.cache.connections[t.getId()];return e?i.clone(e.points):[]},getNaivePathLength:function(t,e){return t===e?0:Math.abs(t.bottom-e.top)+Math.max(0,t.left-e.right,e.left-t.right)+(t.bottom-e.top>0?1200:0)},getState:function(){const t={rectangles:{},connections:[]},e=this.jsPlumbInstance.sourceEndpointDefinitions;for(const n in e)e.hasOwnProperty(n)&&(t.rectangles[n]=this.jsPlumbInstance.getCachedData(n));const n=this.jsPlumbInstance.getConnections();for(let e=n.length-1;e>=0;e--){const i=n[e];i.sourceId in t.rectangles&&i.targetId in t.rectangles&&t.connections.push([i.connector.getId(),i.sourceId,i.targetId])}return t},refreshCache:function(){try{this._refreshCache()}catch(t){return this.cache.state=this.getState(),this.cache.connections={},void this.jsPlumbInstance.eventBus.trigger("smartline:compute-error",t)}this.jsPlumbInstance.eventBus.trigger("smartline:compute-success")},_refreshCache:function(){const t=[],e={},n=new o,u=this.settings;this.cache.state=this.getState(),this.cache.connections={},i.each(this.jsPlumbInstance.sourceEndpointDefinitions,(function(t,i){let o;const r=document.getElementById(i);r&&(o=new s(r.offsetLeft-u.blockHMargin,r.offsetTop-u.blockVMargin,r.offsetWidth+2*u.blockHMargin,r.offsetHeight+2*u.blockVMargin),e[i]=o,o.cid=i,n.rectangles.push(o))})),n.rectangles.length<1||(n.build(),r.recommendedConnectionWidth=u.connectionWidth,i.each(this.jsPlumbInstance.getConnections(),(function(n){n.sourceId in e&&n.targetId in e&&n.source&&n.target&&t.push([n.sourceId,n.targetId,this.getNaivePathLength(e[n.sourceId],e[n.targetId]),n])}),this),t.sort((function(t,e){return t[2]-e[2]})),i.each(t,(t=>{const e=new l(n);e.addTo(n.getPathFromCid(t[1],a.BOTTOM_TO_TOP)),e.addFrom(n.getPathFromCid(t[0],a.TOP_TO_BOTTOM));const i=e.find();i&&(n.updateWithPath(i),this.cache.connections[t[3].connector.getId()]={connection:t[3],path:i})})),n.locateAxises(),i.each(this.cache.connections,(function(t){t.points=t.path.points.reverse(),delete t.path})),i.defer(this.jsPlumbInstance.repaintEverything.bind(this.jsPlumbInstance)),this.debouncedCalculateOverlays(),c.lastRequest={sources:n.rectangles.map((function(t){return[t.cid,t.left,t.top,t.width,t.height]})),connections:t.map((function(t){return t.slice(0,2)}))})}},c}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/jsplumb-smartline.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/extend/jsplumb.js"),i=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/extend/underscore.js"),s=n("./bundles/oroworkflow/js/tools/jsplumb-smartline-manager.js");function r(t,...n){let r;this.type="Smartline",this.idPrefix="smartline-connector-",(t=t||{}).stub=null===t.stub||void 0===t.stub?30:t.stub;const l=e.Connectors.AbstractConnector.call(this,t,...n);this.smartlineManager=function(t){return t.__smartLineManager||(t.__smartLineManager=new s(t)),t.__smartLineManager}(t._jsPlumb);const a=null===t.midpoint||void 0===t.midpoint?.5:t.midpoint,c=!0===t.alwaysRespectStubs;let u=null,h=null,d=null;const p=null!==t.cornerRadius&&void 0!==t.midpoint?t.cornerRadius:0,f=function(t){return t<0?-1:0===t?0:1},m=function(t,e,n,i){if(h===e&&d===n)return;const o=null===h?i.sx:h,s=null===d?i.sy:d,r=o===e?"v":"h",l=f(e-o),a=f(n-s);h=e,d=n,t.push([o,s,e,n,r,l,a])},g=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},b=function(t){return[...t]},v=function(t,e,n){let i,o=null;for(let s=0;s<e.length-1;s++){if(o=o||b(e[s]),i=b(e[s+1]),p>0&&o[4]!==i[4]){const e=Math.min(p,g(o),g(i));o[2]-=o[5]*e,o[3]-=o[6]*e,i[0]+=i[5]*e,i[1]+=i[6]*e;const n=o[6]===i[5]&&1===i[5]||o[6]===i[5]&&0===i[5]&&o[5]!==i[6]||o[6]===i[5]&&-1===i[5],s=(i[1]>o[3]?1:-1)==(i[0]>o[2]?1:-1),r=s&&n||!s&&!n?i[0]:o[2],a=s&&n||!s&&!n?o[3]:i[1];l.addSegment(t,"Straight",{x1:o[0],y1:o[1],x2:o[2],y2:o[3]}),l.addSegment(t,"Arc",{r:e,x1:o[2],y1:o[3],x2:i[0],y2:i[1],cx:r,cy:a,ac:n})}else{const e=o[2]===o[0]?0:o[2]>o[0]?n.lw/2:-n.lw/2,i=o[3]===o[1]?0:o[3]>o[1]?n.lw/2:-n.lw/2;l.addSegment(t,"Straight",{x1:o[0]-e,y1:o[1]-i,x2:o[2]+e,y2:o[3]+i})}o=i}i&&l.addSegment(t,"Straight",{x1:i[0],y1:i[1],x2:i[2],y2:i[3]})};function y(t,e,n){let i=0;const o=Math.min(t.offsetWidth/2,t.offsetHeight/2),s=["border",e,n,"radius"].join("-"),r=window.getComputedStyle(t);return r[s]&&"none"!==r[s]&&(i=Math.min(parseFloat(r[s])||0,o)),i}function w(t,e,n){const i=e.x-t.offsetLeft;if(i<1||i>t.offsetWidth-1)return 0;let o,s;if(i<t.offsetWidth/2){if(s=y(t,n,"left"),o=s-i,o>0)return Math.sqrt(s*s-o*o)-1}else if(s=y(t,n,"right"),o=i-(t.offsetWidth-s),o>0)return Math.sqrt(s*s-o*o)-1;return t.offsetHeight/2-1}this.setSegments=function(t){u=t},this.getSegs=function(){return r},this.getAbsSegments=function(t){let e,n,i;const o=t.endpoints[0].canvas.getBoundingClientRect(),s=t.endpoints[1].canvas.getBoundingClientRect(),l=Math.min(o.left+o.right,s.left+s.right)/2,a=Math.min(o.top+o.bottom,s.top+s.bottom)/2,c=[];for(e=0;e<r.length;e++){if(i=[r[e][0]+l,r[e][1]+a,r[e][2]+l,r[e][3]+a,r[e][4]],e>0)if(n=c.length-1,"v"===i[4]&&"v"===c[n][4]){if(i[1]===c[n][3]){c[n][3]=i[3];continue}if(i[3]===c[n][1]){c[n][1]=i[1];continue}}else if("h"===i[4]&&"h"===c[n][4]){if(i[0]===c[n][2]){c[n][2]=i[2];continue}if(i[2]===c[n][0]){c[n][0]=i[0];continue}}c.push(i)}return c},this.isEditable=function(){return!0},this.getOriginalSegments=function(){return u||r},this._compute=function(t,e,...n){if(e.sourceEndpoint.isTemporarySource||0===e.sourceEndpoint.getAttachedElements().length||0===e.targetEndpoint.getAttachedElements().length)return function(t,e){const n=e.sourceEndpoint.element,s=function(t,e){return o.find(i(t).find(".jsplumb-source").toArray(),(function(n){const i=t.offsetLeft+n.offsetLeft,o=t.offsetTop+n.offsetTop;return e[0]>=i&&e[0]<=i+n.offsetWidth&&e[1]>=o&&e[1]<=o+n.offsetHeight}))}(n,e.sourcePos),r=window.getComputedStyle(s);"hidden"===r.visibility||"none"===r.display?function(t,e,n){let i,o,s;const r=t.offsetLeft+t.offsetWidth/2-n.sourcePos[0]>=0?"left":"right",l=t.offsetTop+t.offsetHeight/2-n.sourcePos[1]>=0?"top":"bottom",a=y(t,l,r);i="left"===r?t.offsetLeft+a:t.offsetLeft+t.offsetWidth-a,o="top"===l?t.offsetTop+a:t.offsetTop+t.offsetHeight-a;const c=n.sourcePos[0]-i,u=n.sourcePos[1]-o;"left"===r&&c>=0||"right"===r&&c<=0?e.points[1]+="top"===l?t.offsetTop-n.sourcePos[1]:t.offsetTop+t.offsetHeight-n.sourcePos[1]:"top"===l&&u>=0||"bottom"===l&&u<=0?e.points[0]+="left"===r?t.offsetLeft-n.sourcePos[0]:t.offsetLeft+t.offsetWidth-n.sourcePos[0]:(s=(a-1.5)/Math.sqrt(c*c+u*u),e.points[0]+=i+c*s-n.sourcePos[0],e.points[1]+=o+u*s-n.sourcePos[1])}(n,t,e):s&&(t.points[0]+=n.offsetLeft+s.offsetLeft+s.offsetWidth/2-e.sourcePos[0],t.points[1]+=n.offsetTop+s.offsetTop+s.offsetHeight/2-e.sourcePos[1])}(t,e),this._flowchartConnectorCompute(t,e,...n);const s=this.smartlineManager.getConnectionPath(this,t);if(0===s.length)return;const l=s.shift().clone(),a=s.pop().clone();l.y+=w(e.sourceEndpoint.element,l,"bottom"),a.y-=w(e.targetEndpoint.element,a,"top");const c=Math.min(l.x,a.x),u=Math.min(l.y,a.y);t.sx=l.x-c,t.sy+=5;const p=e.sourceEndpoint.anchor.x,f=e.sourceEndpoint.anchor.y;if(e.sourceEndpoint.anchor.x=(l.x-e.sourceEndpoint.element.offsetLeft)/e.sourceEndpoint.element.offsetWidth,e.sourceEndpoint.anchor.y=(l.y-e.sourceEndpoint.element.offsetTop)/e.sourceEndpoint.element.offsetHeight,e.targetEndpoint.anchor.x=(a.x-e.targetEndpoint.element.offsetLeft)/e.targetEndpoint.element.offsetWidth,e.targetEndpoint.anchor.y=(a.y-e.targetEndpoint.element.offsetTop)/e.targetEndpoint.element.offsetHeight,p!==e.sourceEndpoint.anchor.x&&(t.points[0]+=(e.sourceEndpoint.anchor.x-p)*e.sourceEndpoint.element.offsetWidth),f!==e.sourceEndpoint.anchor.y&&(t.points[1]+=(e.sourceEndpoint.anchor.y-f)*e.sourceEndpoint.element.offsetHeight),h=null,d=null,r=[],s.length)for(let e=0;e<s.length;e++)m(r,s[e].x-c,s[e].y-u,t);else m(r,l.x-c,l.y-u,t);m(r,a.x-c,a.y-u-4,t),v(this,r,t)},this.getPath=function(){let t=null,e=null;const n=[],i=u||r;let o,s,l;for(let r=0;r<i.length;r++)o=i[r],s=o[4],l="v"===s?3:2,null!==t&&e===s?t[l]=o[l]:o[0]===o[2]&&o[1]===o[3]||(n.push({start:[o[0],o[1]],end:[o[2],o[3]]}),t=o,e=o[4]);return n},this.setPath=function(t){u=[];for(let e=0;e<t.length;e++){const n=t[e].start[0],i=t[e].start[1],o=t[e].end[0],s=t[e].end[1],r=n===o?"v":"h",l=f(o-n),a=f(s-i);u.push([n,i,o,s,r,l,a])}},this._flowchartConnectorCompute=function(t,e){if(e.clearEdits&&(u=null),null!==u)return void v(this,u,t);r=[],h=null,d=null;const n=t.startStubX+(t.endStubX-t.startStubX)*a,i=t.startStubY+(t.endStubY-t.startStubY)*a,o={x:[0,1],y:[1,0]},s=function(){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},p={perpendicular:s,orthogonal:s,opposite:function(e){const n=t,i="x"===e?0:1;return!c&&{x:function(){return 1===n.so[i]&&(n.startStubX>n.endStubX&&n.tx>n.startStubX||n.sx>n.endStubX&&n.tx>n.sx)||-1===n.so[i]&&(n.startStubX<n.endStubX&&n.tx<n.startStubX||n.sx<n.endStubX&&n.tx<n.sx)},y:function(){return 1===n.so[i]&&(n.startStubY>n.endStubY&&n.ty>n.startStubY||n.sy>n.endStubY&&n.ty>n.sy)||-1===n.so[i]&&(n.startStubY<n.endStubY&&n.ty<n.startStubY||n.sy<n.endStubY&&n.ty<n.sy)}}[e]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}},f=p[t.anchorOrientation](t.sourceAxis),g="x"===t.sourceAxis?0:1,b="x"===t.sourceAxis?1:0,y=f[g],w=f[b],_=f[g+2],j=f[b+2],x={perpendicular:function(e){const s=t,r={x:[[s.startStubX,s.endStubX],null,[s.endStubX,s.startStubX]],y:[[s.startStubY,s.endStubY],null,[s.endStubY,s.startStubY]]},l={x:[[n,s.startStubY],[n,s.endStubY]],y:[[s.startStubX,i],[s.endStubX,i]]},a={x:[[s.endStubX,s.startStubY]],y:[[s.startStubX,s.endStubY]]},c={x:[[s.startStubX,s.endStubY],[s.endStubX,s.endStubY]],y:[[s.endStubX,s.startStubY],[s.endStubX,s.endStubY]]},u={x:[[s.startStubX,i],[s.endStubX,i],[s.endStubX,s.endStubY]],y:[[n,s.startStubY],[n,s.endStubY],[s.endStubX,s.endStubY]]},h={x:[s.startStubY,s.endStubY],y:[s.startStubX,s.endStubX]},d=o[e][0],p=o[e][1],f=s.so[d]+1,m=s.to[p]+1,g=-1===s.to[p]&&h[e][1]<h[e][0]||1===s.to[p]&&h[e][1]>h[e][0],b=r[e][f][0],v=r[e][f][1],y={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[e][f][m];return s.segment===y[3]||s.segment===y[2]&&g?l[e]:s.segment===y[2]&&v<b?a[e]:s.segment===y[2]&&v>=b||s.segment===y[1]&&!g?u[e]:s.segment===y[0]||s.segment===y[1]&&g?c[e]:void 0},orthogonal:function(e,n,i,o,s){const r=t,l={x:-1===r.so[0]?Math.min(n,o):Math.max(n,o),y:-1===r.so[1]?Math.min(n,o):Math.max(n,o)}[e];return{x:[[l,i],[l,s],[o,s]],y:[[i,l],[s,l],[s,o]]}[e]},opposite:function(o,s,r,a){const c=t,u={x:"y",y:"x"}[o],h={x:"height",y:"width"}[o],d=c["is"+o.toUpperCase()+"GreaterThanStubTimes2"];if(e.sourceEndpoint.elementId===e.targetEndpoint.elementId){const t=r+(1-e.sourceEndpoint.anchor[u])*e.sourceInfo[h]+l.maxStub;return{x:[[s,t],[a,t]],y:[[t,s],[t,a]]}[o]}return!d||1===c.so[g]&&s>a||-1===c.so[g]&&s<a?{x:[[s,i],[a,i]],y:[[n,s],[n,a]]}[o]:1===c.so[g]&&s<a||-1===c.so[g]&&s>a?{x:[[n,c.sy],[n,c.ty]],y:[[c.sx,i],[c.tx,i]]}[o]:void 0}};m(r,f[0],f[1],t);const P=x[t.anchorOrientation](t.sourceAxis,y,w,_,j);if(P)for(let e=0;e<P.length;e++)m(r,P[e][0],P[e][1],t);m(r,f[2],f[3],t),m(r,t.tx,t.ty,t),v(this,r,t)}}function l(t,e,...n){let i;for(e="[object Array]"===Object.prototype.toString.call(e)?e:[e],i=0;i<e.length;i++)for(const n in e[i].prototype)e[i].prototype.hasOwnProperty(n)&&(t.prototype[n]=e[i].prototype[n]);const o=function(t,n){return function(...o){for(i=0;i<e.length;i++)e[i].prototype[t]&&e[i].prototype[t].apply(this,o);return n.apply(this,o)}},s=function(e){for(const n in e)e.hasOwnProperty(n)&&(t.prototype[n]=o(n,e[n]))};if(n.length)for(i=0;i<n.length;i++)s(n[i]);return t}return l(r,e.Connectors.AbstractConnector),e.registerConnectorType(r,"Smartline"),o.each(e.getRenderModes(),(function(t){e.Connectors[t].Smartline=function(...n){r.apply(this,n),e.ConnectorRenderers[t].apply(this,n)},l(e.Connectors[t].Smartline,[r,e.ConnectorRenderers[t]])})),r}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/axis.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/interval2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/directions.js"),n("./bundles/oroworkflow/js/tools/path-finder/point2d.js")],void 0===(o=function(t,e,n,i){"use strict";t(a,e);const o=n.TOP_TO_BOTTOM.id,s=n.BOTTOM_TO_TOP.id,r=n.LEFT_TO_RIGHT.id,l=n.RIGHT_TO_LEFT.id;function a(t,n,i,o){void 0===o&&(o=1),e.call(this,t,n),this.clonesAtLeft=[],this.clonesAtRight=[],this.used=!1,this.nodes=[],this.isVertical=this.a.x===this.b.x,this.uid=a.uidCounter++,this.costMultiplier=o,this.graph=i}return a.uidCounter=0,Object.defineProperty(a.prototype,"connections",{get:function(){const t=[],e=this.b.sub(this.a).unitVector.abs().rot180().id;for(let n=this.nodes.length-1;n>=1;n--){const i=this.nodes[n];t.push(i.connections[e])}return t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"closestLeftClone",{get:function(){let t=null,e=this.clonesAtLeft[0];for(;e;)t=e,e=e.clonesAtRight[e.clonesAtRight.length-1];return t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"closestRightClone",{get:function(){let t=null,e=this.clonesAtRight[0];for(;e;)t=e,e=e.clonesAtLeft[e.clonesAtLeft.length-1];return t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allClones",{get:function(){const t=[];let e,n;for(e=0;e<this.clonesAtLeft.length;e++)n=this.clonesAtLeft[e],t.push(...n.allClones);for(t.push(this),e=0;e<this.clonesAtRight.length;e++)n=this.clonesAtRight[e],t.push(...n.allClones);return t},enumerable:!0,configurable:!0}),a.createFromInterval=function(t,e){const n=t.costMultiplier,i=t.isVertical,o=new a(t.a,t.b,e,n);return void 0!==i&&(o.isVertical=i),o},Object.defineProperty(a.prototype,"nextNodeConnVector",{get:function(){return this.isVertical?n.TOP_TO_BOTTOM:n.LEFT_TO_RIGHT},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"prevNodeConnVector",{get:function(){return this.isVertical?n.BOTTOM_TO_TOP:n.RIGHT_TO_LEFT},enumerable:!0,configurable:!0}),a.prototype.addNode=function(t){this.isVertical?t.vAxis=this:t.hAxis=this,-1===this.nodes.indexOf(t)&&this.nodes.push(t)},a.prototype.addFinalNode=function(t){const e=this.nextNodeConnVector;let n,i;if(n=t.connections[e.id]){const e=n.second(t),i=this.nodes.indexOf(e);if(-1===i)throw new Error("Invalid add node call");this.nodes.splice(i,0,t)}else{if(!(i=t.connections[this.prevNodeConnVector.id]))throw new Error("Node should be connected before addition");{const e=i.second(t),n=this.nodes.indexOf(e);if(-1===n)throw new Error("Invalid add node call");this.nodes.splice(n+1,0,t)}}},a.prototype.finalize=function(){const t=this.nodes[0],e=this.nodes[this.nodes.length-1];let i,a;if(this.isVertical)for(t.connections[o]&&t.connections[o].remove(),e.connections[s]&&e.connections[s].remove(),a=this.nodes.length-1;a>=0;a--)i=this.nodes[a],i.vAxis=this,i.connect(n.BOTTOM_TO_TOP,this.nodes[a-1]);else for(t.connections[r]&&t.connections[r].remove(),e.connections[l]&&e.connections[l].remove(),a=this.nodes.length-1;a>=0;a--)i=this.nodes[a],i.hAxis=this,i.connect(n.RIGHT_TO_LEFT,this.nodes[a-1])},a.prototype.sortNodes=function(){this.nodes.sort((function(t,e){return t.x-e.x+t.y-e.y}))},a.prototype.merge=function(t){const e=[this.a,this.b,t.a,t.b];e.sort((function(t,e){return t.x-e.x+t.y-e.y})),this.a=e[0],this.b=e[e.length-1]},a.prototype.cloneAtDirection=function(t){const e=a.createFromInterval(this,this.graph);for(let n=0;n<this.nodes.length;n++){const i=this.nodes[n],o=i.clone(),s=i.nextNode(t);i.used&&s.used&&(o.used=!0),i.connect(t,o),s&&o.connect(t,s),this.isVertical?i.hAxis.addFinalNode(o):i.vAxis.addFinalNode(o),e.addNode(o)}return e.finalize(),e},a.prototype.ensureTraversableSiblings=function(){let t;t=this.closestLeftClone,t&&!t.isUsed||this.clonesAtLeft.unshift(this.cloneAtDirection(this.nextNodeConnVector.rot90().abs().rot180())),t=this.closestRightClone,t&&!t.isUsed||this.clonesAtRight.unshift(this.cloneAtDirection(this.nextNodeConnVector.rot90().abs()))},a.prototype.draw=function(t){void 0===t&&(t="green"),this.nodes.length?new e(new i(this.nodes[0].recommendedX,this.nodes[0].recommendedY),new i(this.nodes[this.nodes.length-1].recommendedX,this.nodes[this.nodes.length-1].recommendedY)).draw(t):e.prototype.draw.call(this,t)},a}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/base-axis.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/axis.js")],void 0===(o=function(t,e){"use strict";function n(t,n,i,o,s,r,l){e.call(this,t,n,i,o),this.linesIncluded=1,s.axis=this,r.axis=this,l.axis=this,this.leftConstraint=s,this.rightConstraint=r,this.locationDirective=l}return t(n,e),n.createFromInterval=function(t,e,i,o,s){const r=t.costMultiplier,l=t.isVertical,a=new n(t.a,t.b,e,r,i,o,s);return void 0!==l&&(a.isVertical=l),a},n}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/complexity-error.js":(t,e,n)=>{var i;void 0===(i=function(){"use strict";function t(e,n,i){const o=new Error(e,n,i);return Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,t),o}return t.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),t}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/connection.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/interval2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/node-point.js"),n("./bundles/oroworkflow/js/tools/path-finder/point2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/settings.js")],void 0===(o=function(t,e,n,i,o){"use strict";function s(t,n,i){e.call(this,t,n),this.costMultiplier=1,this.traversable=!0,this.uid=s.uidCounter++,i||(i=n.sub(t).unitVector),this.vector=i;const r=i.id;t.connections[r]=this,n.connections[-r]=this,this.axis.graph.isConnectionUnderRect(this)&&(this.costMultiplier*=o.overBlockLineCostMultiplier)}return t(s,e),s.uidCounter=0,Object.defineProperty(s.prototype,"cost",{get:function(){return this.length*this.axis.costMultiplier*this.costMultiplier+(this.a.used||this.b.used?o.crossPathCost:0)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"axis",{get:function(){return this.a.vAxis===this.b.vAxis?this.a.vAxis:this.a.hAxis},enumerable:!0,configurable:!0}),s.prototype.remove=function(){const t=this.vector.id;this.a.connections[t]===this&&(this.a.connections[t]=null),this.b.connections[-t]===this&&(this.b.connections[-t]=null)},s.prototype.second=function(t){return t===this.a?this.b:t===this.b?this.a:void 0},s.prototype.directionFrom=function(t){return t===this.a?this.vector:t===this.b?this.vector.rot180():void 0},s.prototype.draw=function(t){void 0===t&&(t="green"),new e(new i(this.a.recommendedX,this.a.recommendedY),new i(this.b.recommendedX,this.b.recommendedY)).draw(t)},s}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/constraint/simple/abstract-simple-constraint.js":(t,e,n)=>{var i;void 0===(i=function(){"use strict";return function(){this.recomendedStart=void 0}}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/constraint/simple/empty-constraint.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/constraint/simple/abstract-simple-constraint.js")],void 0===(o=function(t,e){"use strict";function n(...t){e.apply(this,t)}return t(n,e),Object.defineProperty(n.prototype,"recommendedEnd",{get:function(){},enumerable:!0,configurable:!0}),n}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/constraint/simple/left-simple-constraint.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/constraint/simple/abstract-simple-constraint.js"),n("./bundles/oroworkflow/js/tools/path-finder/settings.js")],void 0===(o=function(t,e,n){"use strict";function i(t){e.call(this),this.recomendedStart=t}return t(i,e),Object.defineProperty(i.prototype,"recommendedEnd",{get:function(){return this.recomendedStart+this.axis.linesIncluded*n.recommendedConnectionWidth},enumerable:!0,configurable:!0}),i}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/constraint/simple/right-simple-constraint.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/constraint/simple/abstract-simple-constraint.js"),n("./bundles/oroworkflow/js/tools/path-finder/settings.js")],void 0===(o=function(t,e,n){"use strict";function i(t){e.call(this),this.recomendedStart=t}return t(i,e),Object.defineProperty(i.prototype,"recommendedBound",{get:function(){return this.recomendedStart+this.axis.linesIncluded*n.recommendedConnectionWidth},enumerable:!0,configurable:!0}),i}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/directions.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/point2d.js")],void 0===(o=function(t){"use strict";return{LEFT_TO_RIGHT:new t(1,0),RIGHT_TO_LEFT:new t(-1,0),TOP_TO_BOTTOM:new t(0,1),BOTTOM_TO_TOP:new t(0,-1)}}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/draw.js":(t,e,n)=>{var i;void 0===(i=function(){"use strict";function t(t,e){let n=document.getElementById("drawing-overlay");if(n||document.querySelector(".workflow-flowchart-editor, .workflow-flowchart").insertAdjacentHTML("beforeEnd",'<div style="position: absolute; width: 100%; height: 100%; top: 0; z-index: 100000;" id="drawing-overlay"></div>'),n=document.getElementById("drawing-overlay"),e){const n=[];for(const t in e)e.hasOwnProperty(t)&&n.push(t+": "+e[t]+"px");n.push("position: absolute"),t='<svg style="'+n.join("; ")+'">'+t+"</svg>"}n.insertAdjacentHTML("beforeEnd",t)}return t.clear=function(){const t=document.getElementById("drawing-overlay");t&&t.remove()},t.line=function(e,n,i){const o=Math.min(e.x,n.x),s=Math.min(e.y,n.y),r=e.x===o?n.x-o:0,l=n.x===o?e.x-o:0,a=e.y===s?n.y-s:0,c=n.y===s?e.y-s:0;t('<path stroke-width="1" stroke="'+i+'" fill="none" d="M '+r+" "+a+" L "+l+" "+c+'"></path>',{top:s,left:o,width:Math.abs(r-l)+1,height:Math.abs(a-c)+1})},t.circle=function(e,n,i){t('<circle fill="'+i+'" r="'+n+'" cx="'+n+'" cy="'+n+'"></circle>',{top:e.y-n,left:e.x-n})},t.text=function(e,n,i){t('<svg style="position:absolute;width:1000px;height:1000px;"><text x="'+e.x+'" y="'+e.y+'" fill="'+n+'" font-size="10">'+i+"</text></svg>")},t}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/extends.js":(t,e,n)=>{var i;void 0===(i=function(){"use strict";return function(t,e){for(const n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/finder.js":(t,e,n)=>{var i;i=function(t,e,i){"use strict";const o=n("./bundles/oroworkflow/js/tools/path-finder/settings.js"),s=n("./bundles/oroworkflow/js/tools/path-finder/path.js"),r=n("./bundles/oroworkflow/js/tools/path-finder/directions.js"),l=n("./bundles/oroworkflow/js/tools/path-finder/complexity-error.js"),a=n("./bundles/oroui/js/app/services/module-config.js").A(i.id).MAX_COMPLEXITY_NUMBER||8e4,c=[r.BOTTOM_TO_TOP.id,r.TOP_TO_BOTTOM.id,r.LEFT_TO_RIGHT.id,r.RIGHT_TO_LEFT.id],u={};for(let t=c.length-1;t>=0;t--)u[c[t]]=t;function h(){this.from=[],this.to=[]}return h.prototype.addFrom=function(t){if(!this.to.length)throw new Error("Please add required destination before this call (use addTo())");const e=t.getSiblings();for(let t=e.length-1;t>=0;t--)this.internalAddFrom(e[t])},h.prototype.binarySearch=function(t){let e=-1,n=this.from.length;for(;n-e>1;){const i=Math.floor((e+n)/2);this.from[i].heuristic>t?n=i:e=i}return e},h.prototype.internalAddFrom=function(t){t.heuristic=this.getHeuristic(t);const e=this.binarySearch(t.heuristic);this.from.splice(e+1,0,t)},h.prototype.addTo=function(t){this.to.push(...t.getSiblings())},h.prototype.find=function(){let t,e,n,i=0;const o=this.from,r=this.to,h=[];for(this.filterNonTraversablePathes(o),this.filterNonTraversablePathes(r);n=o.shift();){if(h[n.uid])continue;for(t=0;t<r.length;t++)n.canJoinWith(r[t])&&(e=n);if(e)break;if(i>a)throw new l("Maximum iterations limit reached. heu="+n.heuristic);i++,h[n.uid]=!0;const o=n.toNode;for(t=0;t<c.length;t++){const e=o.connections[c[t]];if(e&&e!==n&&e.traversable){const t=e===o?e.vector.id:-e.vector.id;if(h[8*o.uid+u[t]])continue;this.internalAddFrom(new s(e,o,n))}}}return this.operationsCount=i,e},h.prototype.filterNonTraversablePathes=function(t){for(let e=t.length-1;e>=0;e--){const n=t[e];n.connection.a.used&&n.connection.b.used&&(t.splice(e,1),e--)}},h.prototype.getHeuristic=function(t){let e,n=this.to[0].toNode.simpleDistanceTo(t.toNode),i=0;for(let o=this.to.length-1;o>=0;o--)if(t.canJoinWith(this.to[o])){i=t.connection.cost,n=0,e=0;break}if(void 0===e){const n=t.toNode,i=this.to[0].toNode,o=i.sub(n);Math.abs(o.x)<1e-5&&(o.x=0),Math.abs(o.y)<1e-5&&(o.y=0),o.x=Math.sign(o.x),o.y=Math.sign(o.y);const s=t.connection.directionFrom(t.fromNode),r=this.to[0].connection.directionFrom(i);e=s.x===r.x&&s.y===r.y?0===s.x&&(0===o.y||o.y===s.y)||0===s.y&&(0===o.x||o.x===s.x)?0===s.x&&0===o.x||0===s.y&&0===o.y?0:2:4:s.x===-r.x&&s.y===-r.y?0===s.x&&0===o.x||0===s.y&&0===o.y?4:2:0===s.x&&(0===o.y||s.y===o.y&&(r.x===o.x||0===o.x))||0===s.y&&(0===o.x||s.x===o.x&&(r.y===o.y||0===o.y))?1:3}return t.cost+1.00000001*n+-i+e*o.optimizationCornerCost},h}.call(e,n,e,t),void 0===i||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/graph.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/settings.js"),n("./bundles/oroworkflow/js/tools/path-finder/directions.js"),n("./bundles/oroworkflow/js/tools/path-finder/vector2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/constraint/simple/empty-constraint.js"),n("./bundles/oroworkflow/js/tools/path-finder/constraint/simple/left-simple-constraint.js"),n("./bundles/oroworkflow/js/tools/path-finder/constraint/simple/right-simple-constraint.js"),n("./bundles/oroworkflow/js/tools/path-finder/location-directive/stick-left-location-directive.js"),n("./bundles/oroworkflow/js/tools/path-finder/location-directive/stick-right-location-directive.js"),n("./bundles/oroworkflow/js/tools/path-finder/location-directive/center-location-directive.js"),n("./bundles/oroworkflow/js/tools/path-finder/rectangle.js"),n("./bundles/oroworkflow/js/tools/path-finder/base-axis.js"),n("./bundles/oroworkflow/js/tools/path-finder/point2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/path.js"),n("./bundles/oroworkflow/js/tools/path-finder/interval2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/line2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/node-point.js")],void 0===(o=function(t,e,n,i,o,s,r,l,a,c,u,h,d,p,f,m){"use strict";function g(){this.rectangles=[],this.baseAxises=[],this.horizontalAxises=[],this.verticalAxises=[],this.nodes={},this.mergeAxisesQueue=[],this.axisesConnectedAtLeft=[],this.axisesConnectedAtRight=[],this.centerLineMinimalRequiredWidth=32}return g.prototype.build=function(){this.outerRect=this.rectangles.slice(1).reduce((function(t,e){return e.union(t)}),this.rectangles[0].clone()),this.baseAxises.push(u.createFromInterval(this.outerRect.topSide,this,new i,new s(this.outerRect.top),new l),u.createFromInterval(this.outerRect.bottomSide,this,new o(this.outerRect.bottom),new i,new r),u.createFromInterval(this.outerRect.leftSide,this,new i,new s(this.outerRect.left),new l),u.createFromInterval(this.outerRect.rightSide,this,new o(this.outerRect.right),new i,new r)),this.buildCenterAxises(),this.buildCenterLinesBetweenNodes(),this.mergeExtraCenterAxises(),this.createAxises(),this.buildMergeRequests(),this.mergeAxises(),this.buildNodes(),this.finalizeAxises()},g.prototype.getPathFromCid=function(t,e){return this.getPathFrom(this.getRectByCid(t),e)},g.prototype.getPathFrom=function(t,n){const i=t.center;let o;switch(n.id){case e.BOTTOM_TO_TOP.id:o=this.getNodeAt(new h(i.x,i.y-1));break;case e.TOP_TO_BOTTOM.id:o=this.getNodeAt(new h(i.x,i.y+1));break;case e.LEFT_TO_RIGHT.id:o=this.getNodeAt(new h(i.x+1,i.y));break;case e.RIGHT_TO_LEFT.id:o=this.getNodeAt(new h(i.x-1,i.y));break;default:throw new Error("Not supported direction")}if(void 0===o.connections[n.id]||null===o.connections[n.id])throw new Error("Path not found. Node at ("+o.x+", "+o.y+"), direction("+n.x+", "+n.y+")");return new d(o.connections[n.id],o,null)},g.prototype.getRectByCid=function(t){for(let e=0;e<this.rectangles.length;e++){const n=this.rectangles[e];if(n.cid===t)return n}return null},g.prototype.draw=function(){let t;function e(t){return t.draw("cyan")}for(this.outerRect.draw("red"),t=this.horizontalAxises.length-1;t>=0;t--)this.horizontalAxises[t].allClones.forEach(e);for(t=this.verticalAxises.length-1;t>=0;t--)this.verticalAxises[t].allClones.forEach(e);for(t=this.rectangles.length-1;t>=0;t--)this.rectangles[t].draw("black");for(const t in this.nodes)this.nodes.hasOwnProperty(t)&&this.nodes[t].draw("black")},g.prototype.createAxises=function(){for(let t=0;t<this.baseAxises.length;t++){const e=this.baseAxises[t];e.isVertical?this.verticalAxises.push(e):e.a.y===e.b.y&&this.horizontalAxises.push(e)}},g.prototype.removeAxis=function(t){let e;-1===(e=this.horizontalAxises.indexOf(t))?-1!==(e=this.verticalAxises.indexOf(t))&&this.verticalAxises.splice(e,1):this.horizontalAxises.splice(e,1)},g.prototype.mergeAxises=function(){let t,e;for(t=0;t<this.mergeAxisesQueue.length;t++){const n=this.mergeAxisesQueue[t];for(e=n.length-1;e>=1;e--)n[e-1].merge(n[e]),this.removeAxis(n[e])}},g.prototype.finalizeAxises=function(){let t;for(t=this.verticalAxises.length-1;t>=0;t--)this.verticalAxises[t].sortNodes(),this.verticalAxises[t].finalize();for(t=this.horizontalAxises.length-1;t>=0;t--)this.horizontalAxises[t].sortNodes(),this.horizontalAxises[t].finalize();this.verticalAxises.sort((function(t,e){return t.a.x-e.a.x})),this.horizontalAxises.sort((function(t,e){return t.a.y-e.a.y}))},g.prototype.buildAxisConnectionInfo=function(){let t,n,i,o,s,r,l,a;for(t=0;t<this.horizontalAxises.length;t++)for(a=this.horizontalAxises[t],n=a.nodes.length-1;n>=0;n--)i=a.nodes[n],o=i.connections[e.TOP_TO_BOTTOM.id],s=o?o.second(i):null,r=i.connections[e.BOTTOM_TO_TOP.id],l=r?r.second(i):null,s&&this.addAxisConnectionInfo(this.axisesConnectedAtLeft,a,s.hAxis),l&&this.addAxisConnectionInfo(this.axisesConnectedAtRight,a,l.hAxis);for(t=0;t<this.verticalAxises.length;t++)for(a=this.verticalAxises[t],n=a.nodes.length-1;n>=0;n--)i=a.nodes[n],o=i.connections[e.RIGHT_TO_LEFT.id],s=o?o.second(i):null,r=i.connections[e.LEFT_TO_RIGHT.id],l=r?r.second(i):null,s&&this.addAxisConnectionInfo(this.axisesConnectedAtLeft,a,s.vAxis),l&&this.addAxisConnectionInfo(this.axisesConnectedAtRight,a,l.vAxis)},g.prototype.addAxisConnectionInfo=function(t,e,n){t[e.uid]||(t[e.uid]=[]),-1===t[e.uid].indexOf(n)&&t[e.uid].push(n)},g.prototype.buildCornerAxises=function(){for(let t=this.rectangles.length-1;t>=0;t--){const a=this.rectangles[t],c=[{vectorA:new n(a.left,a.top,e.TOP_TO_BOTTOM),vectorB:new n(a.left,a.bottom,e.BOTTOM_TO_TOP),leftConstraint:new i,rightConstraint:new s(a.left),locationDirective:new l},{vectorA:new n(a.right,a.top,e.TOP_TO_BOTTOM),vectorB:new n(a.right,a.bottom,e.BOTTOM_TO_TOP),leftConstraint:new o(a.right),rightConstraint:new i,locationDirective:new r},{vectorA:new n(a.left,a.top,e.RIGHT_TO_LEFT),vectorB:new n(a.right,a.top,e.LEFT_TO_RIGHT),leftConstraint:new i,rightConstraint:new s(a.top),locationDirective:new l},{vectorA:new n(a.left,a.bottom,e.RIGHT_TO_LEFT),vectorB:new n(a.right,a.bottom,e.LEFT_TO_RIGHT),leftConstraint:new o(a.bottom),rightConstraint:new i,locationDirective:new r}];for(let t=c.length-1;t>=0;t--){const e=c[t],n=this.findClosestRectCross(e.vectorA,a),i=this.findClosestRectCross(e.vectorB,a);this.baseAxises.push(u.createFromInterval(new p(n,i),this,e.leftConstraint,e.rightConstraint,e.locationDirective))}}},g.prototype.buildCenterAxises=function(){for(let t=this.rectangles.length-1;t>=0;t--){const i=this.rectangles[t],r=i.center,l=[{vector:new n(r.x,r.y+1,e.TOP_TO_BOTTOM),leftConstraint:new o(i.left),rightConstraint:new s(i.right),locationDirective:new a},{vector:new n(r.x,r.y-1,e.BOTTOM_TO_TOP),leftConstraint:new o(i.left),rightConstraint:new s(i.right),locationDirective:new a},{vector:new n(r.x+1,r.y,e.LEFT_TO_RIGHT),leftConstraint:new o(i.top),rightConstraint:new s(i.bottom),locationDirective:new a},{vector:new n(r.x-1,r.y,e.RIGHT_TO_LEFT),leftConstraint:new o(i.top),rightConstraint:new s(i.bottom),locationDirective:new a}];for(let t=l.length-1;t>=0;t--){const e=l[t],n=this.findClosestRectCross(e.vector,i),o=new u(e.vector.start,n,this,1,e.leftConstraint,e.rightConstraint,e.locationDirective);this.baseAxises.push(o)}}},g.prototype.eachRectanglePair=function(t){for(let e=this.rectangles.length-1;e>0;e--){const n=this.rectangles[e];for(let i=e-1;i>=0;i--)t(n,this.rectangles[i])}},g.prototype.buildCenterLinesBetweenNodes=function(){this.eachRectanglePair(function(t,e){t.top>e.bottom&&t.top-e.bottom>this.centerLineMinimalRequiredWidth&&this.buildSingleCenterLine(t,e,(t.top+e.bottom)/2,t.topSide,e.bottomSide,t.top,e.bottom),e.top>t.bottom&&e.top-t.bottom>this.centerLineMinimalRequiredWidth&&this.buildSingleCenterLine(t,e,(e.top+t.bottom)/2,e.topSide,t.bottomSide,e.top,t.bottom),t.left>e.right&&t.left-e.right>this.centerLineMinimalRequiredWidth&&this.buildSingleCenterLine(t,e,(t.left+e.right)/2,t.leftSide,e.rightSide,t.left,e.right),e.left>t.right&&e.left-t.right>this.centerLineMinimalRequiredWidth&&this.buildSingleCenterLine(t,e,(e.left+t.right)/2,e.leftSide,t.rightSide,e.left,t.right)}.bind(this))},g.prototype.mergeExtraCenterAxises=function(){const e=this.centerLineMinimalRequiredWidth;this.baseAxises.filter((function(t){return t.leftConstraint instanceof o&&t.rightConstraint instanceof s&&t.locationDirective instanceof a})).reduce((function(t,n,i,o){let s,r;const l=n.isVertical?"y":"x",a=n.isVertical?"x":"y";for(let t=o.length-1;t>i&&!r;t--)o[t].a[l]===n.a[l]&&o[t].b[l]===n.b[l]&&Math.max(o[t].a[a],n.a[a])-Math.min(o[t].a[a],n.a[a])<=e&&(r=o[t]);if(r){for(let e=0;e<t.length;e++)if(-1!==t[e].indexOf(r)){s=t[e];break}s?s.push(n):t.push([n,r])}return t}),[]).forEach(function(e){const n=e[0],i=e.slice(1).reduce((function(t,e){return{left:Math.min(e.leftConstraint.recomendedStart,t.left),right:Math.max(e.rightConstraint.recomendedStart,t.right)}}),{left:n.leftConstraint.recomendedStart,right:n.rightConstraint.recomendedStart});e.forEach(function(t){this.baseAxises.splice(this.baseAxises.indexOf(t),1)}.bind(this));const r={},l={},c=n.isVertical?"y":"x",d=n.isVertical?"x":"y";r[c]=n.a[c],l[c]=n.b[c],r[d]=l[d]=i.left+(i.right-i.left)/2,this.baseAxises.push(new u(new h(r.x,r.y),new h(l.x,l.y),this,t.centerAxisCostMultiplier,new o(i.left),new s(i.right),new a))}.bind(this))},g.prototype.buildSingleCenterLine=function(e,i,r,l,h,d,p){const m=new n(l.center.x,l.center.y,l.a.sub(l.b).rot270().unitVector),g=new n(h.center.x,h.center.y,h.a.sub(h.b).rot90().unitVector),b=new c(Math.min(l.center.x,h.center.x),Math.min(l.center.y,h.center.y),1,1);let v;if(b.right=Math.max(l.center.x,h.center.x),b.bottom=Math.max(l.center.y,h.center.y),this.rectangleIntersectsAnyRectangle(b))return;v=0===m.direction.x?new f(0,r):new f(1/0,r);const y=v.intersection(m.line),w=v.intersection(g.line),_=new n(y.x,y.y,m.direction.rot90()),j=new n(w.x,w.y,g.direction.rot90()),x=this.findClosestRectCross(_,null),P=this.findClosestRectCross(j,null);this.baseAxises.push(new u(x,P,this,t.centerAxisCostMultiplier,new o(d),new s(p),new a))},g.prototype.buildNodes=function(){let t,e,n,i,o,s;for(e=this.horizontalAxises.length-1;e>=0;e--)for(i=this.horizontalAxises[e],n=this.verticalAxises.length-1;n>=0;n--)o=this.verticalAxises[n],s=i.getCrossPoint(o),s&&(t=this.getNodeAt(s),i.addNode(t),o.addNode(t),t.hAxis=i,t.vAxis=o,t.stale=!0);this.buildNodesAtEndPoints()},g.prototype.buildNodesAtEndPoints=function(){const t=this.buildNodesAtEndPointsVertical(),e=this.buildNodesAtEndPointsHorizontal();this.verticalAxises.push(...t),this.horizontalAxises.push(...e)},g.prototype.buildNodesAtEndPointsHorizontal=function(){let t,e,n,o;const s=[];for(n=this.horizontalAxises.length-1;n>=0;n--)o=this.horizontalAxises[n],t=this.getNodeAt(o.a),t.stale||(e=new u(o.a,o.a,this,0,new i,new i,new a),e.isVertical=!0,s.push(e),o.addNode(t),e.addNode(t),t.hAxis=o,t.vAxis=e),t=this.getNodeAt(o.b),t.stale||(e=new u(o.b,o.b,this,0,new i,new i,new a),e.isVertical=!0,s.push(e),o.addNode(t),e.addNode(t),t.hAxis=o,t.vAxis=e);return s},g.prototype.buildNodesAtEndPointsVertical=function(){let t,e,n,o;const s=[];for(n=this.verticalAxises.length-1;n>=0;n--)o=this.verticalAxises[n],t=this.getNodeAt(o.a),t.stale||(e=new u(o.a,o.a,this,0,new i,new i,new a),e.isVertical=!1,s.push(e),o.addNode(t),e.addNode(t),t.hAxis=e,t.vAxis=o),t=this.getNodeAt(o.b),t.stale||(e=new u(o.b,o.b,this,0,new i,new i,new a),e.isVertical=!1,s.push(e),o.addNode(t),e.addNode(t),t.hAxis=e,t.vAxis=o);return s},g.prototype.buildMergeRequests=function(){for(let t=this.horizontalAxises.length-1;t>=0;t--){const e=this.horizontalAxises[t];for(let t=this.verticalAxises.length-1;t>=0;t--){const n=this.verticalAxises[t],i=e.getCrossPoint(n);if(i){const t=this.getNodeAt(i);t.stale&&(t.hAxis!==e&&this.addMergeRequest(t.hAxis,e),t.vAxis!==n&&this.addMergeRequest(t.vAxis,n)),t.hAxis=e,t.vAxis=n,t.stale=!0}}}},g.prototype.addMergeRequest=function(t,e){let n,i,o,s;for(o=this.mergeAxisesQueue.length-1;o>=0;o--)if(s=this.mergeAxisesQueue[o],-1!==s.indexOf(t)){n=s;break}for(o=this.mergeAxisesQueue.length-1;o>=0;o--)if(s=this.mergeAxisesQueue[o],-1!==s.indexOf(e)){i=s;break}void 0!==n&&n===i||(n?i?(n.push(...i),this.mergeAxisesQueue.splice(this.mergeAxisesQueue.indexOf(i),1)):n.push(e):i?i.push(t):this.mergeAxisesQueue.push([t,e]))},g.prototype.getNodeAt=function(t){let e=this.nodes[t.id];return e||(e=new m(t.x,t.y),this.nodes[t.id]=e),e},g.prototype.findClosestRectCross=function(t,e){let n=1/0,i=null;for(let o=this.rectangles.length-1;o>=0;o--){const s=this.rectangles[o];if(s===e)continue;const r=t.getCrossPointWithRect(s);r&&n>r.distanceTo(t.start)&&(i=r,n=r.distanceTo(t.start))}return n===1/0&&this.outerRect.eachSide((function(e){let o;(o=t.getCrossPointWithInterval(e))&&t.start.distanceTo(o)<n&&(i=o,n=t.start.distanceTo(o))})),n===1/0?t.start:i},g.prototype.rectangleIntersectsAnyRectangle=function(t,e){for(let n=this.rectangles.length-1;n>=0;n--){if(this.rectangles[n]===e)continue;const i=t.intersection(this.rectangles[n]);if(null!==i&&0!==i.width&&0!==i.height)return!0}return!1},g.prototype.updateWithPath=function(e){let n=e.allConnections;const i=[];let o,s,r;for(o=0;o<n.length;o++)s=n[o],-1===i.indexOf(s.axis)&&(i.push(s.axis),s.axis.ensureTraversableSiblings(),s.axis.used=!0,s.axis.costMultiplier*=t.usedAxisCostMultiplier);for(n=e.allConnections,o=0;o<n.length;o++)s=n[o],s.traversable=!1,s.a.used=!0,s.b.used=!0,r&&s.vector.id!==r.vector.id&&(s.a===r.a||s.a===r.b?s.a:s.b).eachConnection((function(t){t.traversable=!1})),r=s},g.prototype.locateAxises=function(){let t,e,n,i,o,s;for(t=this.verticalAxises.length-1;t>=0;t--)if(n=this.verticalAxises[t],i=n.allClones,n.linesIncluded=Math.floor(i.length/2),n.linesIncluded>0)for(o=0,e=0;e<i.length;e++)s=i[e],s.recommendedPosition=n.locationDirective.getRecommendedPosition(o),o+=.5;for(t=this.horizontalAxises.length-1;t>=0;t--)if(n=this.horizontalAxises[t],i=n.allClones,n.linesIncluded=Math.floor(i.length/2),n.linesIncluded>0)for(o=0,e=0;e<i.length;e++)s=i[e],s.recommendedPosition=n.locationDirective.getRecommendedPosition(o),o+=.5},g.prototype.isConnectionUnderRect=function(t){for(let e=this.rectangles.length-1;e>=0;e--){const n=this.rectangles[e];if(n.containsPoint(t.a)||n.containsPoint(t.b))return!0}return!1},g}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/interval1d.js":(t,e,n)=>{var i;void 0===(i=function(){"use strict";function t(t,e){if(t>e)throw new RangeError("Start of interval shouldn't be more that its end");this.min=t,this.max=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this.max-this.min},set:function(t){this.max=t+this.min},enumerable:!0,configurable:!0}),t.prototype.intersection=function(e){const n=Math.max(this.min,e.min),i=Math.min(this.max,e.max);return n>i?null:new t(n,i)},t.prototype.union=function(e){return new t(Math.min(this.min,e.min),Math.max(this.max,e.max))},t.prototype.contains=function(t){return!(t<this.min)&&t<=this.max},t.prototype.containsNonInclusive=function(t){return!(t<=this.min)&&t<this.max},t.prototype.distanceTo=function(t){return t<this.min?this.min-t:t>this.max?t-this.max:0},t}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/interval2d.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/tools/path-finder/util.js"),i=n("./bundles/oroworkflow/js/tools/path-finder/line2d.js"),o=n("./bundles/oroworkflow/js/tools/path-finder/draw.js");function s(t,e){this.a=t,this.b=e}return Object.defineProperty(s.prototype,"a",{get:function(){return this._a},set:function(t){delete this._length,delete this._simpleLength,delete this._line,delete this._center,this._a=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"b",{get:function(){return this._b},set:function(t){delete this._length,delete this._simpleLength,delete this._line,delete this._center,this._b=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"length",{get:function(){return void 0===this._length&&(this._length=this.a.distanceTo(this.b)),this._length},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"simpleLength",{get:function(){return void 0===this._simpleLength&&(this._simpleLength=this.a.simpleDistanceTo(this.b)),this._simpleLength},enumerable:!0,configurable:!0}),s.prototype.crosses=function(t){return null!==this.getCrossPoint(t)},s.prototype.getCrossPoint=function(t){if(0===t.simpleLength)return this.includesPoint(t.a)?t.a:null;if(0===this.simpleLength)return t.includesPoint(this.a)?this.a:null;const n=this.line.intersection(t.line);if(!isNaN(n.x)){let i,o;if(i=this.a.x!==this.b.x?e.between(n.x,this.a.x,this.b.x):e.between(n.y,this.a.y,this.b.y),o=t.a.x!==t.b.x?e.between(n.x,t.a.x,t.b.x):e.between(n.y,t.a.y,t.b.y),i&&o)return n}return null},s.prototype.includesPoint=function(t){const n=this.line;return n.slope===1/0?t.x===this.a.x&&e.between(t.y,this.a.y,this.b.y):e.between(t.x,this.a.x,this.b.x)&&t.y===n.intercept+t.x*n.slope},s.prototype.crossesRect=function(t){return t.topSide.crosses(this)||t.bottomSide.crosses(this)||t.leftSide.crosses(this)||t.rightSide.crosses(this)},Object.defineProperty(s.prototype,"line",{get:function(){if(this._line)return this._line;const t=(this.a.y-this.b.y)/(this.a.x-this.b.x);return this._line=t===1/0||t===-1/0?new i(1/0,this.a.x):new i(t,this.a.y-this.a.x*t),this._line},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"center",{get:function(){return void 0===this._center&&(this._center=this.a.add(this.b).mul(.5)),this._center},enumerable:!0,configurable:!0}),s.prototype.draw=function(t){void 0===t&&(t="green"),o.line(this.a,this.b,t)},s}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/line2d.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/point2d.js")],void 0===(o=function(t){"use strict";function e(t,e){this.slope=t,this.intercept=e}return e.prototype.intersection=function(e){if(this.slope===1/0)return e.slope===1/0?new t(NaN,NaN):new t(this.intercept,e.intercept+e.slope*this.intercept);if(e.slope===1/0)return new t(e.intercept,this.intercept+this.slope*e.intercept);const n=(e.intercept-this.intercept)/(this.slope-e.slope),i=this.slope*n+this.intercept;return new t(n,i)},e}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/location-directive/abstract-location-directive.js":(t,e,n)=>{var i;void 0===(i=function(){"use strict";function t(){}return t.prototype.getRecommendedPosition=function(){throw new Error("That's abstract method")},t}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/location-directive/center-location-directive.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/location-directive/abstract-location-directive.js"),n("./bundles/oroworkflow/js/tools/path-finder/settings.js")],void 0===(o=function(t,e,n){"use strict";function i(...t){e.apply(this,t)}return t(i,e),i.prototype.getRecommendedPosition=function(t){return(this.axis.isVertical?this.axis.a.x:this.axis.a.y)-this.axis.linesIncluded*n.recommendedConnectionWidth/2+n.recommendedConnectionWidth*t},i}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/location-directive/stick-left-location-directive.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/location-directive/abstract-location-directive.js"),n("./bundles/oroworkflow/js/tools/path-finder/settings.js")],void 0===(o=function(t,e,n){"use strict";function i(...t){e.apply(this,t)}return t(i,e),i.prototype.getRecommendedPosition=function(t){return(this.axis.isVertical?this.axis.a.x:this.axis.a.y)+n.recommendedConnectionWidth*(t+.5)},i}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/location-directive/stick-right-location-directive.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/location-directive/abstract-location-directive.js"),n("./bundles/oroworkflow/js/tools/path-finder/settings.js")],void 0===(o=function(t,e,n){"use strict";function i(...t){e.apply(this,t)}return t(i,e),i.prototype.getRecommendedPosition=function(t){return(this.axis.isVertical?this.axis.a.x:this.axis.a.y)-(this.axis.linesIncluded+.5)*n.recommendedConnectionWidth+n.recommendedConnectionWidth*t},i}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/node-point.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/extends.js"),n("./bundles/oroworkflow/js/tools/path-finder/point2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/directions.js"),n("./bundles/oroworkflow/js/tools/path-finder/connection.js")],void 0===(o=function(t,e,n,i){"use strict";const o=[n.BOTTOM_TO_TOP.id,n.TOP_TO_BOTTOM.id,n.LEFT_TO_RIGHT.id,n.RIGHT_TO_LEFT.id];function s(t,n){e.call(this,t,n),this.connections={},this.stale=!1,this.used=!1}return t(s,e),Object.defineProperty(s.prototype,"recommendedX",{get:function(){if(this.vAxis){const t=this.vAxis.recommendedPosition;if(void 0!==t)return t}return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"recommendedY",{get:function(){if(this.hAxis){const t=this.hAxis.recommendedPosition;if(void 0!==t)return t}return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"recommendedPoint",{get:function(){return new e(this.recommendedX,this.recommendedY)},enumerable:!0,configurable:!0}),s.prototype.connect=function(t,e){this.connections[t.id]&&this.connections[t.id].remove(),e&&new i(this,e,t)},s.prototype.eachConnection=function(t){for(let e=0;e<o.length;e++){const n=this.connections[o[e]];n&&t(n)}},s.prototype.eachTraversableConnection=function(t,e){for(let n=0;n<o.length;n++){const i=this.connections[o[n]];i&&i!==t&&i.traversable&&e(i.second(this),i)}},s.prototype.clone=function(){const t=new s(this.x,this.y);return t.vAxis=this.vAxis,t.hAxis=this.hAxis,t},s.prototype.nextNode=function(t){const e=this.connections[t.id];return e?e.second(this):null},s.prototype.draw=function(t,e){this.recommendedPoint.draw(t,e)},s}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/path.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/directions.js"),n("./bundles/oroworkflow/js/tools/path-finder/settings.js")],void 0===(o=function(t,e){"use strict";const n=[t.BOTTOM_TO_TOP.id,t.TOP_TO_BOTTOM.id,t.LEFT_TO_RIGHT.id,t.RIGHT_TO_LEFT.id],i={};for(let t=n.length-1;t>=0;t--)i[n[t]]=t;function o(t,n,i){this.connection=t,this.previous=i,this.fromNode=n,this.toNode=t.second(n),this.cost=(i?i.cost:0)+t.cost,i&&t.directionFrom(n).id!==i.connection.directionFrom(i.fromNode).id&&(this.cost+=e.cornerCost)}return Object.defineProperty(o.prototype,"uid",{get:function(){if(void 0===this._uid){const t=this.connection.a===this.fromNode?this.connection.vector.id:this.connection.vector.rot180().id;this._uid=8*this.fromNode.uid+i[t]}return this._uid},enumerable:!0,configurable:!0}),o.prototype.canJoinWith=function(t){return this.connection===t.connection&&this.toNode===t.fromNode},Object.defineProperty(o.prototype,"allConnections",{get:function(){if(this.previous){const t=this.previous.allConnections;return t.push(...this.includedConnections),t}return this.includedConnections},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"includedConnections",{get:function(){let t=this.fromNode;const e=this.toNode,n=this.connection.directionFrom(t).id;let i=t.connections[n];if(i!==this.connection){const o=[];for(o.push(i),t=i.second(t);t!==e;)i=t.connections[n],o.push(i),t=i.second(t);return o}return[this.connection]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"allNodes",{get:function(){if(this.previous){const t=this.previous.allNodes;return t.push(this.toNode),t}return[this.fromNode,this.toNode]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"points",{get:function(){const t=[];let e=this,n=this.connection.axis;for(t.push(this.toNode.recommendedPoint);e;)e.connection.axis!==n&&(t.push(e.toNode.recommendedPoint),n=e.connection.axis),e.previous||t.push(e.fromNode.recommendedPoint),e=e.previous;return t},enumerable:!0,configurable:!0}),o.prototype.getSiblings=function(){if(this.previous)throw new Error("Unable to get path siblings");const t=[this],e=this.connection.directionFrom(this.fromNode),n=e.rot90().abs(),i=n.rot180();let s,r;for(s=this.fromNode;(s=s.nextNode(n))&&s.x===this.fromNode.x&&s.y===this.fromNode.y;)r=s.connections[e.id],r&&t.push(new o(r,s,null));for(s=this.fromNode;(s=s.nextNode(i))&&s.x===this.fromNode.x&&s.y===this.fromNode.y;)r=s.connections[e.id],r&&t.unshift(new o(r,s,null));return t},o.prototype.draw=function(t){void 0===t&&(t="red"),this.connection.draw(t),this.previous&&this.previous.draw(t)},o}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/point2d.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/tools/path-finder/draw.js");function i(t,e){this.x=t,this.y=e,this.uid=i.uidCounter++,this.id=2e5*this.x+this.y}return i.uidCounter=0,i.prototype.simpleDistanceTo=function(t){const e=t.x-this.x,n=t.y-this.y;return Math.abs(e)+Math.abs(n)},i.prototype.distanceTo=function(t){const e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},i.prototype.opposite=function(){return new i(-this.x,-this.y)},i.prototype.add=function(t){return new i(this.x+t.x,this.y+t.y)},i.prototype.sub=function(t){return new i(this.x-t.x,this.y-t.y)},i.prototype.mul=function(t){return new i(this.x*t,this.y*t)},Object.defineProperty(i.prototype,"length",{get:function(){return void 0===this._length&&(this._length=Math.sqrt(this.x*this.x+this.y*this.y)),this._length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"unitVector",{get:function(){if(0===this.x)return new i(this.x,Math.sign(this.y));if(0===this.y)return new i(Math.sign(this.x),this.y);const t=this.length;return new i(this.x/t,this.y/t)},enumerable:!0,configurable:!0}),i.prototype.rot90=function(){return new i(this.y,-this.x)},i.prototype.rot180=function(){return new i(-this.x,-this.y)},i.prototype.rot270=function(){return new i(-this.y,this.x)},i.prototype.abs=function(){return new i(Math.abs(this.x),Math.abs(this.y))},i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.draw=function(t,n){void 0===t&&(t="red"),void 0===n&&(n=2),e.circle(this,n,t)},i.prototype.drawText=function(t,n){void 0===n&&(n="black"),e.text({x:this.x+5,y:this.y-5},n,t)},i}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/rectangle.js":(t,e,n)=>{var i,o;i=[n("./bundles/oroworkflow/js/tools/path-finder/interval1d.js"),n("./bundles/oroworkflow/js/tools/path-finder/interval2d.js"),n("./bundles/oroworkflow/js/tools/path-finder/point2d.js")],void 0===(o=function(t,e,n){"use strict";function i(e,n,i,o){if(i<0||o<0)throw new RangeError("Rectangle shouldn't have negative dimensions");void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),e instanceof t?(this.horizontalInterval=e,this.verticalInterval=n):(this.horizontalInterval=new t(e,e+i),this.verticalInterval=new t(n,n+o))}return Object.defineProperty(i.prototype,"left",{get:function(){return this.horizontalInterval.min},set:function(t){this.horizontalInterval.min=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this.horizontalInterval.max},set:function(t){this.horizontalInterval.max=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.verticalInterval.min},set:function(t){this.verticalInterval.min=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.verticalInterval.max},set:function(t){this.verticalInterval.max=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.horizontalInterval.width},set:function(t){this.horizontalInterval.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.verticalInterval.width},set:function(t){this.verticalInterval.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"center",{get:function(){return new n((this.left+this.right)/2,(this.top+this.bottom)/2)},enumerable:!0,configurable:!0}),i.prototype.clone=function(){return new i(this.left,this.top,this.width,this.height)},i.prototype.intersection=function(t){const e=this.horizontalInterval.intersection(t.horizontalInterval),n=this.verticalInterval.intersection(t.verticalInterval);return null===e||null===n?null:new i(e,n)},i.prototype.union=function(t){return new i(this.horizontalInterval.union(t.horizontalInterval),this.verticalInterval.union(t.verticalInterval))},i.prototype.relative=function(t){return new i(this.left-t.x,this.top-t.y,this.width,this.height)},i.prototype.distanceToPoint=function(t){const e=this.horizontalInterval.distanceTo(t.x),n=this.verticalInterval.distanceTo(t.y);return Math.sqrt(e*e+n*n)},Object.defineProperty(i.prototype,"topSide",{get:function(){return new e(new n(this.left,this.top),new n(this.right,this.top))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomSide",{get:function(){return new e(new n(this.left,this.bottom),new n(this.right,this.bottom))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"leftSide",{get:function(){return new e(new n(this.left,this.top),new n(this.left,this.bottom))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rightSide",{get:function(){return new e(new n(this.right,this.top),new n(this.right,this.bottom))},enumerable:!0,configurable:!0}),i.prototype.eachSide=function(t){t(this.leftSide),t(this.bottomSide),t(this.rightSide),t(this.topSide)},i.prototype.containsPoint=function(t){return this.horizontalInterval.containsNonInclusive(t.x)&&this.verticalInterval.containsNonInclusive(t.y)},i.prototype.draw=function(t){void 0===t&&(t="violet"),this.eachSide((function(e){return e.draw(t)}))},i}.apply(e,i))||(t.exports=o)},"./bundles/oroworkflow/js/tools/path-finder/settings.js":(t,e,n)=>{var i;void 0===(i=function(){"use strict";return{recommendedConnectionWidth:12,cornerCost:100,optimizationCornerCost:99,crossPathCost:99,centerAxisCostMultiplier:.98,usedAxisCostMultiplier:.99,overBlockLineCostMultiplier:20}}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/path-finder/util.js":t=>{t.exports={between:function(t,e,n){"use strict";return e<=t&&t<=n||e>=t&&t>=n},betweenNonInclusive:function(t,e,n){"use strict";return e<t&&t<n||e>t&&t>n}}},"./bundles/oroworkflow/js/tools/path-finder/vector2d.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroworkflow/js/tools/path-finder/util.js"),i=n("./bundles/oroworkflow/js/tools/path-finder/point2d.js"),o=n("./bundles/oroworkflow/js/tools/path-finder/line2d.js"),s=n("./bundles/oroworkflow/js/tools/path-finder/interval2d.js");function r(t,e,n){this.start=new i(t,e),this.direction=n}return r.prototype.crosses=function(t){return null!==this.getCrossPointWithRect(t)},Object.defineProperty(r.prototype,"line",{get:function(){const t=this.direction.y/this.direction.x;return t===1/0||t===-1/0?new o(1/0,this.start.x):new o(t,this.start.y-this.start.x*t)},enumerable:!0,configurable:!0}),r.prototype.getCrossPointWithRect=function(t){let e=null;switch(this.direction.y){case-1:e=this.getCrossPointWithInterval(t.bottomSide);break;case 1:e=this.getCrossPointWithInterval(t.topSide)}switch(this.direction.x){case-1:e=this.getCrossPointWithInterval(t.rightSide);break;case 1:e=this.getCrossPointWithInterval(t.leftSide)}return e},r.prototype.getCrossPointWithInterval=function(t){const n=this.line.intersection(t.line);if(!isNaN(n.x)&&Math.abs(n.x)!==1/0){const i=n.sub(this.start);if(Math.sign(i.x)===Math.sign(this.direction.x)&&Math.sign(i.y)===Math.sign(this.direction.y))if(t.a.x!==t.b.x){if(e.between(n.x,t.a.x,t.b.x))return n}else if(e.between(n.y,t.a.y,t.b.y))return n}return null},r.prototype.draw=function(t){void 0===t&&(t="rgba(0,0,0,0.7)"),this.start.draw(t,3),new s(this.start,this.start.add(this.direction.unitVector.mul(1e5))).draw(t)},r}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/workflow-helper.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js");return{getNameByString:function(t,e){return(t=(t=(e||"")+t).toLowerCase().replace(/[^A-Za-z\s_-]+/g,"").replace(/\s+|\-+/g,"_").replace(/__+/g,"_"))+"_"+this.getRandomId()},getRandomId:function(){return Math.random().toString(16).slice(2)},getFormData:function(t){const e=t.serializeArray(),n={};for(let t=0;t<e.length;t++){const i=e[t];let o=i.name,s=o.match(/\[(\w+)\]$/);s?(o=s[1],n[o]=i.value):(s=o.match(/\[(\w+)\]\[\]$/),s?(o=s[1],void 0===n[o]&&(n[o]=[]),n[o].push(i.value)):n[o]=i.value)}return n},deepClone:function(t){const n=e.clone(t);for(const n in t)t.hasOwnProperty(n)&&e.isObject(t[n])&&(t[n]=this.deepClone(t[n]));return n}}}.call(e,n,e,t))||(t.exports=i)},"./bundles/oroworkflow/js/tools/workflow-model-factory.js":(t,e,n)=>{var i;void 0===(i=function(t){"use strict";const e=n("./bundles/oroui/js/extend/underscore.js"),i=n("./bundles/orotranslation/js/translator.js"),o=n("./bundles/oroworkflow/js/app/models/attribute-collection.js"),s=n("./bundles/oroworkflow/js/app/models/step-collection.js"),r=n("./bundles/oroworkflow/js/app/models/step-model.js"),l=n("./bundles/oroworkflow/js/app/models/transition-collection.js"),a=n("./bundles/oroworkflow/js/app/models/transition-definition-collection.js"),c=n("./bundles/oroworkflow/js/app/models/workflow-model.js");return{createWorkflowModel:function(t){const e=this._createWorkflowModel(t);return this.addStartingStep(e),e},_createWorkflowModel:function(t){const e=t.entity.configuration,n=t.entity.translateLinks;e.steps=new s(this._getNodeConfiguration(e,"steps",n)),e.transitions=new l(this._getNodeConfiguration(e,"transitions",n)),e.attributes=new o(this._getNodeConfiguration(e,"attributes",n)),e.transition_definitions=new a(this._getNodeConfiguration(e,"transition_definitions",n)),e.name=t.entity.name,e.label=t.entity.label,e.entity=t.entity.entity,e.entity_attribute=t.entity.entity_attribute,e.start_step=t.entity.startStep,e.steps_display_ordered=t.entity.stepsDisplayOrdered,e.priority=t.entity.priority,e.exclusive_active_groups=t.entity.exclusive_active_groups,e.exclusive_record_groups=t.entity.exclusive_record_groups,e.applications=t.entity.applications;const i=new c(e);return i.setAvailableDestinations(t.availableDestinations||{}),i.url=t._sourceElement.attr("action"),n&&"label"in n&&(i.translateLinkLabel=n.label),i},addStartingStep:function(t){0===t.getStartStep().length&&t.get("steps").add(this._createStartingStep(t))},_createStartingStep:function(t){const e=new r({name:"step:starting_point",label:i("(Start)"),order:-1,_is_start:!0});return e.getAllowedTransitions(t).reset(t.getStartTransitions()),e},_getNodeConfiguration:function(t,n,i){const o=[];return e.each(t[n],(function(t,e){t.name=e,i&&n in i&&e in i[n]&&(t.translateLinks=i[n][e]),o.push(t)})),o}}}.call(e,n,e,t))||(t.exports=i)}}]);