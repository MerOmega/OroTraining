(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[907],{"../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/app/components/template/integration-widget-link.html":e=>{e.exports='<div class="integration-widget-link-container">\n    <% if (name) {%>\n        <%- name %> (<a href="#" class="no-hash form-element-text" data-purpose="open-form-widget"><%- title %></a>)\n        <a href="#" class="no-hash"><i class="fa-close" data-purpose="remove-integration-data"></i></a>\n    <% } else { %>\n        <a href="#" class="no-hash form-element-text" data-purpose="open-form-widget"><%- title %></a>\n    <% } %>\n</div>\n'},"../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/component.html":e=>{e.exports='<div class="clearfix">\n    <div class="span6 entities-component">\n        <div class="form-container clearfix" data-validation-ignore></div>\n        <div class="grid-container">\n            <table class="grid grid-main-container table-hover table table-bordered table-condensed" style="display: table;">\n                <thead>\n                <tr>\n                    <th class="name-column"><span><%- __(\'Entity\') %></span></th>\n                    <th class="action-column"><span><%- __(\'Actions\') %></span></th>\n                </tr>\n                </thead>\n                <tbody></tbody>\n            </table>\n        </div>\n        <div class="no-data">\n            <%- __(\'There is no entities selected\') %>\n        </div>\n    </div>\n</div>\n'},"../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/entity-item.html":e=>{e.exports='<tr data-cid="<%- cid %>">\n    <td class="name-cell"><i class="<%- icon %> hide-text"></i>&nbsp;<%- label %></td>\n    <td class="action-cell">\n        <% _.each(actions, function(action) { %>\n            <a href="<%- action.url ? action.url: \'#\' %>"\n                class="action <% if (!action.url) { %>no-hash<% } %>"\n                <% if (!action.url && action.collectionAction) { %>\n                    data-collection-action="<%- action.collectionAction %>""\n                <% } %> title="<%- __(action.title) %>">\n\n                <% if (action.icon) { %>\n                    <i class="<%- action.icon %> hide-text"></i>\n                <% } else { %>\n                    <%- __(action.title) %>\n                <% } %>\n            </a>\n        <% }) %>\n    </td>\n</tr>\n'},"../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/form.html":e=>{e.exports='<div class="entities-form-container">\n    <div class="control-group">\n        <div class="controls">\n            <input type="text" data-purpose="entity-selector" name="name" data-validation=\'{"NotBlank":null}\'>\n        </div>\n    </div>\n\n    <div class="control-group">\n        <div class="controls">\n            <div class="pull-left entities-form-action-container">\n                <div class="btn-group icons-holder">\n                    <a href="#" class="btn no-hash btn-primary add-button" title="<%- __(\'Add\') %>"><%- __(\'Add\') %></a>\n                </div>\n                <div class="btn-group icons-holder">\n                    <a href="#" class="btn no-hash cancel-button" title="<%- __(\'Cancel\') %>"><%- __(\'Cancel\') %></a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'},"../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/select2/result.html":e=>{e.exports='<% if (icon) { %><i class="<%- icon %> icon hide-text" aria-hidden="true"></i><% } %><%= highlight(_.escape(text)) %>\n'},"../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/select2/selection.html":e=>{e.exports='<% if (icon) { %><i class="<%- icon %> icon hide-text" aria-hidden="true"></i><% } %><%= highlight(_.escape(text)) %>\n'},"./bundles/orochannel/js/app/components/channel-aware-select-create-component-mixin.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/extend/underscore.js");return{channelFieldSelector:null,channelRequired:!1,presetChannelId:null,_super:function(){throw new Error("_super() should be defined")},initialize:function(e){s.extend(this,s.pick(e,["channelFieldSelector","channelRequired","presetChannelId"])),this._super().initialize.call(this,e),t(this.channelFieldSelector).on("change.component"+this.cid,this.changeHandler.bind(this)),this.changeHandler()},changeHandler:function(e){const n=t(this.channelFieldSelector),s=this.getUrlParts(),o=[],i=n.val();i&&o.push(i),this.presetChannelId&&o.push(this.presetChannelId),this.channelRequired&&this.view.setEnableState(o.length>0),s.grid.parameters.params.channelIds=o.join(",");const r=this.presetChannelId||n.val();s.hasOwnProperty("create")&&r&&(s.create.parameters.channelId=r,this.setUrlParts(s)),void 0!==e&&this.setSelection(null)},dispose:function(){this.disposed||(t(this.channelFieldSelector).off("change.component"+this.cid),this._super().dispose.call(this))}}}.call(t,n,t,e))||(e.exports=s)},"./bundles/orochannel/js/app/components/channel.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroui/js/extend/underscore.js"),n("./bundles/orotranslation/js/translator.js"),n("./bundles/oroui/js/extend/jquery.js"),n("./bundles/oroui/js/mediator.js"),n("./bundles/oroui/js/delete-confirmation.js"),n("./bundles/orochannel/js/entity-management/entity-component-view.js"),n("./bundles/oroui/js/extend/select2.js")],void 0===(o=function(e,t,n,s,o,i){"use strict";let r;return function(a){let c=[];c=e.isArray(a.customerIdentity)?a.customerIdentity:[a.customerIdentity],function(e,t,s){const o=n(e),a=o.val(),c=a?JSON.parse(a):[];if(0===c.length)return;const l=new i({data:c,mode:i.prototype.MODES.EDIT_MODE,metadata:t,lockedEntities:s});l.render(),o.after(l.$el),r=l.collection,r.on("add remove reset",(function(){o.val(JSON.stringify(r.pluck("name")))}))}(a.channelEntitiesEl,a.entitiesMetadata,c),function(i,r){const a=n(i),c=a.parents("form"),l=function(){a.attr("disabled",!0);const e=c.serialize();return a.attr("disabled",!1),e},u=l(),d=a.val(),h=function(){const t=a.parents("form"),o=e.map(r,(function(e){return n(e).attr("name")})),i=e.filter(t.serializeArray(),(function(t){return-1!==e.indexOf(o,t.name)}));i.push({name:"formUpdateMarker",value:1});const c={formEl:t,data:i,reloadManually:!0};s.trigger("channelFormReload:before",c),c.reloadManually&&s.execute("submitPage",{url:t.attr("action"),type:t.attr("method"),data:n.param(i)})};a.on("change",(function(e){const n=e.removed,s=new o({title:t("oro.channel.confirmation.title"),okText:t("oro.channel.confirmation.agree"),content:t("oro.channel.confirmation.text")});s.on("ok",h),s.on("cancel",(function(){a.select2("val",n.id)})),""!==d&&l()!==u?s.open():h()}))}(a.channelTypeEl,a.fields),a._sourceElement.remove()}}.apply(t,s))||(e.exports=o)},"./bundles/orochannel/js/app/components/integration-widget.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroui/js/extend/underscore.js"),n("./bundles/oroui/js/extend/backbone.js"),n("./bundles/orotranslation/js/translator.js"),n("./bundles/fosjsrouting/js/router.js"),n("./bundles/orowindows/js/widget/dialog-widget.js"),n("./bundles/oroui/js/delete-confirmation.js"),n("../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/app/components/template/integration-widget-link.html")],void 0===(o=function(e,t,n,s,o,i,r){"use strict";const a=t.$,c=t.View.extend({$dataEl:null,$idEl:null,$typeEl:null,$nameEl:null,$channelNameEl:null,linkTemplate:e.template(r),events:{'click [data-purpose="open-form-widget"]':"openDialog",'click [data-purpose="remove-integration-data"]':"onRemoveIntegrationData"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){if(!(e.dataEl&&e.idEl&&e.typeEl&&e.nameEl))throw new TypeError("Missing required options for IntegrationWidgetHandlerView");this.$dataEl=a(e.dataEl),this.$idEl=a(e.idEl),this.$typeEl=a(e.typeEl),this.$nameEl=a(e.nameEl),this.$channelNameEl=a(e.channelNameEl)},openDialog:function(t){t.preventDefault();let n=this._getUrl();const s=a(t.target).data("route_additional_params");s&&(n=n+(-1===n.indexOf("?")?"?":"&")+a.param(s));const i=new o({url:n,title:this._getTitle(),stateEnabled:!1,incrementalPosition:!1,dialogOptions:{modal:!0,resizable:!0,autoResize:!0,width:700,height:550}});i.on("formSave",function(t){t=e.omit(t,["_token"]),this._setValue("name",t.name||""),this._setValue("data",t),i.remove(),this.render()}.bind(this)),i.render()},onRemoveIntegrationData:function(){const e=new i({content:n("oro.channel.confirmation.delete_confirmation")});e.on("ok",this.removeIntegrationData.bind(this)),e.open()},removeIntegrationData:function(){this.$dataEl.val(null),this.$idEl.val(null),this.$nameEl.val(null),this.render()},render:function(){const e=this._getValue("name"),t={name:e,title:n(e?"edit":"Configure integration")};this.$el.find(".integration-widget-link-container").remove().end().append(this.linkTemplate(t))},_getUrl:function(){const e=this._getValue("id"),t=this._getValue("data"),n=e?"oro_channel_integration_update":"oro_channel_integration_create",o=this._getValue("type"),i={};return i.channelName=encodeURIComponent(this._getValue("channelName")),t&&(i.data=t),e?i.id=e:o&&(i.type=encodeURIComponent(o)),s.generate(n,i)},_getTitle:function(){return this._getValue("name")||n("Configure integration")},_getValue:function(e){let t;this._assertAllowedValueKey(e);const n=this[["$",e,"El"].join("")].val();return t="data"===e?""!==n?JSON.parse(n):{}:n,t},_setValue:function(e,t){let n;this._assertAllowedValueKey(e),n="data"===e?JSON.stringify(t):t,this[["$",e,"El"].join("")].val(n)},_assertAllowedValueKey:function(e){if(-1===["id","data","type","name","channelName"].indexOf(e))throw new TypeError("Unknown option: "+e)}});return function(e){const t=new c(e);return t.render(),e._sourceElement.remove(),t}}.apply(t,s))||(e.exports=o)},"./bundles/orochannel/js/app/components/select-create-inline-type-async-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/underscore.js"),s=n("./bundles/oroform/js/app/components/select-create-inline-type-async-component.js"),o=n("./bundles/orochannel/js/app/components/channel-aware-select-create-component-mixin.js"),i=s.extend(t.extend({},o,{_super:function(){return i.__super__}}));return i}.call(t,n,t,e))||(e.exports=s)},"./bundles/orochannel/js/app/components/select-create-inline-type-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/underscore.js"),s=n("./bundles/oroform/js/app/components/select-create-inline-type-component.js"),o=n("./bundles/orochannel/js/app/components/channel-aware-select-create-component-mixin.js"),i=s.extend(t.extend({},o,{_super:function(){return i.__super__}}));return i}.call(t,n,t,e))||(e.exports=s)},"./bundles/orochannel/js/app/views/configure-integration-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/oroui/js/mediator.js"),i=n("./bundles/oroui/js/widget/widget-manager.js"),r=t.extend({optionNames:t.prototype.optionNames.concat(["wid","dataFieldSelector","apiKeyFieldSelector"]),constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){r.__super__.initialize.call(this,e),i.getWidgetInstance(this.wid,this.onWidgetLoad.bind(this))},onWidgetLoad:function(e){o.on("integrationFormReload:before",(function(t){t.reloadManually=!1,e.loadContent(s.param(t.data),t.formEl.attr("method"))})),e.on("contentLoad",function(){const e=this.$(this.dataFieldSelector),t=this.$(this.apiKeyFieldSelector);if(e.val()&&!t.val()){const n=JSON.parse(e.val());n.transport.apiKey&&t.val(n.transport.apiKey)}}.bind(this))}});return r}.call(t,n,t,e))||(e.exports=s)},"./bundles/orochannel/js/entity-management/entity-component-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/backbone.js"),s=n("./bundles/oroui/js/extend/underscore.js"),o=n("./bundles/orotranslation/js/translator.js"),i=n("./bundles/orochannel/js/entity-management/model.js"),r=n("../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/component.html"),a=n("../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/entity-item.html"),c=n("../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/form.html"),l=n("../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/select2/result.html"),u=n("../node_modules/@oroinc/oro-webpack-config-builder/loader/text-loader.js!./bundles/orochannel/js/entity-management/templates/select2/selection.html"),d=n("./bundles/oroform/js/app/components/select2-component.js");n("./bundles/oroui/js/items-manager/editor.js"),n("./bundles/oroui/js/items-manager/table.js");const h={VIEW_MODE:1,EDIT_MODE:2};return t.View.extend({MODES:s.clone(h),template:s.template(r),itemTemplate:s.template(a),formTemplate:s.template(c),options:{data:[],mode:h.VIEW_MODE,entityModel:i,metadata:null,lockedEntities:[]},collection:null,$formContainer:null,$listContainer:null,$noDataContainer:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){if(this.options=s.defaults(e||{},this.options),!this.options.metadata)throw new Error('Missing "metadata" options for entity selection compoment');const n=this.options.data.length>0?s.map(this.options.data,this._createModel.bind(this)):[];this.collection=this.collection||new t.Collection(n,{model:i}),this.listenTo(this.collection,"add remove reset",this._onCollectionChange),this.listenTo(this.collection,"add",this._onItemAdded)},render:function(){const e={__:o};this.$el.html(this.template(s.extend({},e))),this.$formContainer=this.$el.find(".form-container"),this.$listContainer=this.$el.find(".grid-container"),this.$noDataContainer=this.$el.find(".no-data"),this.options.mode===h.EDIT_MODE&&(this.$formContainer.html(this.formTemplate(s.extend({},e))),s.defer(this._initializeForm.bind(this))),s.defer(this._initializeList.bind(this))},_initializeForm:function(){const e={placeholder:o("oro.channel.form.entity"),result_template:l,selection_template:u,data:()=>{const e=s.omit(this.options.metadata,this.collection.pluck("name")),t=s.map(e,(function(e){return{id:e.name,text:e.label,icon:e.icon,type:e.type}})),n=s.groupBy(t,(function(e){return e.type})),i=[];return s.each(s.keys(n).sort().reverse(),(function(e){i.push({text:o("oro.channel.entity_owner."+e),icon:null,children:n[e]})})),{results:i}}},t=this.$formContainer.find('[data-purpose="entity-selector"]'),n=new d({configs:e,_sourceElement:t});this.pageComponent("entity-selector",n,t),this.$formContainer.itemsManagerEditor({collection:this.collection})},_initializeList:function(){this.$listContainer.find("tbody").itemsManagerTable({collection:this.collection,itemTemplate:this.itemTemplate,itemRender:function(e,t){return e(s.extend({__:o},t))},deleteHandler:s.partial((function(e,t,n){e.remove(t)}),this.collection),sorting:!1}),this._onCollectionChange()},_onCollectionChange:function(){this.collection.isEmpty()?(this.$listContainer.hide(),this.$noDataContainer.show()):(this.$listContainer.show(),this.$noDataContainer.hide())},_onItemAdded:function(e){e.set(this._prepareModelAttributes(e))},_prepareModelAttributes:function(e){const t=e.get("name"),n=this.options.metadata[t]||{},o=[],i=this.options.lockedEntities;return-1===t.indexOf(i)&&this.options.mode===h.EDIT_MODE?o.push({collectionAction:"delete",title:"Delete",icon:"fa-trash-o"}):this.options.mode===h.VIEW_MODE&&(o.push({title:"View",icon:"fa-eye",url:n.view_link}),o.push({title:"Edit",icon:"fa-pencil-square-o",url:n.edit_link})),s.defaults(n,{name:t,label:t,actions:o})},_createModel:function(e){const t=new i({name:e});return t.set(this._prepareModelAttributes(t)),t}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/orochannel/js/entity-management/model.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroui/js/extend/backbone.js")],void 0===(o=function(e){"use strict";return e.Model.extend({defaults:{icon:null,name:null,label:null,actions:[]},constructor:function e(t,n){e.__super__.constructor.call(this,t,n)}})}.apply(t,s))||(e.exports=o)},"./bundles/oroimap/js/app/components/account-type-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/extend/underscore.js"),o=n("./bundles/oroui/js/mediator.js"),i=n("./bundles/oroimap/js/app/views/account-type-view.js"),r=n("./bundles/oroui/js/app/components/base/component.js"),a=n("./bundles/fosjsrouting/js/router.js");return r.extend({ViewType:i,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.route=s.result(e,"route")||"",this.formParentName=s.result(e,"formParentName")||"",this.originId=s.result(e,"id")||null;const t=this.prepareViewOptions(e);this.view=new this.ViewType(t),this.view.render(),this.listenTo(this.view,"imapConnectionChangeType",this.onChangeAccountType),this.listenTo(o,"imapGmailConnectionSetToken",this.onIMapGotToken)},prepareViewOptions:function(e){return{el:e._sourceElement}},onChangeAccountType:function(e){o.trigger("change:systemMailBox:email"),o.execute("showLoading"),t.ajax({url:this.getUrl(),method:"POST",data:{type:e,formParentName:this.formParentName,id:this.originId},success:this.templateLoaded.bind(this)})},onIMapGotToken:function(e){o.execute("showLoading"),t.ajax({url:this.getUrl(),method:"POST",data:{type:e.type,token:e.token},success:this.templateLoaded.bind(this)})},templateLoaded:function(e){o.execute("hideLoading"),this.view.setHtml(e.html).render()},getUrl:function(){return a.generate(this.route,this._getUrlParams())},_getUrlParams:function(){return{}}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/components/check-config-settings.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroui/js/extend/jquery.js"),n("./bundles/oroui/js/extend/underscore.js")],void 0===(o=function(e,t){"use strict";return function(t){function n(t,n){const s=e(t).is(":checked");n.each((function(){e(this).closest(".control-group").toggle(s),e(this).enable(s)}))}const s=e(t._sourceElement).parent().parent(),o=s.find(".imap-config:checkbox"),i=s.find(".smtp-config:checkbox"),r=s.find("input.imap-config,select.imap-config").not(":checkbox"),a=s.find("input.smtp-config,select.smtp-config").not(":checkbox");n(o,r),n(i,a),e(o).on("change",(function(){n(this,r)})),e(i).on("change",(function(){n(this,a)}))}}.apply(t,s))||(e.exports=o)},"./bundles/oroimap/js/app/components/check-connection-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/extend/underscore.js"),o=n("./bundles/oroui/js/app/components/base/component.js"),i=n("./bundles/oroimap/js/app/views/check-connection-view.js"),r=n("./bundles/oroimap/js/app/models/check-connection-model.js");return o.extend({constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){if(e.elementNamePrototype){const n=s.extend({model:new r({}),el:t(e._sourceElement).closest(e.parentElementSelector),entity:e.forEntity||"user",entityId:e.id,organization:e.organization||""},e.viewOptions||{});/^.+\[\w+]$/i.test(e.elementNamePrototype)&&(n.formPrefix=e.elementNamePrototype.match(/(.+)\[\w+]$/i)[1]),this.view=new i(n)}else t(e._sourceElement).remove()}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/components/google-sync-checkbox-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/scriptjs.js"),s=n("./bundles/fosjsrouting/js/router.js"),o=n("./bundles/oroui/js/app/components/base/component.js"),i=n("./bundles/oroimap/js/app/views/google-sync-checkbox-view.js");return o.extend({clientId:null,$clientIdElement:null,scopes:["https://mail.google.com/"],constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.$clientIdElement=e._sourceElement.closest('form[name="google_settings"]').find('input[id*="client_id"]'),this.view=new i({el:e._sourceElement,errorMessage:e.errorMessage,successMessage:e.successMessage,googleErrorMessage:e.googleErrorMessage,googleWarningMessage:e.googleWarningMessage}),t("//accounts.google.com/gsi/client",function(){this.listenTo(this.view,"requestToken",this.requestToken)}.bind(this)),t("//apis.google.com/js/api.js",(function(){gapi.load("client",(function(){gapi.client.init({})}))}))},requestToken:function(){const e=google.accounts.oauth2.initTokenClient({client_id:this.$clientIdElement.val(),scope:this.scopes.join(" "),redirect_uri:s.generate("oro_google_integration_sso_login_google",{},!0),callback:""});e.callback=async e=>{if(void 0!==e.error)throw e;this.checkAuthorization(e.access_token)},e.requestAccessToken()},checkAuthorization:function(e){this.view.setToken(e),gapi.client.load("gmail","v1",this.requestProfile.bind(this))},requestProfile:function(){gapi.client.gmail.users.getProfile({userId:"me"}).execute(this.responseProfile.bind(this))},responseProfile:function(e){403===e.code&&this.view.setGoogleErrorMessage(e.message),this.view.render()}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/components/imap-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/extend/underscore.js"),o=n("./bundles/orotranslation/js/translator.js"),i=n("./bundles/oroui/js/mediator.js"),r=n("./bundles/oroui/js/extend/scriptjs.js"),a=n("./bundles/oroui/js/app/components/base/component.js"),c=n("./bundles/fosjsrouting/js/router.js"),l=a.extend({scopes:[],type:"",scriptPath:null,errorMessages:{},constructor:function e(t){e.__super__.constructor.call(this,t)},getErrorMessage:function(e){return o(this.errorsMessages[e]||e)},initialize:function(e){this.route=s.result(e,"route")||"",this.routeAccessToken=s.result(e,"routeAccessToken")||"",this.routeGetFolders=s.result(e,"routeGetFolders")||"",this.formParentName=s.result(e,"formParentName")||"",this.originId=s.result(e,"id")||null;const t=this.prepareViewOptions(e);this.view=new this.ViewType(t),this.view.setAccessToken(s.result(e,"accessToken")||""),this.view.setExpiredAt(s.result(e,"accessTokenExpiresAt")||""),this.view.setEmail(s.result(e,"user")||""),this.listenTo(this.view,"getFolders",this.onGetFolders),this.scriptPath?r(this.scriptPath,function(){this.listenTo(this.view,"checkConnection",this.onCheckConnection)}.bind(this)):this.listenTo(this.view,"checkConnection",this.onCheckConnection),l.__super__.initialize.call(this,e)},prepareViewOptions:function(e){return{el:e._sourceElement,vendorErrorMessage:e.vendorErrorMessage,type:this.type}},onCheckConnection:function(){this.view.resetErrorMessage(),this.requestAuthCode()},requestAuthCode:function(e){throw new Error("Component for type `"+this.type+"`has no auth code provider method implemented!")},handleResponseAuthCode:function(e){"access_denied"===e.error?(this.view.setErrorMessage(this.getErrorMessage("access_deny")),this.view.render()):(i.execute("showLoading"),this.requestAccessToken(e.code))},requestAccessToken:function(e){t.ajax({url:this.getUrlGetAccessToken(),method:"POST",data:e&&String(e).length?{code:e}:{},success:this.prepareAuthorization.bind(this),errorHandlerMessage:!1,error:this.requestError.bind(this)})},prepareAuthorization:function(e){void 0!==e.error?(this.view.setErrorMessage(e.error),this.view.render(),i.execute("hideLoading")):void 0!==e.code&&e.code>=400?(this.view.setErrorMessage(e.message||this.getErrorMessage("request")),this.view.render(),i.execute("hideLoading"),401===e.code&&i.execute("showFlashMessage","error",this.getErrorMessage("closed_auth"))):e&&(this.view.setEmail(e.email_address),this.view.setAccessToken(e.access_token),this.view.setRefreshToken(e.refresh_token),this.view.setExpiredAt(e.expires_in),this.view.render(),i.trigger("change:systemMailBox:email",{email:e.email_address}),this.requestFormGetFolder())},requestError:function(e){this.view.setErrorMessage(this.getErrorMessage("request")),this.view.render()},requestFormGetFolder:function(){const e=this.view.getData();e.formParentName=this.formParentName,i.execute("showLoading"),t.ajax({url:this.getUrl(),method:"POST",data:e,success:this.renderFormGetFolder.bind(this),errorHandlerMessage:!1,error:this.requestError.bind(this)})},renderFormGetFolder:function(e){void 0!==e.error?(this.view.setErrorMessage(e.error),this.view.render(),i.execute("hideLoading")):void 0===e.html?(this.view.setErrorMessage(this.getErrorMessage("request")),this.view.render(),i.execute("hideLoading")):(this.view.setHtml(e.html),this.view.render(),this.view.autoRetrieveFolders())},onGetFolders:function(e){delete e.type;const n=this.prepareDataForForm(e);i.execute("showLoading"),t.ajax({url:this.getUrlGetFolders(),method:"POST",data:n,success:this.handlerGetFolders.bind(this),errorHandlerMessage:!1,error:this.requestError.bind(this)})},handlerGetFolders:function(e){void 0!==e.error?this.view.setErrorMessage(e.error):void 0===e.html?this.view.setErrorMessage(this.getErrorMessage("request")):this.view.setHtml(e.html),this.view.render(),i.execute("hideLoading")},prepareDataForForm:function(e){throw new Error("Component for type `"+this.type+"`has to have this method implemented!")},getUrl:function(){return c.generate(this.route,this._getUrlParams())},getUrlGetFolders:function(){return c.generate(this.routeGetFolders,this._getUrlParams())},getUrlGetAccessToken:function(){return c.generate(this.routeAccessToken,this._getUrlParams())},_getUrlParams:function(){return{}}});return l}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/components/imap-gmail-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/mediator.js"),s=n("./bundles/fosjsrouting/js/router.js"),o=n("./bundles/oroimap/js/app/views/imap-gmail-view.js"),i=n("./bundles/oroimap/js/app/components/imap-component.js").extend({ViewType:o,scopes:["https://mail.google.com/","https://www.googleapis.com/auth/userinfo.email"],type:"gmail",scriptPath:"//accounts.google.com/gsi/client",errorsMessages:{access_deny:"oro.imap.connection.microsoft.oauth.error.access_deny",request:"oro.imap.connection.microsoft.oauth.error.request",closed_auth:"oro.imap.connection.microsoft.oauth.error.closed_auth",blocked_popup:"oro.imap.connection.microsoft.oauth.error.blocked_popup"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){i.__super__.initialize.call(this,e)},onCheckConnection:function(){this.view.resetErrorMessage(),this.requestAuthCode()},requestAuthCode:function(e){const n=this.view.getData(),o={};this._wrapFirstWindowOpen(o);const i=google.accounts.oauth2.initCodeClient({client_id:n.clientId,scope:this.scopes.join(" "),redirect_uri:s.generate("oro_google_integration_sso_login_google",{},!0),ux_mode:"popup",immediate:!1,login_hint:e,access_type:"offline",approval_prompt:"force",callback:""});i.callback=async e=>{void 0!==e.error&&null!==e.reason&&t.execute("showFlashMessage","error",this.getErrorMessage("closed_auth")),this.handleResponseAuthCode(e)},o.deferred=i.requestCode()},_wrapFirstWindowOpen:function(e){var n;e=e||{},n=window.open,window.open=function(...s){window.open=n;const o=n.apply(this,s);if(o){const t=setInterval((function(){o.closed&&(clearInterval(t),setTimeout((function(){void 0!==e.deferred&&e.deferred.cancel()}),1500))}),100)}else t.execute("showFlashMessage","error",this.getErrorMessage("blocked_popup"));return o}},prepareDataForForm:function(e){const t={oro_imap_configuration_gmail:{},formParentName:this.formParentName,id:this.originId,type:"gmail"};for(const n in e)e.hasOwnProperty(n)&&(t.oro_imap_configuration_gmail[n]=e[n]);return t}});return i}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/components/imap-microsoft-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/mediator.js"),o=n("./bundles/fosjsrouting/js/router.js"),i=n("./bundles/oroimap/js/app/components/oauth-popup.js"),r=n("./bundles/oroimap/js/app/components/imap-component.js"),a=n("./bundles/oroimap/js/app/views/imap-microsoft-view.js"),c=r.extend({ViewType:a,origin:null,scopes:["openid","offline_access","User.Read","profile","https://outlook.office.com/IMAP.AccessAsUser.All","https://outlook.office.com/POP.AccessAsUser.All","https://outlook.office.com/SMTP.Send"],type:"microsoft",errorsMessages:{access_deny:"oro.imap.connection.microsoft.oauth.error.access_deny",request:"oro.imap.connection.microsoft.oauth.error.request",closed_auth:"oro.imap.connection.microsoft.oauth.error.closed_auth",blocked_popup:"oro.imap.connection.microsoft.oauth.error.blocked_popup"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){c.__super__.initialize.call(this,e)},onCheckConnection:function(){this.view.resetErrorMessage(),this.requestAuthCode()},buildLoginUrl:function(e){const n="https://login.microsoftonline.com/"+e.tenant+"/oauth2/v2.0/authorize",s={client_id:e.clientId,response_type:"code",redirect_uri:o.generate("oro_imap_microsoft_access_token",{},!0),response_mode:"query",scope:this.scopes.join(" "),state:Math.floor(1e4+9e4*Math.random())};return[n,t.param(s)].join("?")},requestAuthCode:function(e){const t=this.view.getData();i.whenAuthorized(this.buildLoginUrl(t)).done(function(){this.requestAccessToken()}.bind(this)).fail(function(){s.execute("showFlashMessage","error",this.getErrorMessage("blocked_popup"))}.bind(this))},prepareDataForForm:function(e){const t={oro_imap_configuration_microsoft:{},formParentName:this.formParentName,id:this.originId,type:"microsoft"};for(const n in e)e.hasOwnProperty(n)&&(t.oro_imap_configuration_microsoft[n]=e[n]);return t}});return c}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/components/oauth-popup.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js");return{openPopup:function(e,t){t.width=t.width||500,t.height=t.height||600;const n=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=Math.max(0,o/2-t.width/2+n),a=Math.max(0,i/2-t.height/2+s);return window.open(e,"oro-oauth-authorization","width="+t.width+", height="+t.height+", top="+a+", left="+r)},whenAuthorized:function(e,n){const s=t.Deferred();try{this.whenWindowClosed(this.openPopup(e,n||{})).done((()=>{s.resolve(this.isAuthorized)}))}catch(e){s.reject()}return s.promise()},whenWindowClosed:function(e){const n=t.Deferred(),s=setInterval((function(){e.closed&&(clearInterval(s),n.resolve())}),500);return this.whenCallbackLoaded(e).done((()=>{this.isAuthorized=!0,e.close()})),n.promise()},whenCallbackLoaded:function(e){const n=t.Deferred(),s=setInterval((function(){try{if("about:blank"===String(e.location))return;setTimeout((function(){clearInterval(s),n.resolve()}),800)}catch(e){}}),500);return n.promise()}}}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/models/check-connection-model.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";return n("./bundles/oroui/js/app/models/base/model.js").extend({defaults:{imap:{},smtp:{}},constructor:function e(...t){e.__super__.constructor.apply(this,t)}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/views/account-type-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroui/js/extend/jquery.js");return t.extend({html:"",events:{'change select[name$="[accountType]"]':"onChangeAccountType"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){},render:function(){this.html.length&&(this.$el.html(this.html).find(".control-group.switchable-field").hide(),this.html=""),this._deferredRender(),this.initLayout().done(this._resolveDeferredRender.bind(this))},onChangeAccountType:function(e){this.trigger("imapConnectionChangeType",s(e.target).val())},setHtml:function(e){return this.html=e,this}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/views/check-connection-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/extend/underscore.js"),o=n("./bundles/orotranslation/js/translator.js"),i=n("./bundles/fosjsrouting/js/router.js"),r=n("./bundles/oroui/js/mediator.js"),a=n("./bundles/oroui/js/layout.js"),c=n("./bundles/oroui/js/messenger.js");return n("./bundles/oroui/js/app/views/base/view.js").extend({SUCCESS_MESSAGE_DELAY:5e3,route:"oro_imap_connection_check",entity:"user",entityId:0,organization:"",formPrefix:"",requestPrefix:"oro_imap_configuration",events:{"click [data-role=check-connection-btn]":"requestAPI","change .critical-field :input":"clear"},attributes:{"data-layout":"separate"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this._setAttributes(this.attributes),s.extend(this,s.pick(e,["entity","entityId","organization","formPrefix"])),this.model.on("change",this.render,this)},render:function(){const e=this.model.get("imap"),t=this.ensureContainer();"folders"in e?(t.replaceWith(e.folders),a.initPopover(this.$el.find(".folder-tree"))):t.empty(),this.initLayout()},ensureContainer:function(){let e=this.$el.find(".folder-tree");return 0===e.length&&(e=t("<div/>",{class:"control-group folder-tree"}),this.$el.find("[data-role=check-connection-btn]").closest(".control-group").parent().append(e)),e},requestAPI:function(){const e=this.$el.find(".check-connection").serializeArray(),n=this.$el.find(".check-connection-messages");r.execute("showLoading"),this.clear(),n.find(".alert").remove(),t.ajax({type:"POST",url:this.getUrl(),data:t.param(this.prepareData(e)),success:e=>{e.imap&&(this.showMessage("success","oro.imap.connection.imap.success",n),this.model.set("imap",e.imap)),e.smtp&&(this.showMessage("success","oro.imap.connection.smtp.success",n),this.model.set("smtp",e.smtp))},errorHandlerMessage:!1,error:e=>{const t=e.responseJSON;s.each(t.errors,(function(e){c.notificationFlashMessage("error",e,{container:n,delay:0})}))},complete:function(){r.execute("hideLoading")}})},showMessage:function(e,t,n){const s="error"===e?0:this.SUCCESS_MESSAGE_DELAY;c.notificationFlashMessage(e,o(t),{container:n,delay:s})},prepareData:function(e){const t=[],n=this.formPrefix.length;return n>0?(s.each(e,(e=>{0===e.name.indexOf(this.formPrefix)&&(e.name=this.requestPrefix+e.name.substr(n),t.push(e))})),t):e},getUrl:function(){return i.generate(this.route,this._getUrlParams())},_getUrlParams:function(){const e={for_entity:this.entity,organization:this.organization};return null!==this.entityId&&(e.id=this.entityId),e},clear:function(){this.model.set({imap:{},smtp:[]})}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/views/google-sync-checkbox-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js");return n("./bundles/oroui/js/app/views/base/view.js").extend({$errorMessage:null,$successMessage:null,$googleErrorMessage:null,$googleWarningMessage:null,token:null,googleErrorMessage:"",canShowMessage:!1,events:{"change input[type=checkbox]":"onChangeCheckBox"},listen:{"change:canShowMessage":"render"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.$errorMessage=this.$el.find(e.errorMessage),this.$successMessage=this.$el.find(e.successMessage),this.$googleErrorMessage=this.$el.find(e.googleErrorMessage),this.$googleWarningMessage=this.$el.find(e.googleWarningMessage)},render:function(){this.$googleErrorMessage.html(this.googleErrorMessage),this.canShowMessage?this.showMessage():this.hideMessages()},setToken:function(e){this.token=e},setGoogleErrorMessage:function(e){this.googleErrorMessage=e},resetGoogleErrorMessage:function(){this.googleErrorMessage=""},resetToken:function(){this.token=null},onChangeCheckBox:function(e){this.resetGoogleErrorMessage(),this.resetToken(),this.hideMessages(),t(e.target).is(":checked")?(this.canShowMessage=!0,this.trigger("requestToken")):(this.canShowMessage=!1,this.$googleWarningMessage.show())},showMessage:function(){this.hideMessages(),this.googleErrorMessage.length>0?(this.unCheck(),this.showGoogleError()):this.token&&!this.token.error?this.showSuccess():(this.unCheck(),this.showError())},hideMessages:function(){this.$errorMessage.hide(),this.$successMessage.hide(),this.$googleErrorMessage.hide(),this.$googleWarningMessage.hide()},showSuccess:function(){this.$successMessage.show()},showError:function(){this.$errorMessage.show()},showGoogleError:function(){this.$googleErrorMessage.show()},unCheck:function(){this.$el.find("input").prop("checked",!1)}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/views/imap-gmail-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";return n("./bundles/oroimap/js/app/views/imap-view.js").extend({constructor:function e(t){e.__super__.constructor.call(this,t)}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/views/imap-microsoft-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroimap/js/app/views/imap-view.js").extend({constructor:function e(t){e.__super__.constructor.call(this,t)},getData:function(){const e=t.__super__.getData.call(this);return e.tenant=this.$el.find('input[name$="[userEmailOrigin][tenant]"]').val(),e}});return t}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroimap/js/app/views/imap-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroui/js/extend/jquery.js");return t.extend({events:{'click button[name$="[userEmailOrigin][check]"]':"onClickConnect",'click button[name$="[userEmailOrigin][checkFolder]"]':"onCheckFolder","click button.delete":"onResetEmail"},$vendorErrorMessage:null,errorMessage:"",type:"",html:"",accessToken:"",refreshToken:"",expiredAt:"",email:"",constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.vendorErrorMessage=e.vendorErrorMessage,this.type=e.type},render:function(){this.html&&this.html.length>0&&this.$el.html(this.html),this.$el.find('input[name$="[userEmailOrigin][accessToken]"]').val(this.accessToken),this.$el.find('input[name$="[userEmailOrigin][refreshToken]"]').val(this.refreshToken),this.$el.find('input[name$="[userEmailOrigin][user]"]').val(this.email),this.$el.find('input[name$="[userEmailOrigin][accessTokenExpiresAt]"]').val(this.expiredAt),this.errorMessage.length>0?this.showErrorMessage():this.hideErrorMessage(),this.initLayout().done(this._resolveDeferredRender.bind(this))},hasOwnLayout:function(){return!0},setErrorMessage:function(e){this.errorMessage=e},resetErrorMessage:function(){this.errorMessage=""},setHtml:function(e){this.html=e},onClickConnect:function(){this.trigger("checkConnection",this.getData())},onCheckFolder:function(){this.trigger("getFolders",this.getData())},onResetEmail:function(){s('select[name$="[accountType]"]').val("").trigger("change")},getData:function(){let e=this.$el.find('input[name$="[userEmailOrigin][accessToken]"]').val(),t=this.$el.find('input[name$="[userEmailOrigin][refreshToken]"]').val();return e||(e=this.accessToken),t||(t=this.refreshToken),{type:this.type,accessToken:e,refreshToken:t,clientId:this.$el.find('input[name$="[userEmailOrigin][clientId]"]').val(),user:this.$el.find('input[name$="[userEmailOrigin][user]"]').val(),imapPort:this.$el.find('input[name$="[userEmailOrigin][imapPort]"]').val(),imapHost:this.$el.find('input[name$="[userEmailOrigin][imapHost]"]').val(),imapEncryption:this.$el.find('input[name$="[userEmailOrigin][imapEncryption]"]').val(),smtpPort:this.$el.find('input[name$="[userEmailOrigin][smtpPort]"]').val(),smtpHost:this.$el.find('input[name$="[userEmailOrigin][smtpHost]"]').val(),smtpEncryption:this.$el.find('input[name$="[userEmailOrigin][smtpEncryption]"]').val(),accessTokenExpiresAt:this.$el.find('input[name$="[userEmailOrigin][accessTokenExpiresAt]"]').val()}},setAccessToken:function(e){this.accessToken=e},setRefreshToken:function(e){this.refreshToken=e},setEmail:function(e){this.email=e},setExpiredAt:function(e){this.expiredAt=e},showErrorMessage:function(){const e=this.getErrorBlock();e.length>0&&(e.html(this.errorMessage),e.show())},hideErrorMessage:function(){const e=this.getErrorBlock();e.length>0&&e.hide()},getErrorBlock:function(){return this.$el.find(this.vendorErrorMessage)},autoRetrieveFolders:function(){this.$el.find("input.folder-tree").length||this.trigger("getFolders",this.getData())}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/orointegration/js/app/components/integration-connection-checker-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/app/components/base/component.js"),o=n("./bundles/oroui/js/app/views/loading-mask-view.js"),i=n("./bundles/oroui/js/messenger.js"),r=n("./bundles/oroorganization/js/app/tools/system-access-mode-organization-provider.js"),a=s.extend({$button:null,$form:null,backendUrl:"",loadingMaskView:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.$button=e._sourceElement,this.$form=t(e.formSelector),this.backendUrl=e.backendUrl,this.loadingMaskView=new o({container:t("body")}),this.initListeners()},initListeners:function(){this.$button.on("click",this.buttonClickHandler.bind(this))},buttonClickHandler:function(){this.$form.validate(),this.$form.valid()&&this.checkConnection()},checkConnection:function(){const e=this;let n=this.$form.serialize();const s=r.getOrganizationId();s&&(n+="&_sa_org_id="+s),t.ajax({url:this.backendUrl,type:"POST",data:n,beforeSend:function(){e.loadingMaskView.show()},success:this.successHandler.bind(this),complete:function(){e.loadingMaskView.hide()}})},successHandler:function(e){let t="error";e.success&&(t="success"),i.notificationFlashMessage(t,e.message)},dispose:function(){this.disposed||(this.$button.off("click"),a.__super__.dispose.call(this))}});return a}.call(t,n,t,e))||(e.exports=s)},"./bundles/orointegration/js/app/views/integration-sync-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroui/js/extend/jquery.js"),o=n("./bundles/orotranslation/js/translator.js"),i=n("./bundles/oroui/js/messenger.js"),r=n("./bundles/oroui/js/mediator.js"),a=n("./bundles/oroui/js/modal.js");return t.extend({optionNames:t.prototype.optionNames.concat(["integrationName"]),modalClass:"modal oro-modal-danger",events:{"click .schedule-button":"onSync"},constructor:function e(t){e.__super__.constructor.call(this,t)},onSync:function(e){e.preventDefault();const t=s(e.currentTarget),n=t.data("url");t.data("force")?this._showConfirmationModal(n):this._scheduleSync(n)},_showConfirmationModal:function(e){const t=new a({title:o("oro.integration.force_sync.title"),okText:o("oro.integration.force_sync.ok"),cancelText:o("oro.integration.force_sync.cancel"),content:o("oro.integration.force_sync.message",{integration_name:this.integrationName}),className:this.modalClass,attributes:{role:"alertdialog"}});t.on("ok",function(){this._scheduleSync(e)}.bind(this)),t.open()},_scheduleSync:function(e){r.execute("showLoading"),s.ajax(e,{method:"POST",errorHandlerMessage:!1,success:function(e){i.notificationMessage(e.successful?"success":"warning",e.message)},error:function(e){i.notificationMessage("error",e.responseJSON&&e.responseJSON.message?e.responseJSON.message:o("oro.integration.error"))},complete:function(){r.execute("hideLoading")}})}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/orointegration/js/channel-view.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroui/js/extend/jquery.js"),n("./bundles/oroui/js/extend/backbone.js"),n("./bundles/oroui/js/extend/underscore.js"),n("./bundles/orotranslation/js/translator.js"),n("./bundles/oroui/js/mediator.js"),n("./bundles/oroui/js/delete-confirmation.js")],void 0===(o=function(e,t,n,s,o,i){"use strict";return t.View.extend({UPDATE_MARKER:"formUpdateMarker",fieldsSets:{type:[],transportType:[]},requiredOptions:["transportTypeSelector","typeSelector","fieldsSets","formSelector"],constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(t){this.options=n.defaults(t||{},this.options);const s=this.requiredOptions.filter((function(e){return n.isUndefined(t[e])}));if(s.length)throw new TypeError("Missing required option(s): "+s.join(","));for(const e in t.fieldsSets)e in this.fieldsSets?this.fieldsSets[e]=n.union(this.fieldsSets[e],t.fieldsSets[e]):this.fieldsSets[e]=t.fieldsSets[e];this.processSelectorState(),e(t.typeSelector).on("change",this.changeHandler.bind(this)),e(t.transportTypeSelector).on("change",this.changeHandler.bind(this)),this.memoizeValue(t.typeSelector),this.memoizeValue(t.transportTypeSelector)},processSelectorState:function(){const t=e(this.options.transportTypeSelector);t.find("option").length<2&&t.parents(".control-group:first").hide()},changeHandler:function(t){const n=e(t.currentTarget);if(!0!==n.data("cancelled")){const e=n.data("current");if(this.isEmpty())this.processChange(n);else{const t=new i({title:s("oro.integration.change_type"),okText:s("Yes"),content:s("oro.integration.submit")});t.on("ok",(()=>{this.processChange(n)})),t.on("cancel",(()=>{n.data("cancelled",!0).val(e).trigger("change"),this.memoizeValue(n)})),t.open()}}else n.data("cancelled",!1)},processChange:function(t){this.memoizeValue(t);const s=e(this.options.formSelector);let i=s.serializeArray();const r=s.attr("action"),a=t.is(this.options.typeSelector)?this.fieldsSets.type:this.fieldsSets.transportType;i=n.filter(i,(function(e){return-1!==n.indexOf(a,e.name)})),i.push({name:this.UPDATE_MARKER,value:t.attr("name")});const c={formEl:s,data:i,reloadManually:!0};o.trigger("integrationFormReload:before",c),c.reloadManually&&o.execute("submitPage",{url:r,type:s.attr("method"),data:e.param(i)})},isEmpty:function(){let t=e(this.options.typeSelector).parents("form").find('input[type="text"]:not([name$="[name]"])');return t=t.filter((function(){return""!==this.value})),!t.length},memoizeValue:function(t){const n=e(t);n.data("current",n.val())}})}.apply(t,s))||(e.exports=o)},"./bundles/oroldap/js/ldap-checker.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroui/js/extend/jquery.js"),n("./bundles/oroui/js/extend/underscore.js"),n("./bundles/fosjsrouting/js/router.js"),n("./bundles/oroui/js/extend/backbone.js"),n("./bundles/orotranslation/js/translator.js"),n("./bundles/oroui/js/mediator.js")],void 0===(o=function(e,t,n,s,o,i){"use strict";return s.View.extend({events:{click:"processClick"},route:"oro_ldap_transport_check",url:null,id:null,$messages:null,resultTemplate:t.template('<div class="alert alert-<%- type %>" role="alert"><%= message %></div>'),constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=t.defaults(e||{},this.options),this.id=e.transportEntityId||null,this.url=this.getUrl(),this.$messages=this.$el.closest(".control-group").find(".messages")},getUrl:function(e){const t={id:this.id};return void 0!==e&&(t.type=e),n.generate(this.route,t)},processClick:function(){const n=t.filter(this.$el.parents("form").serializeArray(),(function(e){return-1===e.name.indexOf("[_token]")}));let s=t.filter(n,(function(e){return-1!==e.name.indexOf("[type]")}));s.length&&(s=s[0].value),i.execute("showLoading"),e.post(this.getUrl(s),n,this.responseHandler.bind(this),"json").always(((e,t)=>{i.execute("hideLoading"),"success"!==t&&this.renderResult("error",o("oro.ldap.transport.ldap.fields.check.message.error"))}))},responseHandler:function(e){let t="",n=e.status;"success"===e.status?t=o("oro.ldap.transport.ldap.fields.check.message.success"):"invalid"===e.status&&(t=o("oro.ldap.transport.ldap.fields.check.message.invalid"),n="danger"),this.renderResult(n,t)},renderResult:function(e,t){this.$messages.html(this.resultTemplate({type:e,message:t}))}})}.apply(t,s))||(e.exports=o)},"./bundles/oromicrosoftsync/js/app/components/microsoft-sync-token-component.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/jquery.js"),s=n("./bundles/oroui/js/extend/underscore.js"),o=n("./bundles/orotranslation/js/translator.js"),i=n("./bundles/oroui/js/mediator.js"),r=n("./bundles/fosjsrouting/js/router.js"),a=n("./bundles/oroimap/js/app/components/oauth-popup.js"),c=n("./bundles/oroui/js/app/components/base/component.js"),l=n("./bundles/oromicrosoftsync/js/app/views/microsoft-sync-token-view.js"),u=c.extend({ViewType:l,authorizationUrl:"",authorizationParams:{client_id:"",redirect_uri:"",scope:"openid offline_access profile User.Read Calendars.ReadWrite Tasks.ReadWrite",response_type:"code",response_mode:"query"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){if(!e.authorization_uri)throw new Error('"authorization_uri" is required option');this.authorizationUrl=e.authorization_uri,this.authorizationParams=s.defaults({client_id:e.client_id,redirect_uri:e.redirect_uri},this.authorizationParams),this.view=new this.ViewType({el:e._sourceElement}),this.listenTo(this.view,"connectAccount",this.onConnectAccount),this.listenTo(this.view,"checkConnectedAccount",this.onCheckConnectedAccount),u.__super__.initialize.call(this,e)},onConnectAccount:function(){this.view.resetMessages(),this.view.render(),this.requestAuthCode()},onCheckConnectedAccount:function(){this.view.resetMessages(),this.view.render(),this.checkConnectedAccount()},requestAuthCode:function(){const e=this.authorizationUrl+"?"+t.param(s.defaults(this.authorizationParams,{state:btoa("token=sync&"+Math.floor(1e4+9e4*Math.random()))}));a.whenAuthorized(e).done((e=>{e&&this.requestAccessToken()})).fail((()=>{i.execute("showFlashMessage","error",o("oro.microsoft_sync.oauth.error.blocked_popup"))}))},requestAccessToken:function(){t.ajax({url:r.generate("oro_imap_microsoft_access_token"),method:"POST",data:{},success:this.accessTokenRequestSuccess.bind(this),errorHandlerMessage:!1,error:()=>{this.view.setErrorMessage(o("oro.microsoft_sync.oauth.error.request")),this.view.render()}})},accessTokenRequestSuccess:function(e){void 0!==e.error?(this.view.setErrorMessage(e.error),this.view.render()):void 0!==e.code&&e.code>=400?(this.view.setErrorMessage(e.message||o("oro.microsoft_sync.oauth.error.request")),this.view.render(),401===e.code&&i.execute("showFlashMessage","error",o("oro.microsoft_sync.oauth.error.closed_auth"))):e&&(this.view.setAccessToken(e.email_address,e.access_token,e.refresh_token,e.expires_in),this.view.setSuccessMessage(o("oro.microsoft_sync.oauth.success.account")),this.view.render())},checkConnectedAccount:function(){t.ajax({url:r.generate("oro_microsoft_sync_connection_check"),method:"GET",data:{},success:()=>{this.view.setSuccessMessage(o("oro.microsoft_sync.oauth.success.account")),this.view.render()},errorHandlerMessage:!1,error:e=>{let t=o("oro.microsoft_sync.oauth.error.account");e.responseJSON.message&&(t+=" "+e.responseJSON.message),this.view.setErrorMessage(t),this.view.render()}})}});return u}.call(t,n,t,e))||(e.exports=s)},"./bundles/oromicrosoftsync/js/app/views/microsoft-sync-token-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/extend/underscore.js"),s=n("./bundles/oroui/js/app/views/base/view.js").extend({events:{'click button[name$="[check]"]':"onConnect","click button.check-account":"onCheckAccount","click button.delete":"onResetEmail"},options:{selectors:{errorMessage:"div.error-message",successMessage:"div.success-message",reconnectHint:"div.reconnect-hint",connectButton:'button[name$="[check]"]',connectedAccountBlock:"div.connected-account",connectedAccount:"div.connected-account strong",userEmail:'input[name$="[userEmail]"]',accessToken:'input[name$="[accessToken]"]',refreshToken:'input[name$="[refreshToken]"]',accessTokenExpiresIn:'input[name$="[accessTokenExpiresIn]"]'}},errorMessage:"",successMessage:"",data:{userEmail:"",accessToken:"",refreshToken:"",accessTokenExpiresIn:""},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=t.defaults(e||{},this.options),this.data.userEmail=this.$el.find(this.options.selectors.userEmail).val(),this.data.accessToken=this.$el.find(this.options.selectors.accessToken).val(),this.data.refreshToken=this.$el.find(this.options.selectors.refreshToken).val(),this.data.accessTokenExpiresIn=this.$el.find(this.options.selectors.accessTokenExpiresIn).val()},render:function(){s.__super__.render.call(this);const e=this.$el.find(this.options.selectors.errorMessage);this.errorMessage.length>0?(e.html(this.errorMessage),e.show()):e.hide();const t=this.$el.find(this.options.selectors.successMessage);this.successMessage.length>0?(t.html(this.successMessage),t.show()):t.hide();const n=this.$el.find(this.options.selectors.reconnectHint);return this.successMessage.length>0?n.hide():n.show(),this.data.userEmail.length>0?(this.$el.find(this.options.selectors.connectButton).hide(),this.$el.find(this.options.selectors.connectedAccountBlock).show()):(this.$el.find(this.options.selectors.connectButton).show(),this.$el.find(this.options.selectors.connectedAccountBlock).hide()),this.$el.find(this.options.selectors.connectedAccount).html(this.data.userEmail),this.$el.find(this.options.selectors.userEmail).val(this.data.userEmail),this.$el.find(this.options.selectors.accessToken).val(this.data.accessToken),this.$el.find(this.options.selectors.refreshToken).val(this.data.refreshToken),this.$el.find(this.options.selectors.accessTokenExpiresIn).val(this.data.accessTokenExpiresIn),this},setErrorMessage:function(e){this.errorMessage=e},setSuccessMessage:function(e){this.successMessage=e},resetMessages:function(){this.errorMessage="",this.successMessage=""},setAccessToken:function(e,t,n,s){this.data={userEmail:e,accessToken:t,refreshToken:n,accessTokenExpiresIn:s}},resetAccessToken:function(){this.data={userEmail:"",accessToken:"",refreshToken:"",accessTokenExpiresIn:""}},onConnect:function(){this.trigger("connectAccount")},onCheckAccount:function(){this.trigger("checkConnectedAccount")},onResetEmail:function(){this.resetAccessToken(),this.render()}});return s}.call(t,n,t,e))||(e.exports=s)},"./bundles/orooauth2server/js/views/client-grant-view.js":(e,t,n)=>{var s;void 0===(s=function(e){"use strict";const t=n("./bundles/oroui/js/app/views/base/view.js"),s=n("./bundles/oroui/js/extend/jquery.js");return t.extend({events:{click:"updateClientView"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.ownerField=s(e.ownerField),this.redirectUrisField=s(e.redirectUrisField),this.confidentialField=s(e.confidentialField),this.skipAuthorizeClientAllowedField=s(e.skipAuthorizeClientAllowedField),this.updateClientView()},updateClientView:function(){const e=this.$el.filter(":checked").val();"client_credentials"===e?this.ownerField.removeClass("hide"):this.ownerField.addClass("hide"),"authorization_code"===e?(this.redirectUrisField.removeClass("hide"),this.confidentialField.removeClass("hide"),this.skipAuthorizeClientAllowedField.removeClass("hide")):(this.redirectUrisField.addClass("hide"),this.confidentialField.addClass("hide"),this.skipAuthorizeClientAllowedField.addClass("hide"))}})}.call(t,n,t,e))||(e.exports=s)},"./bundles/oroorganizationpro/js/app/components/account-type-component.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroorganization/js/app/tools/system-access-mode-organization-provider.js"),n("./bundles/oroimap/js/app/components/account-type-component.js")],void 0===(o=function(e,t){"use strict";const n=t.extend({isGlobalOrg:!1,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){n.__super__.initialize.call(this,e),this.isGlobalOrg=e.viewOptions.isGlobalOrg,this.organization=e.organization},_getUrlParams:function(){const t=n.__super__._getUrlParams.call(this);let s=e.getOrganizationId();return!s&&this.isGlobalOrg&&(s=this.organization),s&&(t._sa_org_id=s),t}});return n}.apply(t,s))||(e.exports=o)},"./bundles/oroorganizationpro/js/app/components/imap-gmail-component.js":(e,t,n)=>{var s,o;s=[n("./bundles/oroorganization/js/app/tools/system-access-mode-organization-provider.js"),n("./bundles/oroimap/js/app/components/imap-gmail-component.js")],void 0===(o=function(e,t){"use strict";const n=t.extend({isGlobalOrg:!1,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){n.__super__.initialize.call(this,e),this.isGlobalOrg=e.viewOptions.isGlobalOrg,this.organization=e.organization},_getUrlParams:function(...t){const s=n.__super__._getUrlParams.apply(this,t);let o=e.getOrganizationId();return!o&&this.isGlobalOrg&&(o=this.organization),o&&(s._sa_org_id=o),s}});return n}.apply(t,s))||(e.exports=o)}}]);